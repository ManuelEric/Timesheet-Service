import{r as v,y as I,e as m,p as M,w as a,b as l,j as te,V as L,h as t,D as O,k as Y,l as y,i as D,z as le,A,s as N,a5 as G,U as se,o as W,f as e,E as q,a as C,q as F,a0 as X,F as Z,t as _,G as ae,a1 as oe,d as ee,a9 as K}from"./main-_fLkZ-AY.js";import{_ as ie}from"./DeleteHandler.vue_vue_type_script_setup_true_lang-BF53i2CN.js";import{d as ne}from"./debounce-rmTKhzIf.js";import{r as R}from"./rules-CkvmYWH-.js";import{c as S,d as de,V as P,b as z,a as E}from"./VCard-MpYbC6I-.js";import{V as re}from"./VForm-D8PYVbGi.js";import{V as H,a as $}from"./VRow-DaoFyr2r.js";import{V as ce}from"./VTextarea-CCuJStB0.js";import{V as Q}from"./VDialog-BYCUg4TV.js";import{a as J,V as B}from"./VTable-DE4_dZjb.js";import{T as j}from"./index-BHRVbs4-.js";import{V as ue}from"./VCheckbox-BrEHHDl0.js";import"./VAvatar-BGE7fl55.js";import"./VImg-C3iIJCNc.js";import"./VTooltip-D3L6ocr1.js";import"./VCheckboxBtn-CFP6aR67.js";import"./VSelectionControl-CMDnsBTx.js";const _e={__name:"activity-add",props:{id:String},emits:["close","reload"],setup(U,{emit:f}){const b=U,h=f,c=v(!1),x=v(),s=v({activity:null,description:null,date:null,start_time:null,end_time:null,start_date:null,end_date:null,meeting_link:null}),w=async()=>{var d,k,V,i;const{valid:g}=await x.value.validate();if(g){c.value=!0;try{const r=await A.post("api/v1/timesheet/"+b.id+"/activity",s.value);r&&N("success",r.message,"bottom-end")}catch(r){N("error",(k=(d=r==null?void 0:r.response)==null?void 0:d.data)==null?void 0:k.errors,"bottom-end"),console.log((i=(V=r==null?void 0:r.response)==null?void 0:V.data)==null?void 0:i.errors)}finally{c.value=!1,h("reload"),h("close")}}};return(g,d)=>{const k=I("DialogCloseBtn"),V=I("VDateInput");return m(),M(P,{title:"New Activity"},{default:a(()=>[l(k,{variant:"text",size:"default",onClick:d[0]||(d[0]=i=>h("close"))}),l(S,null,{default:a(()=>[l(re,{onSubmit:te(w,["prevent"]),ref_key:"formData",ref:x,"validate-on":"input"},{default:a(()=>[l(H,null,{default:a(()=>[l($,{cols:"12",class:"d-none"},{default:a(()=>[l(L,{modelValue:t(s).activity,"onUpdate:modelValue":d[1]||(d[1]=i=>t(s).activity=i),label:"Activity Name",placeholder:"Activity",loading:t(c),disabled:t(c),density:"compact"},null,8,["modelValue","loading","disabled"])]),_:1}),l($,{cols:"12"},{default:a(()=>[l(ce,{modelValue:t(s).description,"onUpdate:modelValue":d[2]||(d[2]=i=>t(s).description=i),label:"Meeting Discussion",placeholder:"Meeting Discussion",loading:t(c),disabled:t(c),rules:t(R).required,density:"compact"},null,8,["modelValue","loading","disabled","rules"])]),_:1}),l($,{md:"6",cols:"12"},{default:a(()=>[l(V,{modelValue:t(s).date,"onUpdate:modelValue":d[3]||(d[3]=i=>t(s).date=i),label:"Date",placeholder:"Select Date","prepend-icon":"",loading:t(c),disabled:t(c),rules:t(R).required,variant:"outlined",density:"compact"},null,8,["modelValue","loading","disabled","rules"])]),_:1}),l($,{md:"3",cols:"6"},{default:a(()=>[l(L,{type:"time",modelValue:t(s).start_time,"onUpdate:modelValue":d[4]||(d[4]=i=>t(s).start_time=i),label:"Start Time",placeholder:"Start Time",rules:t(R).required,class:"mb-3",loading:t(c),disabled:t(c),density:"compact",onChange:d[5]||(d[5]=i=>t(s).start_date=t(O)(t(s).date).format("YYYY-MM-DD")+" "+t(s).start_time+":00")},null,8,["modelValue","rules","loading","disabled"])]),_:1}),l($,{md:"3",cols:"6"},{default:a(()=>[l(L,{type:"time",modelValue:t(s).end_time,"onUpdate:modelValue":d[6]||(d[6]=i=>t(s).end_time=i),label:"End Time",placeholder:"End Time",loading:t(c),disabled:t(c),density:"compact",onChange:d[7]||(d[7]=i=>t(s).end_date=t(O)(t(s).date).format("YYYY-MM-DD")+" "+t(s).end_time+":00")},null,8,["modelValue","loading","disabled"])]),_:1}),l($,{md:"12",cols:"12"},{default:a(()=>[l(L,{type:"text",modelValue:t(s).meeting_link,"onUpdate:modelValue":d[8]||(d[8]=i=>t(s).meeting_link=i),label:"Meeting Link",placeholder:"Meeting Link",density:"compact",loading:t(c),disabled:t(c)},null,8,["modelValue","loading","disabled"])]),_:1})]),_:1}),l(de,{class:"mt-5"},{default:a(()=>[l(Y,{type:"button",color:"error",loading:t(c),disabled:t(c),onClick:d[9]||(d[9]=i=>h("close"))},{default:a(()=>[l(y,{icon:"ri-close-line",class:"me-3"}),D(" Close ")]),_:1},8,["loading","disabled"]),l(le),l(Y,{loading:t(c),disabled:t(c),type:"submit",color:"success"},{default:a(()=>[D(" Save "),l(y,{icon:"ri-save-line",class:"ms-3"})]),_:1},8,["loading","disabled"])]),_:1})]),_:1},512)]),_:1})]),_:1})}}},me={class:"d-flex justify-between align-center"},pe=e("div",{class:"w-100"},[e("h4",null,"Activity")],-1),fe=e("th",{class:"text-uppercase",width:"1%"}," No ",-1),he=e("th",{class:"text-uppercase text-center"},"Meeting Discussion",-1),ge=e("th",{class:"text-uppercase text-center"},"Date",-1),ye=e("th",{class:"text-uppercase text-center"},"Start Time",-1),ve=e("th",{class:"text-uppercase text-center",style:{width:"200px !important"}}," End Time ",-1),be=e("th",{class:"text-uppercase text-center"},"Time Spent",-1),xe=e("th",{class:"text-uppercase text-center"},"Status",-1),we={key:0,class:"text-uppercase text-end"},Ve={width:"1%"},ke={class:"text-start"},De={class:"text-center"},$e={class:"text-start"},Ce=["onUpdate:modelValue","onChange","disabled"],Te={class:"text-center"},Se={key:0,class:"text-end"},Me=["href"],Ne={__name:"timesheet-detail",props:{id:String,require:String},setup(U){const f=U,b=G("updateReload"),h=v([]),c=v(!1),x=v(se.getUser().role_detail[0].role.toLowerCase()),s=v([{add:!1,delete:!1}]),w=v([]),g=async()=>{c.value=!0;try{const n=await A.get("api/v1/timesheet/"+f.id+"/activities");n&&(h.value=n)}catch(n){console.error(n)}finally{c.value=!1}},d=n=>{s.value[n]?s.value[n]=!1:s.value[n]=!0},k=(n,u)=>{w.value=u,d(n)},V=async()=>{var n,u;c.value=!0;try{const o=await A.delete("api/v1/timesheet/"+f.id+"/activity/"+w.value.id);o&&N("success",o.message,"bottom-end")}catch(o){N("error",(u=(n=o.response)==null?void 0:n.data)==null?void 0:u.errors,"bottom-end")}finally{c.value=!1,g(),b(!0),d("delete")}},i=ne(async n=>{n.end_date=n.date+" "+n.end_time+":00";try{const u=await A.put("api/v1/timesheet/"+f.id+"/activity/"+n.id,n);u&&N("success",u.message,"bottom-end")}catch(u){console.error(u)}finally{g(),b(!0)}},500),r=async n=>{var u,o;try{const p=await A.patch("api/v1/timesheet/"+f.id+"/activity/"+n.id,n);p&&N("success",p.message,"bottom-end")}catch(p){(o=(u=p==null?void 0:p.response)==null?void 0:u.data)!=null&&o.message&&N("error",p.response.data.message,"bottom-end"),console.error(p)}finally{g(),b(!0)}};return W(()=>{g()}),(n,u)=>(m(),M(P,null,{default:a(()=>[l(z,null,{default:a(()=>[e("div",me,[pe,q((m(),M(Y,{onClick:u[0]||(u[0]=o=>d("add"))},{default:a(()=>[l(y,{icon:"ri-add-line"})]),_:1})),[[j,"New Activity","start"]]),l(Q,{modelValue:t(s).add,"onUpdate:modelValue":u[2]||(u[2]=o=>t(s).add=o),"max-width":"600",persistent:""},{default:a(()=>[l(_e,{id:f.id,onClose:u[1]||(u[1]=o=>d("add")),onReload:g},null,8,["id"])]),_:1},8,["modelValue"])])]),_:1}),l(S,null,{default:a(()=>[t(c)?(m(),M(B,{key:1,type:"table"})):(m(),M(J,{key:0,class:"text-no-wrap",height:"400","fixed-header":""},{default:a(()=>[e("thead",null,[e("tr",null,[fe,he,ge,ye,ve,be,xe,t(x)!="mentor"?(m(),C("th",we," # ")):F("",!0)])]),e("tbody",null,[(m(!0),C(Z,null,X(t(h),(o,p)=>(m(),C("tr",{key:p},[e("td",Ve,_(p+1),1),e("td",ke,_(o.description),1),e("td",null,_(n.$moment(o.start_date).format("dddd"))+", "+_(n.$moment(o.start_date).format("MMM Do YYYY")),1),e("td",De,_(o.start_time),1),e("td",$e,[q(e("input",{type:"time",class:"form-control px-2 py-2 border rounded cursor-pointer","onUpdate:modelValue":T=>o.end_time=T,onChange:T=>t(i)(o),disabled:t(x)=="mentor"||o.start_time=="00:00"||o.cutoff_status=="completed"},null,40,Ce),[[ae,o.end_time],[j,o.cutoff_status=="completed"?"Already Cut-Off":"End Time","start"]])]),e("td",Te,_(o.estimate)+" Minutes",1),e("td",null,[q(l(ue,{color:"success",modelValue:o.status,"onUpdate:modelValue":[T=>o.status=T,T=>r(o)],value:!0,disabled:t(x)=="mentor"||o.start_time=="00:00"||o.cutoff_status=="completed"},null,8,["modelValue","onUpdate:modelValue","disabled"]),[[j,o.status?"Completed":"Not Yet","start"]])]),t(x)!="mentor"?(m(),C("td",Se,[l(Y,{color:"primary",density:"compact",class:"me-1"},{default:a(()=>[e("a",{href:o.meeting_link,target:"_blank",class:"bg-primary"},[l(y,{icon:"ri ri-link"}),D(" Join ")],8,Me)]),_:2},1024),q((m(),M(Y,{color:"error",density:"compact",disabled:o.start_time=="00:00"||o.cutoff_status=="completed",onClick:T=>k("delete",o)},{default:a(()=>[l(y,{icon:"ri-delete-bin-line",class:"cursor-pointer"})]),_:2},1032,["disabled","onClick"])),[[j,o.status?"Already Cut-Off":"Delete Activity","start"]])])):F("",!0)]))),128))])]),_:1}))]),_:1}),l(Q,{modelValue:t(s).delete,"onUpdate:modelValue":u[4]||(u[4]=o=>t(s).delete=o),"max-width":"400",persistent:""},{default:a(()=>[l(ie,{loading:t(c),title:"activity",onClose:u[3]||(u[3]=o=>d("delete")),onDelete:V},null,8,["loading"])]),_:1},8,["modelValue"])]),_:1}))}},Ue={class:"w-100"},Ae={class:"mt-3 font-weight-light"},Pe=e("hr",{class:"my-2"},null,-1),Ye={key:0},ze=e("tr",{class:"bg-secondary"},[e("td",null,"Name"),e("td",null,"School"),e("td",null,"Grade")],-1),Be={key:1},Le=e("td",{width:"20%"},"Name",-1),qe=e("td",{width:"1%"},":",-1),je=e("td",null,"School Name",-1),Fe=e("td",{width:"1%"},":",-1),Re=e("td",null,"Grade",-1),Ee=e("td",{width:"1%"},":",-1),Ie=e("td",null,"Email",-1),Oe=e("td",{width:"1%"},":",-1),Ge={class:"mt-5 font-weight-light"},He=e("hr",{class:"my-2"},null,-1),Je=e("td",{width:"20%"},"Program",-1),Ke=e("td",{width:"1%"},":",-1),Qe=e("td",null,"Package",-1),We=e("td",{width:"1%"},":",-1),Xe=e("td",null,"Person in Charge",-1),Ze=e("td",{width:"1%"},":",-1),et=e("td",null,"Tutor/Mentor",-1),tt=e("td",{width:"1%"},":",-1),lt=e("td",null,"Notes",-1),st=e("td",{width:"1%"},":",-1),at=e("td",null,"Update On",-1),ot=e("td",{width:"1%"},":",-1),it={class:"d-flex align-end w-100"},nt={class:"m-0 mb-1 text-white"},dt=e("h4",{class:"m-0 ms-2 text-white"},"Minutes",-1),rt={class:"text-end w-100"},ct={class:"d-flex align-end w-100"},ut={class:"m-0 mb-1 text-white"},_t=e("h4",{class:"m-0 ms-2 text-white"},"Minutes",-1),mt={class:"text-end w-100"},pt={class:"d-flex align-end w-100"},ft={class:"m-0 mb-1 text-white"},ht=e("h4",{class:"m-0 ms-2 text-white"},"Minutes",-1),gt={class:"text-end w-100"},yt={__name:"user-detail",props:{id:String},emits:["void"],setup(U,{emit:f}){const b=U,h=f,c=G("reloadData"),x=G("updateReload"),s=v([]),w=v(!1),g=async d=>{var k,V,i;w.value=!0;try{const r=await A.get("api/v1/timesheet/"+d+"/detail");r&&(s.value=r,h("void",r.packageDetails.void))}catch(r){((k=r.response)==null?void 0:k.status)==400&&(N("error",(i=(V=r.response)==null?void 0:V.data)==null?void 0:i.errors,"bottom-end"),ee.push("/admin/timesheet")),console.log(r)}finally{w.value=!1}};return W(()=>{g(b.id)}),oe(()=>{c.value&&(g(b.id),x(!1))}),(d,k)=>{const V=I("router-link");return m(),M(P,{class:"mb-3"},{default:a(()=>[l(z,{class:"d-flex justify-between align-center"},{default:a(()=>{var i,r,n,u,o;return[e("div",Ue,[l(V,{to:"/user/timesheet"},{default:a(()=>[l(y,{icon:"ri-arrow-left-line",color:"secondary",class:"me-2",size:"25"})]),_:1}),D(" "+_((i=t(s).packageDetails)==null?void 0:i.tutormentor_name)+" | "+_(((n=(r=t(s))==null?void 0:r.packageDetails)==null?void 0:n.package_type)+" - "+((o=(u=t(s))==null?void 0:u.packageDetails)==null?void 0:o.package_name)),1)])]}),_:1}),l(S,null,{default:a(()=>[t(w)?(m(),M(H,{key:1},{default:a(()=>[l($,{md:"7"},{default:a(()=>[l(B,{type:"heading, paragraph, heading, paragraph",class:"mb-3"})]),_:1}),l($,{md:"5"},{default:a(()=>[l(B,{type:"text@3",color:"#16B1FF",class:"mb-3"}),l(B,{type:"text@3",color:"#91c45e",class:"mb-3"}),l(B,{type:"text@3",color:"#e05e5e",class:"mb-3"})]),_:1})]),_:1})):(m(),M(H,{key:0,align:"center"},{default:a(()=>[l($,{md:"7"},{default:a(()=>[e("h4",Ae,[l(y,{icon:"ri-user-line",size:"17",class:"me-2"}),D(" Basic Profile ")]),Pe,l(J,{density:"compact"},{default:a(()=>{var i,r;return[((i=t(s).clientProfile)==null?void 0:i.length)>1?(m(),C("tbody",Ye,[ze,(m(!0),C(Z,null,X(t(s).clientProfile,n=>(m(),C("tr",null,[e("td",null,_(n.client_name),1),e("td",null,_(n.client_school),1),e("td",null,_(n.client_grade<=12?n.client_grade:"Not High School"),1)]))),256))])):((r=t(s).clientProfile)==null?void 0:r.length)==1?(m(),C("tbody",Be,[e("tr",null,[Le,qe,e("td",null,_(t(s).clientProfile[0].client_name),1)]),e("tr",null,[je,Fe,e("td",null,_(t(s).clientProfile[0].client_school),1)]),e("tr",null,[Re,Ee,e("td",null,_(t(s).clientProfile[0].client_grade<=12?t(s).clientProfile[0].client_grade:"Not High School"),1)]),e("tr",null,[Ie,Oe,e("td",null,_(t(s).clientProfile[0].client_mail),1)])])):F("",!0)]}),_:1}),e("h4",Ge,[l(y,{icon:"ri-bookmark-line",class:"me-2",size:"17"}),D(" Package Details ")]),He,l(J,{density:"compact"},{default:a(()=>{var i,r,n,u,o,p,T;return[e("tbody",null,[e("tr",null,[Je,Ke,e("td",null,_((i=t(s).packageDetails)!=null&&i.free_trial?"[TRIAL]":"")+" "+_((r=t(s).packageDetails)==null?void 0:r.program_name),1)]),e("tr",null,[Qe,We,e("td",null,_(((n=t(s).packageDetails)==null?void 0:n.package_type)+" - "+((u=t(s).packageDetails)==null?void 0:u.package_name)),1)]),e("tr",null,[Xe,Ze,e("td",null,_((o=t(s).packageDetails)==null?void 0:o.pic_name),1)]),e("tr",null,[et,tt,e("td",null,_((p=t(s).packageDetails)==null?void 0:p.tutormentor_name),1)]),e("tr",null,[lt,st,e("td",null,_((T=t(s).editableColumns)==null?void 0:T.notes),1)]),e("tr",null,[at,ot,e("td",null,_(t(O)().format("LLL")),1)])])]}),_:1})]),_:1}),l($,{md:"5"},{default:a(()=>[l(P,{color:"#16B1FF",class:"mb-2 d-flex align-center"},{default:a(()=>[e("div",null,[l(E,null,{default:a(()=>[l(z,{class:"text-white"},{default:a(()=>[D(" Total Minutes of Package ")]),_:1})]),_:1}),l(S,{class:"d-flex justify-between"},{default:a(()=>{var i;return[e("div",it,[e("h1",nt,_((i=t(s).packageDetails)==null?void 0:i.duration_in_minutes),1),dt])]}),_:1})]),l(S,null,{default:a(()=>[e("div",rt,[l(y,{icon:"ri-calendar-schedule-line",size:"60"})])]),_:1})]),_:1}),l(P,{color:"#91c45e",class:"mb-2 d-flex align-center"},{default:a(()=>[e("div",null,[l(E,null,{default:a(()=>[l(z,{class:"text-white"},{default:a(()=>[D(" Total Minutes Spent ")]),_:1})]),_:1}),l(S,{class:"d-flex justify-between"},{default:a(()=>{var i;return[e("div",ct,[e("h1",ut,_((i=t(s).packageDetails)==null?void 0:i.time_spent_in_minutes),1),_t])]}),_:1})]),l(S,null,{default:a(()=>[e("div",mt,[l(y,{icon:"ri-timer-flash-line",size:"60",color:"white"})])]),_:1})]),_:1}),l(P,{color:"#e05e5e",class:"mb-2 d-flex align-center"},{default:a(()=>[e("div",null,[l(E,null,{default:a(()=>[l(z,{class:"text-white"},{default:a(()=>[D(" Total Minutes Left ")]),_:1})]),_:1}),l(S,{class:"d-flex justify-between"},{default:a(()=>{var i,r;return[e("div",pt,[e("h1",ft,_(((i=t(s).packageDetails)==null?void 0:i.duration_in_minutes)-((r=t(s).packageDetails)==null?void 0:r.time_spent_in_minutes)),1),ht])]}),_:1})]),l(S,null,{default:a(()=>[e("div",gt,[l(y,{icon:"ri-timer-2-line",size:"60"})])]),_:1})]),_:1})]),_:1})]),_:1}))]),_:1})]),_:1})}}},vt={class:"h-auto position-relative"},bt={key:0,class:"overlay"},xt=e("div",{class:"bg-secondary",style:{height:"100%",position:"absolute",left:"0",top:"0","z-index":"9998",width:"100%",opacity:"0.6"}},null,-1),wt={class:"d-flex align-center justify-center",style:{height:"100%",position:"absolute",left:"0",top:"0","z-index":"9999",width:"100%",opacity:"1"}},Vt={class:"text-center"},kt=e("h2",{class:"text-white mt-3"},"This Timesheet Has Changed Owner",-1),Rt={__name:"timesheet-detail",props:{id:Number,require:String},setup(U){const f=U,b=f.id,h=v(!1),c=v(!1);K("reloadData",h),K("updateReload",s=>{h.value=s});const x=s=>{c.value=s};return(s,w)=>(m(),C("div",vt,[t(c)=="true"?(m(),C("div",bt,[xt,e("div",wt,[e("div",Vt,[l(y,{color:"white",icon:"ri-lock-line",size:"50"}),kt,l(Y,{color:"light",class:"mt-4",onClick:w[0]||(w[0]=g=>t(ee).push({path:"/user/timesheet"}))},{default:a(()=>[D(" Back to List ")]),_:1})])])])):F("",!0),l(yt,{id:t(b),onVoid:x},null,8,["id"]),l(Ne,{id:t(b),require:f.require},null,8,["id","require"])]))}};export{Rt as default};
