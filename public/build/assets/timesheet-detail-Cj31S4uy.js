import{r as b,y as I,e as p,p as S,w as a,b as s,j as te,V as L,h as t,D as O,k as Y,l as v,i as D,z as se,A as P,s as N,a5 as G,U as le,o as W,f as e,E as j,a as C,q as F,a0 as X,F as Z,t as u,G as ae,a1 as oe,d as ee,a9 as K}from"./main-By8SK6S3.js";import{_ as ie}from"./DeleteHandler.vue_vue_type_script_setup_true_lang-BfExuf9b.js";import{d as ne}from"./debounce-7bGwjB_n.js";import{r as q}from"./rules-CkvmYWH-.js";import{c as M,d as de,V as A,b as z,a as R}from"./VCard-CCPni4mg.js";import{V as re}from"./VForm-CLSRby1d.js";import{V as H,a as $}from"./VRow-AJrP6gfp.js";import{V as ce}from"./VTextarea-CUhnzTEG.js";import{V as Q}from"./VDialog-4vEXrBWu.js";import{a as J,V as B}from"./VTable-CkKHn9Ec.js";import{T as E}from"./index-BL-Zadv3.js";import{V as ue}from"./VCheckbox-2y3GC5zF.js";import"./VAvatar-DnxIimKR.js";import"./VImg-BCY-WzON.js";import"./VTooltip-CdGkDs_C.js";import"./VCheckboxBtn-DWlRhZER.js";import"./VSelectionControl-BLsrjHCL.js";const _e={__name:"activity-add",props:{id:String},emits:["close","reload"],setup(U,{emit:h}){const x=U,g=h,r=b(!1),w=b(),l=b({activity:null,description:null,date:null,start_time:null,end_time:null,start_date:null,end_date:null,meeting_link:null}),V=async()=>{var d,k;const{valid:y}=await w.value.validate();if(y){r.value=!0;try{const f=await P.post("api/v1/timesheet/"+x.id+"/activity",l.value);f&&N("success",f.message,"bottom-end")}catch(f){if((k=(d=f==null?void 0:f.response)==null?void 0:d.data)!=null&&k.errors){const o=f.response.data.errors;let _="Validation errors:";for(const n in o)o.hasOwnProperty(n)&&(_+=`
${n}: ${o[n].join(", ")}`);N("error",_,"bottom-end")}else N("error",f.response.data.message,"bottom-end")}finally{r.value=!1,g("reload"),g("close")}}};return(y,d)=>{const k=I("DialogCloseBtn"),f=I("VDateInput");return p(),S(A,{title:"New Activity"},{default:a(()=>[s(k,{variant:"text",size:"default",onClick:d[0]||(d[0]=o=>g("close"))}),s(M,null,{default:a(()=>[s(re,{onSubmit:te(V,["prevent"]),ref_key:"formData",ref:w,"validate-on":"input"},{default:a(()=>[s(H,null,{default:a(()=>[s($,{cols:"12",class:"d-none"},{default:a(()=>[s(L,{modelValue:t(l).activity,"onUpdate:modelValue":d[1]||(d[1]=o=>t(l).activity=o),label:"Activity Name",placeholder:"Activity",loading:t(r),disabled:t(r),density:"compact"},null,8,["modelValue","loading","disabled"])]),_:1}),s($,{cols:"12"},{default:a(()=>[s(ce,{modelValue:t(l).description,"onUpdate:modelValue":d[2]||(d[2]=o=>t(l).description=o),label:"Meeting Discussion",placeholder:"Meeting Discussion",loading:t(r),disabled:t(r),rules:t(q).required,density:"compact"},null,8,["modelValue","loading","disabled","rules"])]),_:1}),s($,{md:"6",cols:"12"},{default:a(()=>[s(f,{modelValue:t(l).date,"onUpdate:modelValue":d[3]||(d[3]=o=>t(l).date=o),label:"Date",placeholder:"Select Date","prepend-icon":"",loading:t(r),disabled:t(r),rules:t(q).required,variant:"outlined",density:"compact"},null,8,["modelValue","loading","disabled","rules"])]),_:1}),s($,{md:"3",cols:"6"},{default:a(()=>[s(L,{type:"time",modelValue:t(l).start_time,"onUpdate:modelValue":d[4]||(d[4]=o=>t(l).start_time=o),label:"Start Time",placeholder:"Start Time",rules:t(q).required,class:"mb-3",loading:t(r),disabled:t(r),density:"compact",onChange:d[5]||(d[5]=o=>t(l).start_date=t(O)(t(l).date).format("YYYY-MM-DD")+" "+t(l).start_time+":00")},null,8,["modelValue","rules","loading","disabled"])]),_:1}),s($,{md:"3",cols:"6"},{default:a(()=>[s(L,{type:"time",modelValue:t(l).end_time,"onUpdate:modelValue":d[6]||(d[6]=o=>t(l).end_time=o),label:"End Time",placeholder:"End Time",loading:t(r),disabled:t(r),density:"compact",onChange:d[7]||(d[7]=o=>t(l).end_date=t(O)(t(l).date).format("YYYY-MM-DD")+" "+t(l).end_time+":00")},null,8,["modelValue","loading","disabled"])]),_:1}),s($,{md:"12",cols:"12"},{default:a(()=>[s(L,{type:"text",modelValue:t(l).meeting_link,"onUpdate:modelValue":d[8]||(d[8]=o=>t(l).meeting_link=o),label:"Meeting Link",placeholder:"Meeting Link",density:"compact",loading:t(r),disabled:t(r),rules:t(q).url},null,8,["modelValue","loading","disabled","rules"])]),_:1})]),_:1}),s(de,{class:"mt-5"},{default:a(()=>[s(Y,{type:"button",color:"error",loading:t(r),disabled:t(r),onClick:d[9]||(d[9]=o=>g("close"))},{default:a(()=>[s(v,{icon:"ri-close-line",class:"me-3"}),D(" Close ")]),_:1},8,["loading","disabled"]),s(se),s(Y,{loading:t(r),disabled:t(r),type:"submit",color:"success"},{default:a(()=>[D(" Save "),s(v,{icon:"ri-save-line",class:"ms-3"})]),_:1},8,["loading","disabled"])]),_:1})]),_:1},512)]),_:1})]),_:1})}}},me={class:"d-flex justify-between align-center"},pe=e("div",{class:"w-100"},[e("h4",null,"Activity")],-1),fe=e("th",{class:"text-uppercase",width:"1%"}," No ",-1),he=e("th",{class:"text-uppercase text-center"},"Meeting Discussion",-1),ge=e("th",{class:"text-uppercase text-center"},"Date",-1),ye=e("th",{class:"text-uppercase text-center"},"Start Time",-1),ve=e("th",{class:"text-uppercase text-center",style:{width:"200px !important"}}," End Time ",-1),be=e("th",{class:"text-uppercase text-center"},"Time Spent",-1),xe=e("th",{class:"text-uppercase text-center"},"Status",-1),we={key:0,class:"text-uppercase text-end"},Ve={width:"1%"},ke={class:"text-start"},De={class:"text-center"},$e={class:"text-start"},Ce=["onUpdate:modelValue","onChange","disabled"],Te={class:"text-center"},Me={key:0,class:"text-end"},Se=["href"],Ne={__name:"timesheet-detail",props:{id:String,require:String},setup(U){const h=U,x=G("updateReload"),g=b([]),r=b(!1),w=b(le.getUser().role_detail[0].role.toLowerCase()),l=b([{add:!1,delete:!1}]),V=b([]),y=async()=>{r.value=!0;try{const n=await P.get("api/v1/timesheet/"+h.id+"/activities");n&&(g.value=n)}catch(n){console.error(n)}finally{r.value=!1}},d=n=>{l.value[n]?l.value[n]=!1:l.value[n]=!0},k=(n,c)=>{V.value=c,d(n)},f=async()=>{var n,c,i;r.value=!0;try{const m=await P.delete("api/v1/timesheet/"+h.id+"/activity/"+V.value.id);m&&(N("success",m.message,"bottom-end"),d("delete"))}catch(m){((n=m.response)==null?void 0:n.status)==400&&N("error",(i=(c=m.response)==null?void 0:c.data)==null?void 0:i.errors,"bottom-end")}finally{r.value=!1,y(),x(!0)}},o=ne(async n=>{n.end_date=n.date+" "+n.end_time+":00";try{const c=await P.put("api/v1/timesheet/"+h.id+"/activity/"+n.id,n);c&&N("success",c.message,"bottom-end")}catch(c){console.error(c)}finally{y(),x(!0)}},500),_=async n=>{var c,i;try{const m=await P.patch("api/v1/timesheet/"+h.id+"/activity/"+n.id,n);m&&N("success",m.message,"bottom-end")}catch(m){(i=(c=m==null?void 0:m.response)==null?void 0:c.data)!=null&&i.message&&N("error",m.response.data.message,"bottom-end"),console.error(m)}finally{y(),x(!0)}};return W(()=>{y()}),(n,c)=>(p(),S(A,null,{default:a(()=>[s(z,null,{default:a(()=>[e("div",me,[pe,j((p(),S(Y,{onClick:c[0]||(c[0]=i=>d("add"))},{default:a(()=>[s(v,{icon:"ri-add-line"})]),_:1})),[[E,"New Activity","start"]]),s(Q,{modelValue:t(l).add,"onUpdate:modelValue":c[2]||(c[2]=i=>t(l).add=i),"max-width":"600",persistent:""},{default:a(()=>[s(_e,{id:h.id,onClose:c[1]||(c[1]=i=>d("add")),onReload:y},null,8,["id"])]),_:1},8,["modelValue"])])]),_:1}),s(M,null,{default:a(()=>[t(r)?(p(),S(B,{key:1,type:"table"})):(p(),S(J,{key:0,class:"text-no-wrap",height:"400","fixed-header":""},{default:a(()=>[e("thead",null,[e("tr",null,[fe,he,ge,ye,ve,be,xe,t(w)!="mentor"?(p(),C("th",we," # ")):F("",!0)])]),e("tbody",null,[(p(!0),C(Z,null,X(t(g),(i,m)=>(p(),C("tr",{key:m},[e("td",Ve,u(m+1),1),e("td",ke,u(i.description),1),e("td",null,u(n.$moment(i.start_date).format("dddd"))+", "+u(n.$moment(i.start_date).format("MMM Do YYYY")),1),e("td",De,u(i.start_time),1),e("td",$e,[j(e("input",{type:"time",class:"form-control px-2 py-2 border rounded cursor-pointer","onUpdate:modelValue":T=>i.end_time=T,onChange:T=>t(o)(i),disabled:t(w)=="mentor"||i.start_time=="00:00"||i.cutoff_status=="completed"},null,40,Ce),[[ae,i.end_time],[E,i.cutoff_status=="completed"?"Already Cut-Off":"End Time","start"]])]),e("td",Te,u(i.estimate)+" Minutes",1),e("td",null,[j(s(ue,{color:"success",modelValue:i.status,"onUpdate:modelValue":[T=>i.status=T,T=>_(i)],value:!0,disabled:t(w)=="mentor"||i.start_time=="00:00"||i.cutoff_status=="completed"},null,8,["modelValue","onUpdate:modelValue","disabled"]),[[E,i.status?"Completed":"Not Yet","start"]])]),t(w)!="mentor"?(p(),C("td",Me,[s(Y,{color:"primary",density:"compact",class:"me-1"},{default:a(()=>[e("a",{href:i.meeting_link,target:"_blank",class:"bg-primary"},[s(v,{icon:"ri ri-link"}),D(" Join ")],8,Se)]),_:2},1024),j((p(),S(Y,{color:"error",density:"compact",disabled:i.start_time=="00:00"||i.cutoff_status=="completed",onClick:T=>k("delete",i)},{default:a(()=>[s(v,{icon:"ri-delete-bin-line",class:"cursor-pointer"})]),_:2},1032,["disabled","onClick"])),[[E,i.status?"Already Cut-Off":"Delete Activity","start"]])])):F("",!0)]))),128))])]),_:1}))]),_:1}),s(Q,{modelValue:t(l).delete,"onUpdate:modelValue":c[4]||(c[4]=i=>t(l).delete=i),"max-width":"400",persistent:""},{default:a(()=>[s(ie,{loading:t(r),title:"activity",onClose:c[3]||(c[3]=i=>d("delete")),onDelete:f},null,8,["loading"])]),_:1},8,["modelValue"])]),_:1}))}},Ue={class:"w-100"},Pe={class:"mt-3 font-weight-light"},Ae=e("hr",{class:"my-2"},null,-1),Ye={key:0},ze=e("tr",{class:"bg-secondary"},[e("td",null,"Name"),e("td",null,"School"),e("td",null,"Grade")],-1),Be={key:1},Le=e("td",{width:"20%"},"Name",-1),je=e("td",{width:"1%"},":",-1),qe=e("td",null,"School Name",-1),Ee=e("td",{width:"1%"},":",-1),Fe=e("td",null,"Grade",-1),Re=e("td",{width:"1%"},":",-1),Ie=e("td",null,"Email",-1),Oe=e("td",{width:"1%"},":",-1),Ge={class:"mt-5 font-weight-light"},He=e("hr",{class:"my-2"},null,-1),Je=e("td",{width:"20%"},"Program",-1),Ke=e("td",{width:"1%"},":",-1),Qe=e("td",null,"Package",-1),We=e("td",{width:"1%"},":",-1),Xe=e("td",null,"Person in Charge",-1),Ze=e("td",{width:"1%"},":",-1),et=e("td",null,"Tutor/Mentor",-1),tt=e("td",{width:"1%"},":",-1),st=e("td",null,"Notes",-1),lt=e("td",{width:"1%"},":",-1),at=e("td",null,"Update On",-1),ot=e("td",{width:"1%"},":",-1),it={class:"d-flex align-end w-100"},nt={class:"m-0 mb-1 text-white"},dt=e("h4",{class:"m-0 ms-2 text-white"},"Minutes",-1),rt={class:"text-end w-100"},ct={class:"d-flex align-end w-100"},ut={class:"m-0 mb-1 text-white"},_t=e("h4",{class:"m-0 ms-2 text-white"},"Minutes",-1),mt={class:"text-end w-100"},pt={class:"d-flex align-end w-100"},ft={class:"m-0 mb-1 text-white"},ht=e("h4",{class:"m-0 ms-2 text-white"},"Minutes",-1),gt={class:"text-end w-100"},yt={__name:"user-detail",props:{id:String},emits:["void"],setup(U,{emit:h}){const x=U,g=h,r=G("reloadData"),w=G("updateReload"),l=b([]),V=b(!1),y=async d=>{var k,f,o;V.value=!0;try{const _=await P.get("api/v1/timesheet/"+d+"/detail");_&&(l.value=_,g("void",_.packageDetails.void))}catch(_){((k=_.response)==null?void 0:k.status)==400&&(N("error",(o=(f=_.response)==null?void 0:f.data)==null?void 0:o.errors,"bottom-end"),ee.push("/admin/timesheet")),console.log(_)}finally{V.value=!1}};return W(()=>{y(x.id)}),oe(()=>{r.value&&(y(x.id),w(!1))}),(d,k)=>{const f=I("router-link");return p(),S(A,{class:"mb-3"},{default:a(()=>[s(z,{class:"d-flex justify-between align-center"},{default:a(()=>{var o,_,n,c,i;return[e("div",Ue,[s(f,{to:"/user/timesheet"},{default:a(()=>[s(v,{icon:"ri-arrow-left-line",color:"secondary",class:"me-2",size:"25"})]),_:1}),D(" "+u((o=t(l).packageDetails)==null?void 0:o.tutormentor_name)+" | "+u(((n=(_=t(l))==null?void 0:_.packageDetails)==null?void 0:n.package_type)+" - "+((i=(c=t(l))==null?void 0:c.packageDetails)==null?void 0:i.package_name)),1)])]}),_:1}),s(M,null,{default:a(()=>[t(V)?(p(),S(H,{key:1},{default:a(()=>[s($,{md:"7"},{default:a(()=>[s(B,{type:"heading, paragraph, heading, paragraph",class:"mb-3"})]),_:1}),s($,{md:"5"},{default:a(()=>[s(B,{type:"text@3",color:"#16B1FF",class:"mb-3"}),s(B,{type:"text@3",color:"#91c45e",class:"mb-3"}),s(B,{type:"text@3",color:"#e05e5e",class:"mb-3"})]),_:1})]),_:1})):(p(),S(H,{key:0,align:"center"},{default:a(()=>[s($,{md:"7"},{default:a(()=>[e("h4",Pe,[s(v,{icon:"ri-user-line",size:"17",class:"me-2"}),D(" Basic Profile ")]),Ae,s(J,{density:"compact"},{default:a(()=>{var o,_;return[((o=t(l).clientProfile)==null?void 0:o.length)>1?(p(),C("tbody",Ye,[ze,(p(!0),C(Z,null,X(t(l).clientProfile,n=>(p(),C("tr",null,[e("td",null,u(n.client_name),1),e("td",null,u(n.client_school),1),e("td",null,u(n.client_grade<=12?n.client_grade:"Not High School"),1)]))),256))])):((_=t(l).clientProfile)==null?void 0:_.length)==1?(p(),C("tbody",Be,[e("tr",null,[Le,je,e("td",null,u(t(l).clientProfile[0].client_name),1)]),e("tr",null,[qe,Ee,e("td",null,u(t(l).clientProfile[0].client_school),1)]),e("tr",null,[Fe,Re,e("td",null,u(t(l).clientProfile[0].client_grade<=12?t(l).clientProfile[0].client_grade:"Not High School"),1)]),e("tr",null,[Ie,Oe,e("td",null,u(t(l).clientProfile[0].client_mail),1)])])):F("",!0)]}),_:1}),e("h4",Ge,[s(v,{icon:"ri-bookmark-line",class:"me-2",size:"17"}),D(" Package Details ")]),He,s(J,{density:"compact"},{default:a(()=>{var o,_,n,c,i,m,T;return[e("tbody",null,[e("tr",null,[Je,Ke,e("td",null,u((o=t(l).packageDetails)!=null&&o.free_trial?"[TRIAL]":"")+" "+u((_=t(l).packageDetails)==null?void 0:_.program_name),1)]),e("tr",null,[Qe,We,e("td",null,u(((n=t(l).packageDetails)==null?void 0:n.package_type)+" - "+((c=t(l).packageDetails)==null?void 0:c.package_name)),1)]),e("tr",null,[Xe,Ze,e("td",null,u((i=t(l).packageDetails)==null?void 0:i.pic_name),1)]),e("tr",null,[et,tt,e("td",null,u((m=t(l).packageDetails)==null?void 0:m.tutormentor_name),1)]),e("tr",null,[st,lt,e("td",null,u((T=t(l).editableColumns)==null?void 0:T.notes),1)]),e("tr",null,[at,ot,e("td",null,u(t(O)().format("LLL")),1)])])]}),_:1})]),_:1}),s($,{md:"5"},{default:a(()=>[s(A,{color:"#16B1FF",class:"mb-2 d-flex align-center"},{default:a(()=>[e("div",null,[s(R,null,{default:a(()=>[s(z,{class:"text-white"},{default:a(()=>[D(" Total Minutes of Package ")]),_:1})]),_:1}),s(M,{class:"d-flex justify-between"},{default:a(()=>{var o;return[e("div",it,[e("h1",nt,u((o=t(l).packageDetails)==null?void 0:o.duration_in_minutes),1),dt])]}),_:1})]),s(M,null,{default:a(()=>[e("div",rt,[s(v,{icon:"ri-calendar-schedule-line",size:"60"})])]),_:1})]),_:1}),s(A,{color:"#91c45e",class:"mb-2 d-flex align-center"},{default:a(()=>[e("div",null,[s(R,null,{default:a(()=>[s(z,{class:"text-white"},{default:a(()=>[D(" Total Minutes Spent ")]),_:1})]),_:1}),s(M,{class:"d-flex justify-between"},{default:a(()=>{var o;return[e("div",ct,[e("h1",ut,u((o=t(l).packageDetails)==null?void 0:o.time_spent_in_minutes),1),_t])]}),_:1})]),s(M,null,{default:a(()=>[e("div",mt,[s(v,{icon:"ri-timer-flash-line",size:"60",color:"white"})])]),_:1})]),_:1}),s(A,{color:"#e05e5e",class:"mb-2 d-flex align-center"},{default:a(()=>[e("div",null,[s(R,null,{default:a(()=>[s(z,{class:"text-white"},{default:a(()=>[D(" Total Minutes Left ")]),_:1})]),_:1}),s(M,{class:"d-flex justify-between"},{default:a(()=>{var o,_;return[e("div",pt,[e("h1",ft,u(((o=t(l).packageDetails)==null?void 0:o.duration_in_minutes)-((_=t(l).packageDetails)==null?void 0:_.time_spent_in_minutes)),1),ht])]}),_:1})]),s(M,null,{default:a(()=>[e("div",gt,[s(v,{icon:"ri-timer-2-line",size:"60"})])]),_:1})]),_:1})]),_:1})]),_:1}))]),_:1})]),_:1})}}},vt={class:"h-auto position-relative"},bt={key:0,class:"overlay"},xt=e("div",{class:"bg-secondary",style:{height:"100%",position:"absolute",left:"0",top:"0","z-index":"9998",width:"100%",opacity:"0.6"}},null,-1),wt={class:"d-flex align-center justify-center",style:{height:"100%",position:"absolute",left:"0",top:"0","z-index":"9999",width:"100%",opacity:"1"}},Vt={class:"text-center"},kt=e("h2",{class:"text-white mt-3"},"This Timesheet Has Changed Owner",-1),Ft={__name:"timesheet-detail",props:{id:Number,require:String},setup(U){const h=U,x=h.id,g=b(!1),r=b(!1);K("reloadData",g),K("updateReload",l=>{g.value=l});const w=l=>{r.value=l};return(l,V)=>(p(),C("div",vt,[t(r)=="true"?(p(),C("div",bt,[xt,e("div",wt,[e("div",Vt,[s(v,{color:"white",icon:"ri-lock-line",size:"50"}),kt,s(Y,{color:"light",class:"mt-4",onClick:V[0]||(V[0]=y=>t(ee).push({path:"/user/timesheet"}))},{default:a(()=>[D(" Back to List ")]),_:1})])])])):F("",!0),s(yt,{id:t(x),onVoid:w},null,8,["id"]),s(Ne,{id:t(x),require:h.require},null,8,["id","require"])]))}};export{Ft as default};
