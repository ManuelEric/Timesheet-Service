import{a3 as we,r as m,o as _e,e as g,p as E,w as a,b as t,h as e,a as U,f as i,t as j,F as Z,a0 as oe,q as se,j as fe,H as Y,V as J,i as P,k as le,l as D,z as ve,A as F,s as ne,W as je,a1 as Ce,a4 as Te,y as Pe,n as pe}from"./main-31BZBg5W.js";import{r as C}from"./rules-CkvmYWH-.js";import{c as de,d as be,V as ce,b as qe}from"./VCard-DwN8Zydc.js";import{V as ye}from"./VForm-jjFivBLZ.js";import{V as me,a as f}from"./VRow-Dk_wgED3.js";import{V as R}from"./VAutocomplete-DSsnKVqh.js";import{V as re}from"./VTooltip-Bxyao0xB.js";import{V as Ve}from"./VTextarea-DMZ1NuJ7.js";import{V as ke}from"./VDialog-CsG5rnam.js";import{a as he,V as Ue}from"./VTable-CjaYAZCq.js";import{d as Se}from"./debounce-DvNt5CkH.js";import{V as $e}from"./VPagination-DgrOTU4Y.js";import{V as Ne}from"./VBadge-BTOKuLf3.js";import"./VAvatar-C5a1iPRk.js";import"./VImg-CEIj7A79.js";import"./VList-DzFEu4_D.js";import"./ssrBoot-DR086dO2.js";import"./VDivider-L9ov_RVp.js";import"./VCheckboxBtn-BXWavk8p.js";import"./VSelectionControl-Cm8SdHqD.js";import"./VSlideGroup-DR5zSto0.js";const te=we.create({baseURL:"https://crm.edu-all.com/api/v1/",headers:{"Content-Type":"application/json"}});te.interceptors.request.use(y=>y,y=>Promise.reject(y));te.interceptors.response.use(y=>y,y=>{var b;return((b=y==null?void 0:y.response)==null?void 0:b.status)===401&&router.go(0),Promise.reject(y)});const Ie={async get(y,b={}){try{return(await te.get(y,b)).data}catch(w){return Promise.reject(w)}},async post(y,b){try{return(await te.post(y,b)).data}catch(w){return Promise.reject(w)}},async patch(y,b){try{return(await te.patch(y,b)).data}catch(w){return Promise.reject(w)}},async put(y,b){try{return(await te.put(y,b)).data}catch(w){return Promise.reject(w)}},async delete(y){try{return(await te.delete(y)).data}catch(b){return Promise.reject(b)}}},Fe={key:0,class:"mb-4 d-flex gap-1"},Me={class:"text-sm"},ge="mentor",De={__name:"program_add_specialist_timesheet",emits:["close","reload"],setup(y,{emit:b}){const w=b,u=m(!1),_=m([]),K=m([]),O=m([]);m([]);const B=m([]),$=m([]),z=m([]),A=m(!1),ee=m(null),N=m(null),I=m([]),ae=m(),r=m({ref_details:[],mentortutor_email:null,subject_id:null,inhouse_id:null,package_id:null,duration:"",tax:null,individual_fee:null,notes:"",pic_id:[]}),S=async()=>{const d="get/active/mentees/global";try{const p=await Ie.get(d);p&&(O.value=p)}catch(p){console.error(p)}},Q=async(d=!1)=>{const M=d?"api/v1/user/mentor-tutors?inhouse=true&role="+ge:"api/v1/user/mentor-tutors?role="+"External Mentor";try{const T=await F.get(M);T&&(d?z.value=Object.values(T):K.value=T)}catch(T){console.error(T)}},o=async()=>{try{const d=await F.get("api/v1/package/component/list?category="+ge);d&&(B.value=d)}catch(d){console.error(d)}},h=()=>{const d=r.value.package_id,p=B.value.findIndex(T=>T.id===d);let M=B.value[p];M.detail?(A.value=!0,r.value.duration=M.detail):(A.value=!1,r.value.duration=null)},W=async()=>{try{const d=await F.get("api/v1/user/component/list");d&&($.value=d)}catch(d){console.error(d)}},V=async(d,p=null,M=0)=>{var T,l,c,n;r.value.subject_id=null,ee.value=M,r.value.tax=(M==1,2.5),r.value.subject_id=(l=(T=d[0])==null?void 0:T.subjects[0])==null?void 0:l.id,r.value.individual_fee=(n=(c=d[0])==null?void 0:c.subjects[0])==null?void 0:n.fee_individual,r.value.individual_fee?L():N.value=null},X=async()=>{try{const d=await F.get("api/v1/engagement-type/component/list");d&&(I.value=d)}catch(d){console.log(d)}},v=async()=>{var p,M,T;r.value.mentortutor_email=_.value.email;const{valid:d}=await ae.value.validate();if(d){u.value=!0;try{const l=await F.post("api/v1/timesheet/create/skip-request",r.value);l&&(ne("success",l.message,"bottom-end"),w("reload"),r.value={ref_details:[],mentortutor_email:null,subject_id:null,subject_name:null,inhouse_id:null,package_id:null,duration:"",notes:"",pic_id:[],tax:null,individual_fee:""},_.value=[],window.open("/admin/timesheet/specialist/"+((p=l.data)==null?void 0:p.timesheet_id),"_blank"))}catch(l){if((T=(M=l==null?void 0:l.response)==null?void 0:M.data)!=null&&T.errors){const c=l.response.data.errors;ne("error",c,"bottom-end")}}finally{w("close"),u.value=!1}}},L=()=>{const d=r.value.individual_fee*(1-r.value.tax/100);N.value=Math.trunc(d)},G=()=>{const d=N.value/(1-r.value.tax/100);r.value.individual_fee=Math.trunc(d)};return _e(()=>{S(),X(),Q(),Q(!0),o(),W()}),(d,p)=>(g(),E(ce,{"max-width":"650","prepend-icon":"ri-send-plane-line",title:"Assign to Subject Specialist"},{default:a(()=>[t(de,null,{default:a(()=>{var M,T;return[((M=e(r).ref_details)==null?void 0:M.length)>0?(g(),U("div",Fe,[i("p",Me,j(((T=e(r).ref_details)==null?void 0:T.length)>1?"Students":"Student")+":",1),(g(!0),U(Z,null,oe(e(r).ref_details,l=>(g(),U("p",{key:l,class:"text-sm bg-info px-2 rounded"},j(l.student_first_name+" "+l.student_last_name),1))),128))])):se("",!0),t(ye,{onSubmit:fe(v,["prevent"]),ref_key:"formData",ref:ae,"validate-on":"input"},{default:a(()=>[t(me,null,{default:a(()=>[t(f,{cols:"12"},{default:a(()=>[t(R,{clearable:"",modelValue:e(r).engagement_type,"onUpdate:modelValue":p[0]||(p[0]=l=>e(r).engagement_type=l),items:e(I),"item-props":l=>({title:l.name}),"item-value":"id",label:"Engagement Type",rules:e(C).required,loading:e(u),disabled:e(u)},null,8,["modelValue","items","item-props","rules","loading","disabled"])]),_:1}),t(f,{md:"12",cols:"12"},{default:a(()=>[t(R,{clearable:"",modelValue:e(r).ref_details,"onUpdate:modelValue":p[1]||(p[1]=l=>e(r).ref_details=l),label:"Mentee Name",items:e(O),"item-props":l=>({title:l.first_name+" "+l.last_name,subtitle:l.sch_name,value:{clientprog_id:l.clientprog_id,invoice_id:l.invoice_id,student_uuid:l.id,student_first_name:l.first_name,student_last_name:l.last_name,student_school:l.sch_name,student_grade:l.grade,program_name:l.program_name,require:l.require,package:l.package,curriculum:l.curriculum,engagement_type:e(r).engagement_type}}),rules:e(C).required,loading:e(u),disabled:e(u),density:"compact",multiple:""},null,8,["modelValue","items","item-props","rules","loading","disabled"])]),_:1}),t(f,{md:"12",cols:"12"},{default:a(()=>[t(R,{density:"compact",clearable:"",modelValue:e(_),"onUpdate:modelValue":[p[2]||(p[2]=l=>Y(_)?_.value=l:null),p[3]||(p[3]=l=>V(e(_).roles,e(_).uuid,e(_).has_npwp))],label:"Subject Specialist Name",items:e(K),"item-props":l=>({title:l.full_name,subtitle:l.roles.map(c=>c.name).join(", ")}),rules:e(C).required,loading:e(u),disabled:e(u)},null,8,["modelValue","items","item-props","rules","loading","disabled"])]),_:1}),t(f,{md:"8",cols:"8"},{default:a(()=>[t(R,{density:"compact",clearable:"",label:"Package",modelValue:e(r).package_id,"onUpdate:modelValue":[p[4]||(p[4]=l=>e(r).package_id=l),h],items:e(B),"item-props":l=>({title:l.package!=null?l.type_of+" - "+l.package:l.type_of,subtitle:l.detail?l.detail/60+" Hours":"Customizable"}),"item-value":"id",rules:e(C).required,loading:e(u),disabled:e(u)},null,8,["modelValue","items","item-props","rules","loading","disabled"])]),_:1}),t(f,{md:"4",cols:"4"},{default:a(()=>[t(J,{density:"compact",type:"number",clearable:"",label:+e(r).duration/60?""+e(r).duration/60+" Hours":"Minutes",readonly:e(A),modelValue:e(r).duration,"onUpdate:modelValue":p[5]||(p[5]=l=>e(r).duration=l),rules:e(C).required},null,8,["label","readonly","modelValue","rules"])]),_:1}),t(f,{md:"4",cols:"7"},{default:a(()=>[t(J,{type:"number",clearable:"",label:"Fee/hours (Nett)",modelValue:e(N),"onUpdate:modelValue":[p[6]||(p[6]=l=>Y(N)?N.value=l:null),G],density:"compact",rules:e(C).required},null,8,["modelValue","rules"])]),_:1}),t(f,{md:"4",cols:"5"},{default:a(()=>[t(J,{type:"number",clearable:"",label:"Tax",modelValue:e(r).tax,"onUpdate:modelValue":[p[7]||(p[7]=l=>e(r).tax=l),G],rules:e(C).required,density:"compact"},null,8,["modelValue","rules"])]),_:1}),t(f,{md:"4",cols:"12"},{default:a(()=>[t(re,{activator:"parent",location:"top"},{default:a(()=>[P(" Fee Gross is automatically calculated based on the entered Net Fee and Tax Rate. ")]),_:1}),t(J,{type:"number",clearable:"",label:"Fee/hours (Gross)",modelValue:e(r).individual_fee,"onUpdate:modelValue":[p[8]||(p[8]=l=>e(r).individual_fee=l),L],density:"compact",readonly:"",rules:e(C).required},null,8,["modelValue","rules"])]),_:1}),t(f,{md:"6",cols:"12"},{default:a(()=>[t(R,{density:"compact",clearable:"",modelValue:e(r).inhouse_id,"onUpdate:modelValue":p[9]||(p[9]=l=>e(r).inhouse_id=l),label:"Inhouse Mentor",items:e(z),"item-props":l=>({title:l.full_name}),"item-value":"uuid",loading:e(u),disabled:e(u),rules:e(C).required},null,8,["modelValue","items","item-props","loading","disabled","rules"])]),_:1}),t(f,{md:"6",cols:"12"},{default:a(()=>[t(R,{density:"compact",multiple:"",clearable:"",chips:"",label:"PIC",modelValue:e(r).pic_id,"onUpdate:modelValue":p[10]||(p[10]=l=>e(r).pic_id=l),items:e($),"item-title":"full_name","item-value":"id",loading:e(u),disabled:e(u),rules:e(C).required},null,8,["modelValue","items","loading","disabled","rules"])]),_:1}),t(f,{md:"12"},{default:a(()=>[t(Ve,{label:"Notes",modelValue:e(r).notes,"onUpdate:modelValue":p[11]||(p[11]=l=>e(r).notes=l)},null,8,["modelValue"])]),_:1})]),_:1}),t(be,{class:"mt-5 px-0"},{default:a(()=>[t(le,{variant:"tonal",color:"error",type:"button",onClick:p[12]||(p[12]=l=>w("close"))},{default:a(()=>[t(D,{icon:"ri-close-line",class:"me-3"}),P(" Close ")]),_:1}),t(ve),t(le,{variant:"tonal",color:"success",type:"submit"},{default:a(()=>[P(" Save "),t(D,{icon:"ri-save-line",class:"ms-3"})]),_:1})]),_:1})]),_:1},512)]}),_:1})]),_:1}))}},Re={key:0,class:"mb-4 d-flex gap-1"},Ae={class:"text-sm"},Ge={class:"d-flex justify-between align-center mb-3"},He=i("h4",{class:"w-100"},"Detail",-1),Ee=i("thead",null,[i("tr",null,[i("th",{class:"text-left",nowrap:""}," Subject Tutoring "),i("th",{nowrap:""},"Grade"),i("th",{nowrap:""},"Year"),i("th",{nowrap:""},"Fee Individual - Gross")])],-1),Be={nowrap:""},ze={nowrap:""},Le={nowrap:""},Oe={nowrap:""},We={__name:"program_add_tutoring",emits:["close","reload"],setup(y,{emit:b}){const w=b,u=m(!1),_=m(null),K=m([]),O=m([]),B=m([]),$=m([]),z=m([]),A=m([]),ee=m([]),N=m(!1),I=m("tutor"),ae=m(null),r=m(null),S=m([]),Q=m(),o=m({ref_id:null,mentortutor_email:null,subject_id:null,inhouse_id:null,package_id:null,tax:null,individual_fee:null,duration:"",notes:"",pic_id:[],curriculum_id:null}),h=async()=>{var n,x;const c="api/v1/program/list";try{u.value=!0;const k=await F.get(c);k&&(K.value=k),u.value=!1}catch(k){ne("error",(x=(n=k.response)==null?void 0:n.data)==null?void 0:x.message,"bottom-end"),console.error(k),u.value=!1}},W=async(c=!1)=>{const n=c?"api/v1/user/mentor-tutors?inhouse=true&role="+I.value:"api/v1/user/mentor-tutors?role="+I.value;try{const x=await F.get(n);x&&(c?ee.value=Object.values(x):O.value=x)}catch(x){console.error(x)}},V=async()=>{try{const c=await F.get("api/v1/package/component/list?category="+I.value);c&&(z.value=c)}catch(c){console.error(c)}},X=()=>{const c=o.value.package_id,n=z.value.findIndex(k=>k.id===c);let x=z.value[n];x.detail?(N.value=!0,o.value.duration=x.detail):(N.value=!1,o.value.duration=null)},v=async()=>{try{const c=await F.get("api/v1/user/component/list");c&&(A.value=c)}catch(c){console.error(c)}},L=async(c,n=null,x=0)=>{if(ae.value=x,o.value.tax=(x==1,2.5),o.value.subject_id=null,I.value=="mentor")o.value.subject_id=c[0].subjects[0].id;else try{const k=await F.get("api/v1/user/mentor-tutors/"+n+"/subjects");k&&($.value=k)}catch(k){console.error(k)}},G=async(c,n,x)=>{if(n)try{const k=await F.get("api/v1/component/fee/"+c+"/"+n+"/"+x);k&&(o.value.individual_fee=k.fee_individual,k.fee_individual?T():r.value=null)}catch(k){console.error(k)}},d=async()=>{try{const c=await F.get("api/v1/curriculum/component/list");c&&(B.value=c)}catch(c){console.error(c)}},p=async()=>{var n,x,k;o.value.mentortutor_email=_.value.email;const{valid:c}=await Q.value.validate();if(c){u.value=!0;try{const H=await F.post("api/v1/timesheet/create",o.value);H&&(ne("success",H.message,"bottom-end"),w("reload"),o.value={ref_id:[],mentortutor_email:null,subject_id:null,subject_name:null,inhouse_id:null,package_id:null,duration:"",notes:"",pic_id:[],tax:null,individual_fee:"",curriculum_id:null},_.value=null,window.open("/admin/timesheet/tutoring/"+((n=H.data)==null?void 0:n.timesheet_id),"_blank"))}catch(H){if(console.log(H),(k=(x=H==null?void 0:H.response)==null?void 0:x.data)!=null&&k.errors){const s=H.response.data.errors;ne("error",s,"bottom-end")}}finally{w("close"),u.value=!1}}},M=()=>{o.value={ref_id:S.value.map(c=>c.id),curriculum_id:S.value[0].curriculum??null,package_id:S.value[0].package??null,program_name:S.value[0].program_name??null}},T=()=>{const c=o.value.individual_fee*(1-o.value.tax/100);r.value=Math.trunc(c)},l=()=>{const c=r.value/(1-o.value.tax/100);o.value.individual_fee=Math.trunc(c)};return _e(()=>{h(),W(),W(!0),V(),v(),d()}),(c,n)=>{var x;return g(),E(ce,{"max-width":"650","prepend-icon":"ri-send-plane-line",title:((x=e(S)[0])==null?void 0:x.program_name)??"Assign to Tutor"},{default:a(()=>[t(de,null,{default:a(()=>{var k,H;return[((k=e(S))==null?void 0:k.length)>0?(g(),U("div",Re,[i("p",Ae,j(((H=e(S))==null?void 0:H.length)>1?"Students":"Student")+":",1),(g(!0),U(Z,null,oe(e(S),s=>(g(),U("p",{key:s,class:"text-sm bg-info px-2 rounded"},j(s.mentee),1))),128))])):se("",!0),t(ye,{onSubmit:fe(p,["prevent"]),ref_key:"formData",ref:Q,"validate-on":"input"},{default:a(()=>[t(me,null,{default:a(()=>[t(f,{md:"12",cols:"12"},{default:a(()=>[t(R,{clearable:"",modelValue:e(S),"onUpdate:modelValue":[n[0]||(n[0]=s=>Y(S)?S.value=s:null),M],label:"Mentee Name",items:e(K),"item-props":s=>({title:s.student_name,subtitle:s.program_name+(s.timesheet_id?" ✅":"")+(s.scnd_timesheet_id?" ✅":""),disabled:s.timesheet_id&&s.scnd_timesheet_id,value:{id:s.id,require:s.require,mentee:s.student_name,package:s.package,curriculum:s.curriculum,program_name:s.program_name}}),rules:e(C).required,loading:e(u),disabled:e(u),density:"compact",multiple:""},null,8,["modelValue","items","item-props","rules","loading","disabled"])]),_:1}),t(f,{cols:e(_)?11:12},{default:a(()=>[t(R,{clearable:"",modelValue:e(_),"onUpdate:modelValue":[n[1]||(n[1]=s=>Y(_)?_.value=s:null),n[2]||(n[2]=s=>L(e(_).roles,e(_).uuid,e(_).has_npwp))],label:"Tutor Name",items:e(O),"item-props":s=>({title:s.full_name,subtitle:s.roles.map(q=>q.name).join(", ")}),rules:e(C).required,loading:e(u),disabled:e(u),density:"compact"},null,8,["modelValue","items","item-props","rules","loading","disabled"])]),_:1},8,["cols"]),e(_)?(g(),E(f,{key:0,cols:"1"},{default:a(()=>[t(ke,{"max-width":"600"},{activator:a(({props:s})=>[t(re,{activator:"parent",location:"end"},{default:a(()=>[P("Fee Detail")]),_:1}),t(D,je({icon:"ri-folder-info-line",class:"cursor-pointer mt-3"},s),null,16)]),default:a(({isActive:s})=>[t(ce,null,{default:a(()=>[t(de,{class:"py-5"},{default:a(()=>{var q;return[i("div",Ge,[He,t(le,{size:"x-small",color:"secondary",icon:"ri-close-line",onClick:ie=>s.value=!1},null,8,["onClick"])]),((q=e(_))==null?void 0:q.roles.findIndex(ie=>ie.name==="Tutor"))>=0?(g(),E(he,{key:0,density:"compact"},{default:a(()=>[Ee,i("tbody",null,[(g(!0),U(Z,null,oe(e(_).roles,(ie,xe)=>(g(),U(Z,{key:xe},[ie.name=="Tutor"?(g(!0),U(Z,{key:0},oe(ie.subjects,ue=>(g(),U("tr",{key:ue},[i("td",Be,j(ue.tutor_subject),1),i("td",ze,j(ue.grade),1),i("td",Le,j(ue.year),1),i("td",Oe,"Rp. "+j(new Intl.NumberFormat("id-ID").format(ue.fee_individual)),1)]))),128)):se("",!0)],64))),128))])]),_:1})):(g(),E(de,{key:1,class:"text-center"},{default:a(()=>[P(" There is no tutoring subject ")]),_:1}))]}),_:2},1024)]),_:2},1024)]),_:1})]),_:1})):se("",!0),t(f,{md:"6",cols:"6"},{default:a(()=>{var s;return[t(R,{clearable:"",modelValue:e(o).curriculum_id,"onUpdate:modelValue":[n[3]||(n[3]=q=>e(o).curriculum_id=q),n[4]||(n[4]=q=>G(e(_).id,e(o).subject_name,e(o).curriculum_id))],label:"Curriculum",items:e(B),"item-props":q=>({title:q.name}),rules:e(C).required,loading:e(u),disabled:e(u)||((s=e(S)[0])==null?void 0:s.curriculum),density:"compact","item-value":"id"},null,8,["modelValue","items","item-props","rules","loading","disabled"])]}),_:1}),t(f,{md:"6",cols:"6"},{default:a(()=>[t(R,{clearable:"",modelValue:e(o).subject_name,"onUpdate:modelValue":[n[5]||(n[5]=s=>e(o).subject_name=s),n[6]||(n[6]=s=>G(e(_).id,e(o).subject_name,e(o).curriculum_id))],label:"Subject Tutoring",items:e($),loading:e(u),disabled:e(u),rules:e(C).required,density:"compact"},null,8,["modelValue","items","loading","disabled","rules"])]),_:1}),t(f,{md:"8",cols:"8"},{default:a(()=>{var s;return[t(R,{clearable:"",label:"Package",modelValue:e(o).package_id,"onUpdate:modelValue":[n[7]||(n[7]=q=>e(o).package_id=q),X],items:e(z),density:"compact","item-props":q=>({title:q.package!=null?q.type_of+" - "+q.package:q.type_of,subtitle:q.detail?q.detail/60+" Hours":"Customizable"}),"item-value":"id",rules:e(C).required,loading:e(u),disabled:e(u)||((s=e(S)[0])==null?void 0:s.package)},null,8,["modelValue","items","item-props","rules","loading","disabled"])]}),_:1}),t(f,{md:"4",cols:"4"},{default:a(()=>[t(J,{type:"number",clearable:"",label:+e(o).duration/60?"Minutes ("+e(o).duration/60+" Hours)":"Minutes",readonly:e(N),modelValue:e(o).duration,"onUpdate:modelValue":n[8]||(n[8]=s=>e(o).duration=s),density:"compact",rules:e(C).required},null,8,["label","readonly","modelValue","rules"])]),_:1}),t(f,{md:"4",cols:"7"},{default:a(()=>[t(J,{type:"number",clearable:"",label:"Fee/hours (Nett)",modelValue:e(r),"onUpdate:modelValue":[n[9]||(n[9]=s=>Y(r)?r.value=s:null),l],density:"compact",rules:e(C).required},null,8,["modelValue","rules"])]),_:1}),t(f,{md:"4",cols:"5"},{default:a(()=>[t(J,{type:"number",clearable:"",label:"Tax",modelValue:e(o).tax,"onUpdate:modelValue":[n[10]||(n[10]=s=>e(o).tax=s),l],rules:e(C).required,density:"compact"},null,8,["modelValue","rules"])]),_:1}),t(f,{md:"4",cols:"12"},{default:a(()=>[t(re,{activator:"parent",location:"top"},{default:a(()=>[P(" Fee Gross is automatically calculated based on the entered Net Fee and Tax Rate. ")]),_:1}),t(J,{type:"number",clearable:"",label:"Fee/hours (Gross)",modelValue:e(o).individual_fee,"onUpdate:modelValue":[n[11]||(n[11]=s=>e(o).individual_fee=s),T],density:"compact",readonly:"",rules:e(C).required},null,8,["modelValue","rules"])]),_:1}),t(f,{md:"6",cols:"6"},{default:a(()=>[t(R,{clearable:"",modelValue:e(o).inhouse_id,"onUpdate:modelValue":n[12]||(n[12]=s=>e(o).inhouse_id=s),label:"Inhouse Mentor/Tutor",items:e(ee),density:"compact","item-props":s=>({title:s.full_name}),"item-value":"uuid",loading:e(u),disabled:e(u),rules:e(C).required},null,8,["modelValue","items","item-props","loading","disabled","rules"])]),_:1}),t(f,{md:"6",cols:"6"},{default:a(()=>[t(R,{multiple:"",clearable:"",chips:"",label:"PIC",modelValue:e(o).pic_id,"onUpdate:modelValue":n[13]||(n[13]=s=>e(o).pic_id=s),items:e(A),"item-title":"full_name","item-value":"id",loading:e(u),density:"compact",disabled:e(u),rules:e(C).required},null,8,["modelValue","items","loading","disabled","rules"])]),_:1}),t(f,{md:"12"},{default:a(()=>[t(Ve,{label:"Notes",modelValue:e(o).notes,"onUpdate:modelValue":n[14]||(n[14]=s=>e(o).notes=s),density:"compact"},null,8,["modelValue"])]),_:1})]),_:1}),t(be,{class:"mt-5 px-0"},{default:a(()=>[t(le,{variant:"tonal",color:"error",type:"button",onClick:n[15]||(n[15]=s=>w("close"))},{default:a(()=>[t(D,{icon:"ri-close-line",class:"me-3"}),P(" Close ")]),_:1}),t(ve),t(le,{variant:"tonal",color:"success",type:"submit"},{default:a(()=>[P(" Save "),t(D,{icon:"ri-save-line",class:"ms-3"})]),_:1})]),_:1})]),_:1},512)]}),_:1})]),_:1},8,["title"])}}},Ye=i("div",{class:"d-flex justify-between align-center"},[i("div",{class:"w-100"},[i("h4",null,"Timesheet List")])],-1),Je={class:"d-flex gap-2"},Ke=i("th",{class:"text-uppercase",width:"1%"}," No ",-1),Qe=i("th",{class:"text-uppercase text-center"},"School/Student Name",-1),Xe={class:"text-uppercase text-center"},Ze=i("th",{class:"text-uppercase text-center"},"Package",-1),et=i("th",{class:"text-uppercase text-center"},"Tutor/Mentor",-1),tt=i("th",{class:"text-uppercase text-center"},"PIC",-1),lt=i("th",{class:"text-uppercase text-center"},"Total Hours",-1),at=i("th",{class:"text-uppercase text-center"},"Used",-1),ot=i("th",{class:"text-uppercase text-center"},"#",-1),st=["onClick"],nt={key:0},rt={key:1},it={class:"text-start"},ut={class:"text-left"},dt={class:"text-left"},ct={class:"text-left"},mt={class:"text-left"},pt={key:0},_t=i("tr",null,[i("td",{colspan:"9",class:"text-center"}," Sorry, no data found. ")],-1),gt=[_t],ft={class:"d-flex justify-center mt-5"},Rt={__name:"timesheet",props:{name:String},setup(y){const b=y,w=Te();m([]);const u=m(!1),_=m(1),K=m(),O=m(),B=m([]),$=m(!1),z=m([]),A=m(),ee=m([]),N=m(),I=async()=>{var L,G;const o="?page="+_.value,h=O.value?"&keyword="+O.value:"",W=A.value?"&program_name="+encodeURIComponent(A.value):"",V=N.value?"&package_id="+N.value:"",X="&paginate=true",v=b.name!="tutoring"?"&is_subject_specialist=true":"";try{$.value=!0;const d=await F.get("api/v1/timesheet/list"+o+h+W+V+X+v);d&&(_.value=d.current_page,K.value=d.last_page,B.value=d),$.value=!1}catch(d){ne("error",(G=(L=d.response)==null?void 0:L.data)==null?void 0:G.message,"bottom-end"),console.error(d),$.value=!1}},ae=async()=>{try{const o=await F.get("api/v1/program/component/list");o&&(z.value=o)}catch(o){console.error(o)}},r=async()=>{try{const o=await F.get("api/v1/package/component/list");o&&(ee.value=o)}catch(o){console.error(o)}},S=Se(async o=>{_.value=1,O.value=o.target.value,await I()},1e3),Q=o=>{const h=w.resolve("/admin/timesheet/"+b.name+"/"+o);window.open(h.href,"_blank")};return Ce(()=>{I()}),_e(()=>{I(),ae(),r()}),(o,h)=>{const W=Pe("VText");return g(),U(Z,null,[t(ke,{modelValue:e(u),"onUpdate:modelValue":h[2]||(h[2]=V=>Y(u)?u.value=V:null),width:"auto",persistent:""},{default:a(()=>[b.name=="tutoring"?(g(),E(We,{key:0,onClose:h[0]||(h[0]=V=>u.value=!1),onReload:I})):(g(),E(De,{key:1,onClose:h[1]||(h[1]=V=>u.value=!1),onReload:I}))]),_:1},8,["modelValue"]),t(ce,null,{default:a(()=>[t(qe,null,{default:a(()=>[Ye]),_:1}),t(de,null,{default:a(()=>[t(me,{class:"my-1 justify-space-between"},{default:a(()=>[b.name=="tutoring"?(g(),E(f,{key:0,cols:"12",md:"6"},{default:a(()=>[t(me,null,{default:a(()=>[t(f,{cols:"12",md:"6"},{default:a(()=>[t(R,{density:"compact",clearable:"",modelValue:e(A),"onUpdate:modelValue":[h[3]||(h[3]=V=>Y(A)?A.value=V:null),I],label:"Program Name",items:e(z),"item-title":"program_name",placeholder:"Select Program Name",loading:e($),disabled:e($)},null,8,["modelValue","items","loading","disabled"])]),_:1}),t(f,{cols:"12",md:"6"},{default:a(()=>[t(R,{density:"compact",clearable:"true",modelValue:e(N),"onUpdate:modelValue":[h[4]||(h[4]=V=>Y(N)?N.value=V:null),I],label:"Package",items:e(ee),"item-props":V=>({title:V.package!=null?V.type_of+" - "+V.package:V.type_of}),"item-value":"id",placeholder:"Select Package",loading:e($),disabled:e($)},null,8,["modelValue","items","item-props","loading","disabled"])]),_:1})]),_:1})]),_:1})):se("",!0),t(f,{cols:"12",md:b.name=="tutoring"?3:12},{default:a(()=>[i("div",Je,[t(J,{density:"compact",loading:e($),disabled:e($),"append-inner-icon":"ri-search-line",label:"Search","hide-details":"","single-line":"",onInput:e(S)},null,8,["loading","disabled","onInput"]),i("div",{class:pe(["text-end",b.name=="tutoring"?"":"w-md-75"])},[t(re,{activator:"parent",location:"start"},{default:a(()=>[P("Add New Timesheet")]),_:1}),t(le,{icon:"ri-add-line",onClick:h[5]||(h[5]=V=>u.value=!0)})],2)])]),_:1},8,["md"])]),_:1}),e($)?(g(),E(Ue,{key:0,class:"mx-auto border",type:"table-thead, table-row@10"})):(g(),E(he,{key:1,class:"text-no-wrap",hover:""},{default:a(()=>{var V,X;return[i("thead",null,[i("tr",null,[Ke,Qe,i("th",Xe,j(b.name=="tutoring"?"Program Name":"Engagement Type"),1),Ze,et,tt,lt,at,ot])]),i("tbody",null,[(g(!0),U(Z,null,oe(e(B).data,(v,L)=>(g(),U("tr",{key:L,class:pe([v.void=="true"?"bg-secondary":"","cursor-pointer"]),onClick:G=>Q(v.id)},[i("td",null,j(parseInt(L)+1),1),i("td",{class:pe(v.group?"cursor-pointer text-left":"text-left")},[v.group?(g(),E(W,{key:0},{default:a(()=>[t(D,{icon:"ri-group-line",class:"me-3"}),P(" "+j(v.clients[0])+" ",1),t(Ne,{color:"error",content:v.clients.length-1+"+",inline:""},null,8,["content"]),t(re,{activator:"parent",location:"top",transition:"scroll-y-transition",class:"bg-white"},{default:a(()=>[(g(!0),U(Z,null,oe(v.clients,G=>(g(),U("div",null,j(G),1))),256))]),_:2},1024)]),_:2},1024)):(g(),E(W,{key:1},{default:a(()=>[t(D,{icon:"ri-user-line",class:"me-3"}),P(" "+j(v.clients),1)]),_:2},1024))],2),b.name=="tutoring"?(g(),U("td",nt,[t(D,{icon:"ri-bookmark-3-line",class:"me-3"}),P(" "+j(v.detail_package=="Trial"?"[TRIAL]":"")+" "+j(v.program_name),1)])):(g(),U("td",rt,[t(D,{icon:"ri-bookmark-3-line",class:"me-3"}),P(" "+j(v.engagement_type),1)])),i("td",it,[t(D,{icon:"ri-bookmark-line",class:"me-3"}),P(" "+j(v.detail_package?v.package_type+" - "+v.detail_package:v.package_type),1)]),i("td",ut,[t(D,{icon:"ri-user-line",class:"me-3"}),P(" "+j(v.tutor_mentor),1)]),i("td",dt,[t(D,{icon:"ri-user-line",class:"cursor-pointer me-3"}),P(" "+j(v.admin),1)]),i("td",ct,[t(D,{icon:"ri-calendar-schedule-line",class:"cursor-pointer me-3"}),P(" "+j(v.duration/60)+" Hours ",1)]),i("td",mt,[t(D,{icon:"ri-timer-2-line",class:"cursor-pointer me-3"}),P(" "+j(v.spent/60)+" Hours ",1)]),i("td",null,[t(le,{color:v.void=="true"?"light":"secondary",onClick:G=>Q(v.id)},{default:a(()=>[t(D,{icon:"ri-timeline-view",class:"cursor-pointer"}),t(re,{activator:"parent",location:"top",transition:"scroll-y-transition"},{default:a(()=>[P(" View Detail ")]),_:1})]),_:2},1032,["color","onClick"])])],10,st))),128))]),((X=(V=e(B))==null?void 0:V.data)==null?void 0:X.length)==0?(g(),U("tfoot",pt,gt)):se("",!0)]}),_:1})),i("div",ft,[t($e,{modelValue:e(_),"onUpdate:modelValue":[h[6]||(h[6]=V=>Y(_)?_.value=V:null),I],length:e(K),"total-visible":4,color:"primary","show-first-last-page":!1},null,8,["modelValue","length"])])]),_:1})]),_:1})],64)}}};export{Rt as default};
