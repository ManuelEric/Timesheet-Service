import{r as f,o as Z,y as j,e as D,p as h,w as s,b as e,j as H,h as t,V as N,k as $,l as w,i as x,z,A,D as M,s as U,f as n,H as P,a as q,F as K,q as L,x as te,W as le,a0 as ae,t as Y}from"./main-D8kh9FUH.js";import{r as S}from"./rules-CkvmYWH-.js";import{c as B,d as W,V as E,b as se}from"./VCard-C2gxe2Ll.js";import{V as G}from"./VForm-D7sQDwXz.js";import{V as O,a as T}from"./VRow-DPddWYrh.js";import{V as ee,a as oe}from"./VAutocomplete-CHsEVAXy.js";import{V as J}from"./VDivider-Ctc1SDma.js";import{d as ne}from"./debounce-DEHhXTtI.js";import{V as R}from"./VDialog-BWox5jRN.js";import{V as de,a as Q}from"./VList-j3AJmfRC.js";import{a as ue,V as re}from"./VTable-BA_RiPSC.js";import{V as ie}from"./VPagination-CRty-ipS.js";import{V as me}from"./VCheckbox-BdEbiUVe.js";import"./VAvatar-B-p5cL0r.js";import"./VImg-CBrU41Vd.js";import"./VCheckboxBtn-CIPJgYyL.js";import"./VSelectionControl-Cz6x8c9m.js";import"./VSlideGroup-B0AamQsp.js";import"./ssrBoot-AaDZqWOI.js";const X={__name:"additional_add",props:{title:String},emits:["close","reload"],setup(F,{emit:_}){const g=F,d=_,V=f(),p=f({timesheet_id:null,fee:null,date:null}),m=f([]),i=f(!1),k=async()=>{i.value=!0;try{const a=await A.get("api/v1/timesheet/component/list");a&&(m.value=a)}catch(a){console.error(a)}finally{i.value=!1}},C=async()=>{var u,r;const a=g.title=="bonus"?"api/v1/payment/bonus/create":"api/v1/payment/additional-fee/create",{valid:c}=await V.value.validate();if(c){p.value.date=M(p.value.date).format("YYYY-MM-DD");try{const l=await A.post(a,p.value);l&&U("success",l.message,"bottom-end")}catch(l){const o=(r=(u=l==null?void 0:l.response)==null?void 0:u.data)==null?void 0:r.errors;U("error",o,"bottom-end")}finally{d("close"),d("reload")}}};return Z(()=>{k()}),(a,c)=>{const u=j("VDateInput");return D(),h(E,{title:g.title=="bonus"?"Add Bonus":"Additional Fee"},{default:s(()=>[e(B,null,{default:s(()=>[e(G,{onSubmit:H(C,["prevent"]),ref_key:"formData",ref:V},{default:s(()=>[e(O,null,{default:s(()=>[e(T,{cols:"12"},{default:s(()=>[e(ee,{modelValue:t(p).timesheet_id,"onUpdate:modelValue":c[0]||(c[0]=r=>t(p).timesheet_id=r),label:"Timesheet - Package",placeholder:"Timesheet - Package",items:t(m),"item-title":r=>r.package_type+" - "+r.package_name+" | "+r.clients,"item-value":"id",rules:t(S).required,loading:t(i),disabled:t(i)},null,8,["modelValue","items","item-title","rules","loading","disabled"])]),_:1}),e(T,{cols:"12"},{default:s(()=>[e(u,{modelValue:t(p).date,"onUpdate:modelValue":c[1]||(c[1]=r=>t(p).date=r),"prepend-icon":"",label:"Date",placeholder:"Date",rules:t(S).required},null,8,["modelValue","rules"]),e(N,{modelValue:t(p).fee,"onUpdate:modelValue":c[2]||(c[2]=r=>t(p).fee=r),type:"number",label:"Additional Fee",placeholder:"Additional Fee",rules:t(S).required},null,8,["modelValue","rules"])]),_:1})]),_:1}),e(J,{class:"my-3"}),e(W,null,{default:s(()=>[e($,{color:"error",onClick:c[3]||(c[3]=r=>d("close"))},{default:s(()=>[e(w,{icon:"ri-close-line",class:"me-3"}),x(" Close ")]),_:1}),e(z),e($,{color:"success",type:"submit"},{default:s(()=>[x(" Save "),e(w,{icon:"ri-save-line",class:"ms-3"})]),_:1})]),_:1})]),_:1},512)]),_:1})]),_:1},8,["title"])}}},ce={class:"d-flex gap-2"},pe={class:""},fe={class:"d-flex gap-2"},ve={class:""},_e={__name:"cutoff_add",emits:["close","reload"],setup(F,{emit:_}){const g=_,d=f(!1),V=f(),p=f(null),m=f(null),i=f({start_date:null,end_date:null,start_time:null,end_time:null}),k=async()=>{var c,u,r,l,o,b,v,I;const{valid:C}=await V.value.validate();if(C){d.value=!0;try{const y=await A.post("api/v1/payment/cut-off/create",i.value);y&&U("success",y.message,"bottom-end")}catch(y){var a=(u=(c=y==null?void 0:y.response)==null?void 0:c.data)==null?void 0:u.errors;(o=(l=(r=y==null?void 0:y.response)==null?void 0:r.data)==null?void 0:l.errors)!=null&&o.end_date&&(a=(I=(v=(b=y==null?void 0:y.response)==null?void 0:b.data)==null?void 0:v.errors)==null?void 0:I.end_date[0]),U("error",a,"bottom-end")}finally{d.value=!1,g("close"),g("reload")}}};return(C,a)=>{const c=j("VDateInput");return D(),h(E,{title:"Cut-Off Date"},{default:s(()=>[e(B,null,{default:s(()=>[e(G,{onSubmit:H(k,["prevent"]),ref_key:"formData",ref:V},{default:s(()=>[e(O,null,{default:s(()=>[e(T,{cols:"12"},{default:s(()=>[n("div",ce,[e(c,{"prepend-icon":"",modelValue:p.value,"onUpdate:modelValue":[a[0]||(a[0]=u=>p.value=u),a[1]||(a[1]=u=>i.value.start_date=t(M)(p.value).format("YYYY-MM-DD")+" "+i.value.start_time+":00")],"input-format":"yyyy-mm-dd",label:"Start Date",variant:"outlined",density:"compact",rules:t(S).required},null,8,["modelValue","rules"]),n("div",pe,[e(N,{modelValue:i.value.start_time,"onUpdate:modelValue":[a[2]||(a[2]=u=>i.value.start_time=u),a[3]||(a[3]=u=>i.value.start_date=t(M)(p.value).format("YYYY-MM-DD")+" "+i.value.start_time+":00")],type:"time",density:"compact",label:"Start Time",placeholder:"End Time",rules:t(S).required,loading:d.value,disabled:!p.value||d.value},null,8,["modelValue","rules","loading","disabled"])])]),n("div",fe,[e(c,{"prepend-icon":"",modelValue:m.value,"onUpdate:modelValue":[a[4]||(a[4]=u=>m.value=u),a[5]||(a[5]=u=>i.value.end_date=t(M)(m.value).format("YYYY-MM-DD")+" "+i.value.end_time+":00")],label:"End Date",variant:"outlined",density:"compact",rules:t(S).required},null,8,["modelValue","rules"]),n("div",ve,[e(N,{modelValue:i.value.end_time,"onUpdate:modelValue":[a[6]||(a[6]=u=>i.value.end_time=u),a[7]||(a[7]=u=>i.value.end_date=t(M)(m.value).format("YYYY-MM-DD")+" "+i.value.end_time+":00")],type:"time",density:"compact",label:"Start Time",placeholder:"End Time",rules:t(S).required,loading:d.value,disabled:!m.value||d.value},null,8,["modelValue","rules","loading","disabled"])])])]),_:1})]),_:1}),e(J,{class:"my-3"}),e(W,{class:"px-0"},{default:s(()=>[e($,{variant:"tonal",color:"error",onClick:a[8]||(a[8]=u=>g("close"))},{default:s(()=>[e(w,{icon:"ri-close-line",class:"me-3"}),x(" Close ")]),_:1}),e(z),e($,{variant:"tonal",loading:d.value,disabled:d.value,color:"success",type:"submit"},{default:s(()=>[x(" Save "),e(w,{icon:"ri-save-line",class:"ms-3"})]),_:1},8,["loading","disabled"])]),_:1})]),_:1},512)]),_:1})]),_:1})}}},Ve={__name:"cutoff_existing_add",props:{id:Array},emits:["close","reload","reset"],setup(F,{emit:_}){const g=F,d=_,V=f(),p=f({activity_id:g.id,start_date:null,end_date:null}),m=f(null),i=()=>{p.value.start_date=M(m.value[0]).format("YYYY-MM-DD"),p.value.end_date=M(m.value[m.value.length-1]).format("YYYY-MM-DD")},k=async()=>{var a,c;const{valid:C}=await V.value.validate();if(C)try{const u=await A.post("api/v1/payment/cut-off/add",p.value);u&&U("success",u.message,"bottom-end")}catch(u){if((c=(a=u==null?void 0:u.response)==null?void 0:a.data)!=null&&c.errors){const r=u.response.data.errors;let l="Validation errors:";for(const o in r)r.hasOwnProperty(o)&&(l+=`
${o}: ${r[o].join(", ")}`);U("error",l,"bottom-end")}}finally{d("reload"),d("close"),d("reset")}};return(C,a)=>{const c=j("VDateInput");return D(),h(E,{title:"Add to Cut-Off"},{default:s(()=>[e(B,null,{default:s(()=>[e(G,{onSubmit:H(k,["prevent"]),ref_key:"formData",ref:V},{default:s(()=>[e(O,null,{default:s(()=>[e(T,{cols:"12"},{default:s(()=>[e(c,{modelValue:t(m),"onUpdate:modelValue":[a[0]||(a[0]=u=>P(m)?m.value=u:null),i],label:"Start - End Date",rules:t(S).required,multiple:"range"},null,8,["modelValue","rules"])]),_:1})]),_:1}),e(J,{class:"my-3"}),e(W,null,{default:s(()=>[e($,{color:"error",onClick:a[1]||(a[1]=u=>d("close"))},{default:s(()=>[e(w,{icon:"ri-close-line",class:"me-3"}),x(" Close ")]),_:1}),e(z),e($,{color:"success",type:"submit"},{default:s(()=>[x(" Save "),e(w,{icon:"ri-save-line",class:"ms-3"})]),_:1})]),_:1})]),_:1},512)]),_:1})]),_:1})}}},ye=n("div",{class:"d-flex justify-between align-center"},[n("div",{class:"w-100"},[n("h4",null,"Finished Activities")])],-1),ge=n("thead",null,[n("tr",null,[n("th",{class:"text-uppercase",width:"1%"}," # "),n("th",{class:"text-uppercase",width:"1%"}," No "),n("th",{class:"text-uppercase text-center"},"Timesheet"),n("th",{class:"text-uppercase text-center"},"Activity"),n("th",{class:"text-uppercase text-center"},"Students Name"),n("th",{class:"text-uppercase text-center"},"Mentor/Tutor"),n("th",{class:"text-uppercase text-center"},"Date & Time"),n("th",{class:"text-uppercase text-center"},"Time Spent"),n("th",{class:"text-uppercase text-center"},"Fee/Hours"),n("th",{class:"text-uppercase text-center"},"Total"),n("th",{class:"text-uppercase text-center"},"Cut-Offf Status")])],-1),be={class:"text-center"},xe={key:0},ke=n("tr",null,[n("td",{colspan:"10",class:"text-center"}," Sorry, no data found. ")],-1),De=[ke],we={class:"d-flex justify-center mt-5"},je={__name:"pre",setup(F){const _=f(!1),g=f([]),d=f({cut_off:!1,additional_fee:!1,add_bonus:!1,add_existing:!1}),V=f(1),p=f(),m=f([]),i=f(null),k=f(null),C=f([]),a=async()=>{_.value=!0;const r="?page="+V.value,l=i.value?"&keyword="+i.value:"",o=k.value?"&package_id="+k.value:"";try{const b=await A.get("api/v1/payment/unpaid"+r+l+o);b&&(V.value=b.current_page,p.value=b.last_page,g.value=b)}catch(b){console.error(b)}finally{_.value=!1}},c=ne(async()=>{await a()},500),u=async()=>{_.value=!0;try{const r=await A.get("api/v1/package/component/list");r&&(C.value=r,_.value=!1)}catch(r){_.value=!1,console.error(r)}};return Z(()=>{a(),u()}),(r,l)=>(D(),q(K,null,[e(E,null,{default:s(()=>[e(se,null,{default:s(()=>[ye]),_:1}),e(B,null,{default:s(()=>[e(O,{class:"my-1"},{default:s(()=>[e(T,{cols:"3",md:"4"},{default:s(()=>[e(ee,{loading:t(_),disabled:t(_),clearable:"true",label:"Package Name",items:t(C),"item-title":o=>o.type_of+" - "+o.package,"item-value":"id",modelValue:t(k),"onUpdate:modelValue":[l[0]||(l[0]=o=>P(k)?k.value=o:null),a],placeholder:"Select Timesheet Package",density:"compact"},null,8,["loading","disabled","items","item-title","modelValue"])]),_:1}),e(T,{cols:"3",md:"3"},{default:s(()=>[e(N,{loading:t(_),disabled:t(_),"prepend-inner-icon":"ri-search-line",density:"compact",label:"Search","hide-details":"","single-line":"",modelValue:t(i),"onUpdate:modelValue":l[1]||(l[1]=o=>P(i)?i.value=o:null),onInput:t(c)},null,8,["loading","disabled","modelValue","onInput"])]),_:1}),e(T,{cols:"6",md:"5",class:"text-end"},{default:s(()=>[t(m).length>0?(D(),h($,{key:0,color:"warning",class:"me-1",onClick:l[2]||(l[2]=o=>t(d).add_existing=!0)},{default:s(()=>[e(w,{icon:"ri-add-box-line",class:"me-2"}),x(" Add to Existing Cut-Off ")]),_:1})):L("",!0),e(te,{"close-on-content-click":!1,location:"bottom"},{activator:s(({props:o})=>[e($,le({color:"light-primary"},o,{class:"me-1"}),{default:s(()=>[x(" Additional Fee "),e(w,{icon:"ri-arrow-down-s-line",class:"ms-2"})]),_:2},1040)]),default:s(()=>[e(de,null,{default:s(()=>[e(Q,null,{default:s(()=>[n("div",{class:"cursor-pointer",onClick:l[3]||(l[3]=o=>t(d).additional_fee=!0)},[e(w,{icon:"ri-wallet-2-line",class:"me-2"}),x(" Additional Fee ")])]),_:1}),e(Q,null,{default:s(()=>[n("div",{class:"cursor-pointer",onClick:l[4]||(l[4]=o=>t(d).add_bonus=!0)},[e(w,{icon:"ri-wallet-3-line",class:"me-2"}),x(" Add Bonus ")])]),_:1})]),_:1})]),_:1}),t(m).length==0?(D(),h($,{key:1,color:"secondary",onClick:l[5]||(l[5]=o=>t(d).cut_off=!0)},{default:s(()=>[e(w,{icon:"ri-scissors-cut-line",class:"me-2"}),x(" Cut-Off ")]),_:1})):L("",!0)]),_:1})]),_:1}),t(_)?(D(),h(re,{key:0,class:"mx-auto border",type:"table-thead, table-row@10"})):(D(),h(ue,{key:1,class:"text-no-wrap"},{default:s(()=>{var o,b;return[ge,n("tbody",null,[(D(!0),q(K,null,ae(t(g).data,(v,I)=>(D(),q("tr",{key:I},[n("td",null,[e(me,{modelValue:t(m),"onUpdate:modelValue":l[6]||(l[6]=y=>P(m)?m.value=y:null),value:v.id},null,8,["modelValue","value"])]),n("td",null,Y(parseInt(I)+1),1),n("td",null,Y(v.package.type+" - "+v.package.name),1),n("td",null,Y(v.activity),1),n("td",null,Y(v.students),1),n("td",null,Y(v.mentor_tutor),1),n("td",null,Y(v.date),1),n("td",null,Y((v.time_spent/60).toFixed(2)+" Hours"),1),n("td",null,"Rp. "+Y(v.fee_hours),1),n("td",null," Rp. "+Y((v.time_spent/60).toFixed(2)*v.fee_hours),1),n("td",be,[e(oe,{color:v.cutoff_status=="not yet"?"#ff0217":"#91c45e"},{default:s(()=>[x(Y(v.cutoff_status.charAt(0).toUpperCase()+v.cutoff_status.slice(1).toLowerCase()),1)]),_:2},1032,["color"])])]))),128))]),((b=(o=t(g))==null?void 0:o.data)==null?void 0:b.length)==0?(D(),q("tfoot",xe,De)):L("",!0)]}),_:1})),n("div",we,[e(ie,{modelValue:t(V),"onUpdate:modelValue":[l[7]||(l[7]=o=>P(V)?V.value=o:null),a],length:t(p),"total-visible":4,color:"primary",density:"compact","show-first-last-page":!1},null,8,["modelValue","length"])])]),_:1}),e(R,{modelValue:t(d).cut_off,"onUpdate:modelValue":l[9]||(l[9]=o=>t(d).cut_off=o),"max-width":"450",persistent:""},{default:s(()=>[e(_e,{onClose:l[8]||(l[8]=o=>t(d).cut_off=!1),onReload:a})]),_:1},8,["modelValue"]),e(R,{modelValue:t(d).add_existing,"onUpdate:modelValue":l[12]||(l[12]=o=>t(d).add_existing=o),"max-width":"450",persistent:"",scrollable:""},{default:s(()=>[e(Ve,{id:t(m),onClose:l[10]||(l[10]=o=>t(d).add_existing=!1),onReload:a,onReset:l[11]||(l[11]=o=>m.value=[])},null,8,["id"])]),_:1},8,["modelValue"])]),_:1}),e(R,{modelValue:t(d).add_bonus,"onUpdate:modelValue":l[14]||(l[14]=o=>t(d).add_bonus=o),"max-width":"450",persistent:""},{default:s(()=>[e(X,{title:"bonus",onClose:l[13]||(l[13]=o=>t(d).add_bonus=!1),onReload:a})]),_:1},8,["modelValue"]),e(R,{modelValue:t(d).additional_fee,"onUpdate:modelValue":l[16]||(l[16]=o=>t(d).additional_fee=o),"max-width":"450",persistent:""},{default:s(()=>[e(X,{title:"fee",onClose:l[15]||(l[15]=o=>t(d).additional_fee=!1),onReload:a})]),_:1},8,["modelValue"])],64))}};export{je as default};
