import{r as v,y as I,e as m,p as S,w as a,b as l,j as te,V as L,h as t,D as O,k as Y,l as y,i as D,z as le,A as P,s as N,a5 as G,U as se,o as W,f as e,E as j,a as C,q as F,a0 as X,F as Z,t as u,G as ae,a1 as oe,d as ee,a9 as K}from"./main-D8kh9FUH.js";import{_ as ie}from"./DeleteHandler.vue_vue_type_script_setup_true_lang-Zk9oQYOa.js";import{d as ne}from"./debounce-DEHhXTtI.js";import{r as q}from"./rules-CkvmYWH-.js";import{c as M,d as de,V as A,b as z,a as R}from"./VCard-C2gxe2Ll.js";import{V as re}from"./VForm-D7sQDwXz.js";import{V as H,a as $}from"./VRow-DPddWYrh.js";import{V as ce}from"./VTextarea-zwtttejN.js";import{V as Q}from"./VDialog-BWox5jRN.js";import{a as J,V as B}from"./VTable-BA_RiPSC.js";import{T as E}from"./index-CrgySRvo.js";import{V as ue}from"./VCheckbox-BdEbiUVe.js";import"./VAvatar-B-p5cL0r.js";import"./VImg-CBrU41Vd.js";import"./VTooltip-D-0d5H-x.js";import"./VCheckboxBtn-CIPJgYyL.js";import"./VSelectionControl-Cz6x8c9m.js";const _e={__name:"activity-add",props:{id:String},emits:["close","reload"],setup(U,{emit:f}){const b=U,h=f,c=v(!1),x=v(),s=v({activity:null,description:null,date:null,start_time:null,end_time:null,start_date:null,end_date:null,meeting_link:null}),w=async()=>{var d,k;const{valid:g}=await x.value.validate();if(g){c.value=!0;try{const p=await P.post("api/v1/timesheet/"+b.id+"/activity",s.value);p&&N("success",p.message,"bottom-end")}catch(p){if((k=(d=p==null?void 0:p.response)==null?void 0:d.data)!=null&&k.errors){const o=p.response.data.errors;let _="Validation errors:";for(const i in o)o.hasOwnProperty(i)&&(_+=`
${i}: ${o[i].join(", ")}`);N("error",_,"bottom-end")}else N("error",p.response.data.message,"bottom-end")}finally{c.value=!1,h("reload"),h("close")}}};return(g,d)=>{const k=I("DialogCloseBtn"),p=I("VDateInput");return m(),S(A,{title:"New Activity"},{default:a(()=>[l(k,{variant:"text",size:"default",onClick:d[0]||(d[0]=o=>h("close"))}),l(M,null,{default:a(()=>[l(re,{onSubmit:te(w,["prevent"]),ref_key:"formData",ref:x,"validate-on":"input"},{default:a(()=>[l(H,null,{default:a(()=>[l($,{cols:"12",class:"d-none"},{default:a(()=>[l(L,{modelValue:t(s).activity,"onUpdate:modelValue":d[1]||(d[1]=o=>t(s).activity=o),label:"Activity Name",placeholder:"Activity",loading:t(c),disabled:t(c),density:"compact"},null,8,["modelValue","loading","disabled"])]),_:1}),l($,{cols:"12"},{default:a(()=>[l(ce,{modelValue:t(s).description,"onUpdate:modelValue":d[2]||(d[2]=o=>t(s).description=o),label:"Meeting Discussion",placeholder:"Meeting Discussion",loading:t(c),disabled:t(c),rules:t(q).required,density:"compact"},null,8,["modelValue","loading","disabled","rules"])]),_:1}),l($,{md:"6",cols:"12"},{default:a(()=>[l(p,{modelValue:t(s).date,"onUpdate:modelValue":d[3]||(d[3]=o=>t(s).date=o),label:"Date",placeholder:"Select Date","prepend-icon":"",loading:t(c),disabled:t(c),rules:t(q).required,variant:"outlined",density:"compact"},null,8,["modelValue","loading","disabled","rules"])]),_:1}),l($,{md:"3",cols:"6"},{default:a(()=>[l(L,{type:"time",modelValue:t(s).start_time,"onUpdate:modelValue":d[4]||(d[4]=o=>t(s).start_time=o),label:"Start Time",placeholder:"Start Time",rules:t(q).required,class:"mb-3",loading:t(c),disabled:t(c),density:"compact",onChange:d[5]||(d[5]=o=>t(s).start_date=t(O)(t(s).date).format("YYYY-MM-DD")+" "+t(s).start_time+":00")},null,8,["modelValue","rules","loading","disabled"])]),_:1}),l($,{md:"3",cols:"6"},{default:a(()=>[l(L,{type:"time",modelValue:t(s).end_time,"onUpdate:modelValue":d[6]||(d[6]=o=>t(s).end_time=o),label:"End Time",placeholder:"End Time",loading:t(c),disabled:t(c),density:"compact",onChange:d[7]||(d[7]=o=>t(s).end_date=t(O)(t(s).date).format("YYYY-MM-DD")+" "+t(s).end_time+":00")},null,8,["modelValue","loading","disabled"])]),_:1}),l($,{md:"12",cols:"12"},{default:a(()=>[l(L,{type:"text",modelValue:t(s).meeting_link,"onUpdate:modelValue":d[8]||(d[8]=o=>t(s).meeting_link=o),label:"Meeting Link",placeholder:"Meeting Link",density:"compact",loading:t(c),disabled:t(c),rules:t(q).url},null,8,["modelValue","loading","disabled","rules"])]),_:1})]),_:1}),l(de,{class:"mt-5"},{default:a(()=>[l(Y,{type:"button",color:"error",loading:t(c),disabled:t(c),onClick:d[9]||(d[9]=o=>h("close"))},{default:a(()=>[l(y,{icon:"ri-close-line",class:"me-3"}),D(" Close ")]),_:1},8,["loading","disabled"]),l(le),l(Y,{loading:t(c),disabled:t(c),type:"submit",color:"success"},{default:a(()=>[D(" Save "),l(y,{icon:"ri-save-line",class:"ms-3"})]),_:1},8,["loading","disabled"])]),_:1})]),_:1},512)]),_:1})]),_:1})}}},me={class:"d-flex justify-between align-center"},pe=e("div",{class:"w-100"},[e("h4",null,"Activity")],-1),fe=e("th",{class:"text-uppercase",width:"1%"}," No ",-1),he=e("th",{class:"text-uppercase text-center"},"Meeting Discussion",-1),ge=e("th",{class:"text-uppercase text-center"},"Date",-1),ye=e("th",{class:"text-uppercase text-center"},"Start Time",-1),ve=e("th",{class:"text-uppercase text-center",style:{width:"200px !important"}}," End Time ",-1),be=e("th",{class:"text-uppercase text-center"},"Time Spent",-1),xe=e("th",{class:"text-uppercase text-center"},"Status",-1),we={key:0,class:"text-uppercase text-end"},Ve={width:"1%"},ke={class:"text-start"},De={class:"text-center"},$e={class:"text-start"},Ce=["onUpdate:modelValue","onChange","disabled"],Te={class:"text-center"},Me={key:0,class:"text-end"},Se=["href"],Ne={__name:"timesheet-detail",props:{id:String,require:String},setup(U){const f=U,b=G("updateReload"),h=v([]),c=v(!1),x=v(se.getUser().role_detail[0].role.toLowerCase()),s=v([{add:!1,delete:!1}]),w=v([]),g=async()=>{c.value=!0;try{const i=await P.get("api/v1/timesheet/"+f.id+"/activities");i&&(h.value=i)}catch(i){console.error(i)}finally{c.value=!1}},d=i=>{s.value[i]?s.value[i]=!1:s.value[i]=!0},k=(i,r)=>{w.value=r,d(i)},p=async()=>{var i,r,n;c.value=!0;try{const V=await P.delete("api/v1/timesheet/"+f.id+"/activity/"+w.value.id);V&&(N("success",V.message,"bottom-end"),d("delete"))}catch(V){((i=V.response)==null?void 0:i.status)==400&&N("error",(n=(r=V.response)==null?void 0:r.data)==null?void 0:n.errors,"bottom-end")}finally{c.value=!1,g(),b(!0)}},o=ne(async i=>{i.end_date=i.date+" "+i.end_time+":00";try{const r=await P.put("api/v1/timesheet/"+f.id+"/activity/"+i.id,i);r&&N("success",r.message,"bottom-end")}catch(r){console.error(r)}finally{g(),b(!0)}},500),_=async i=>{try{const r=await P.put("api/v1/timesheet/"+f.id+"/activity/"+i.id,i);r&&N("success",r.message,"bottom-end")}catch(r){console.error(r)}finally{g(),b(!0)}};return W(()=>{g()}),(i,r)=>(m(),S(A,null,{default:a(()=>[l(z,null,{default:a(()=>[e("div",me,[pe,j((m(),S(Y,{onClick:r[0]||(r[0]=n=>d("add"))},{default:a(()=>[l(y,{icon:"ri-add-line"})]),_:1})),[[E,"New Activity","start"]]),l(Q,{modelValue:t(s).add,"onUpdate:modelValue":r[2]||(r[2]=n=>t(s).add=n),"max-width":"600",persistent:""},{default:a(()=>[l(_e,{id:f.id,onClose:r[1]||(r[1]=n=>d("add")),onReload:g},null,8,["id"])]),_:1},8,["modelValue"])])]),_:1}),l(M,null,{default:a(()=>[t(c)?(m(),S(B,{key:1,type:"table"})):(m(),S(J,{key:0,class:"text-no-wrap",height:"400","fixed-header":""},{default:a(()=>[e("thead",null,[e("tr",null,[fe,he,ge,ye,ve,be,xe,t(x)!="mentor"?(m(),C("th",we," # ")):F("",!0)])]),e("tbody",null,[(m(!0),C(Z,null,X(t(h),(n,V)=>(m(),C("tr",{key:V},[e("td",Ve,u(V+1),1),e("td",ke,u(n.description),1),e("td",null,u(i.$moment(n.start_date).format("dddd"))+", "+u(i.$moment(n.start_date).format("MMM Do YYYY")),1),e("td",De,u(n.start_time),1),e("td",$e,[j(e("input",{type:"time",class:"form-control px-2 py-2 border rounded cursor-pointer","onUpdate:modelValue":T=>n.end_time=T,onChange:T=>t(o)(n),disabled:t(x)=="mentor"||n.start_time=="00:00"||n.cutoff_status=="completed"},null,40,Ce),[[ae,n.end_time],[E,n.cutoff_status=="completed"?"Already Cut-Off":"End Time","start"]])]),e("td",Te,u(n.estimate)+" Minutes",1),e("td",null,[j(l(ue,{color:"success",modelValue:n.status,"onUpdate:modelValue":[T=>n.status=T,T=>_(n)],value:!0,disabled:t(x)=="mentor"||n.start_time=="00:00"||n.cutoff_status=="completed"},null,8,["modelValue","onUpdate:modelValue","disabled"]),[[E,n.status?"Completed":"Not Yet","start"]])]),t(x)!="mentor"?(m(),C("td",Me,[l(Y,{color:"primary",density:"compact",class:"me-1"},{default:a(()=>[e("a",{href:n.meeting_link,target:"_blank",class:"bg-primary"},[l(y,{icon:"ri ri-link"}),D(" Join ")],8,Se)]),_:2},1024),j((m(),S(Y,{color:"error",density:"compact",disabled:n.start_time=="00:00"||n.cutoff_status=="completed",onClick:T=>k("delete",n)},{default:a(()=>[l(y,{icon:"ri-delete-bin-line",class:"cursor-pointer"})]),_:2},1032,["disabled","onClick"])),[[E,n.status?"Already Cut-Off":"Delete Activity","start"]])])):F("",!0)]))),128))])]),_:1}))]),_:1}),l(Q,{modelValue:t(s).delete,"onUpdate:modelValue":r[4]||(r[4]=n=>t(s).delete=n),"max-width":"400",persistent:""},{default:a(()=>[l(ie,{loading:t(c),title:"activity",onClose:r[3]||(r[3]=n=>d("delete")),onDelete:p},null,8,["loading"])]),_:1},8,["modelValue"])]),_:1}))}},Ue={class:"w-100"},Pe={class:"mt-3 font-weight-light"},Ae=e("hr",{class:"my-2"},null,-1),Ye={key:0},ze=e("tr",{class:"bg-secondary"},[e("td",null,"Name"),e("td",null,"School"),e("td",null,"Grade")],-1),Be={key:1},Le=e("td",{width:"20%"},"Name",-1),je=e("td",{width:"1%"},":",-1),qe=e("td",null,"School Name",-1),Ee=e("td",{width:"1%"},":",-1),Fe=e("td",null,"Grade",-1),Re=e("td",{width:"1%"},":",-1),Ie=e("td",null,"Email",-1),Oe=e("td",{width:"1%"},":",-1),Ge={class:"mt-5 font-weight-light"},He=e("hr",{class:"my-2"},null,-1),Je=e("td",{width:"20%"},"Program",-1),Ke=e("td",{width:"1%"},":",-1),Qe=e("td",null,"Package",-1),We=e("td",{width:"1%"},":",-1),Xe=e("td",null,"Person in Charge",-1),Ze=e("td",{width:"1%"},":",-1),et=e("td",null,"Tutor/Mentor",-1),tt=e("td",{width:"1%"},":",-1),lt=e("td",null,"Notes",-1),st=e("td",{width:"1%"},":",-1),at=e("td",null,"Update On",-1),ot=e("td",{width:"1%"},":",-1),it={class:"d-flex align-end w-100"},nt={class:"m-0 mb-1 text-white"},dt=e("h4",{class:"m-0 ms-2 text-white"},"Minutes",-1),rt={class:"text-end w-100"},ct={class:"d-flex align-end w-100"},ut={class:"m-0 mb-1 text-white"},_t=e("h4",{class:"m-0 ms-2 text-white"},"Minutes",-1),mt={class:"text-end w-100"},pt={class:"d-flex align-end w-100"},ft={class:"m-0 mb-1 text-white"},ht=e("h4",{class:"m-0 ms-2 text-white"},"Minutes",-1),gt={class:"text-end w-100"},yt={__name:"user-detail",props:{id:String},emits:["void"],setup(U,{emit:f}){const b=U,h=f,c=G("reloadData"),x=G("updateReload"),s=v([]),w=v(!1),g=async d=>{var k,p,o;w.value=!0;try{const _=await P.get("api/v1/timesheet/"+d+"/detail");_&&(s.value=_,h("void",_.packageDetails.void))}catch(_){((k=_.response)==null?void 0:k.status)==400&&(N("error",(o=(p=_.response)==null?void 0:p.data)==null?void 0:o.errors,"bottom-end"),ee.push("/admin/timesheet")),console.log(_)}finally{w.value=!1}};return W(()=>{g(b.id)}),oe(()=>{c.value&&(g(b.id),x(!1))}),(d,k)=>{const p=I("router-link");return m(),S(A,{class:"mb-3"},{default:a(()=>[l(z,{class:"d-flex justify-between align-center"},{default:a(()=>{var o,_,i,r,n;return[e("div",Ue,[l(p,{to:"/user/timesheet"},{default:a(()=>[l(y,{icon:"ri-arrow-left-line",color:"secondary",class:"me-2",size:"25"})]),_:1}),D(" "+u((o=t(s).packageDetails)==null?void 0:o.tutormentor_name)+" | "+u(((i=(_=t(s))==null?void 0:_.packageDetails)==null?void 0:i.package_type)+" - "+((n=(r=t(s))==null?void 0:r.packageDetails)==null?void 0:n.package_name)),1)])]}),_:1}),l(M,null,{default:a(()=>[t(w)?(m(),S(H,{key:1},{default:a(()=>[l($,{md:"7"},{default:a(()=>[l(B,{type:"heading, paragraph, heading, paragraph",class:"mb-3"})]),_:1}),l($,{md:"5"},{default:a(()=>[l(B,{type:"text@3",color:"#16B1FF",class:"mb-3"}),l(B,{type:"text@3",color:"#91c45e",class:"mb-3"}),l(B,{type:"text@3",color:"#e05e5e",class:"mb-3"})]),_:1})]),_:1})):(m(),S(H,{key:0,align:"center"},{default:a(()=>[l($,{md:"7"},{default:a(()=>[e("h4",Pe,[l(y,{icon:"ri-user-line",size:"17",class:"me-2"}),D(" Basic Profile ")]),Ae,l(J,{density:"compact"},{default:a(()=>{var o,_;return[((o=t(s).clientProfile)==null?void 0:o.length)>1?(m(),C("tbody",Ye,[ze,(m(!0),C(Z,null,X(t(s).clientProfile,i=>(m(),C("tr",null,[e("td",null,u(i.client_name),1),e("td",null,u(i.client_school),1),e("td",null,u(i.client_grade<=12?i.client_grade:"Not High School"),1)]))),256))])):((_=t(s).clientProfile)==null?void 0:_.length)==1?(m(),C("tbody",Be,[e("tr",null,[Le,je,e("td",null,u(t(s).clientProfile[0].client_name),1)]),e("tr",null,[qe,Ee,e("td",null,u(t(s).clientProfile[0].client_school),1)]),e("tr",null,[Fe,Re,e("td",null,u(t(s).clientProfile[0].client_grade<=12?t(s).clientProfile[0].client_grade:"Not High School"),1)]),e("tr",null,[Ie,Oe,e("td",null,u(t(s).clientProfile[0].client_mail),1)])])):F("",!0)]}),_:1}),e("h4",Ge,[l(y,{icon:"ri-bookmark-line",class:"me-2",size:"17"}),D(" Package Details ")]),He,l(J,{density:"compact"},{default:a(()=>{var o,_,i,r,n,V,T;return[e("tbody",null,[e("tr",null,[Je,Ke,e("td",null,u((o=t(s).packageDetails)!=null&&o.free_trial?"[TRIAL]":"")+" "+u((_=t(s).packageDetails)==null?void 0:_.program_name),1)]),e("tr",null,[Qe,We,e("td",null,u(((i=t(s).packageDetails)==null?void 0:i.package_type)+" - "+((r=t(s).packageDetails)==null?void 0:r.package_name)),1)]),e("tr",null,[Xe,Ze,e("td",null,u((n=t(s).packageDetails)==null?void 0:n.pic_name),1)]),e("tr",null,[et,tt,e("td",null,u((V=t(s).packageDetails)==null?void 0:V.tutormentor_name),1)]),e("tr",null,[lt,st,e("td",null,u((T=t(s).editableColumns)==null?void 0:T.notes),1)]),e("tr",null,[at,ot,e("td",null,u(t(O)().format("LLL")),1)])])]}),_:1})]),_:1}),l($,{md:"5"},{default:a(()=>[l(A,{color:"#16B1FF",class:"mb-2 d-flex align-center"},{default:a(()=>[e("div",null,[l(R,null,{default:a(()=>[l(z,{class:"text-white"},{default:a(()=>[D(" Total Minutes of Package ")]),_:1})]),_:1}),l(M,{class:"d-flex justify-between"},{default:a(()=>{var o;return[e("div",it,[e("h1",nt,u((o=t(s).packageDetails)==null?void 0:o.duration_in_minutes),1),dt])]}),_:1})]),l(M,null,{default:a(()=>[e("div",rt,[l(y,{icon:"ri-calendar-schedule-line",size:"60"})])]),_:1})]),_:1}),l(A,{color:"#91c45e",class:"mb-2 d-flex align-center"},{default:a(()=>[e("div",null,[l(R,null,{default:a(()=>[l(z,{class:"text-white"},{default:a(()=>[D(" Total Minutes Spent ")]),_:1})]),_:1}),l(M,{class:"d-flex justify-between"},{default:a(()=>{var o;return[e("div",ct,[e("h1",ut,u((o=t(s).packageDetails)==null?void 0:o.time_spent_in_minutes),1),_t])]}),_:1})]),l(M,null,{default:a(()=>[e("div",mt,[l(y,{icon:"ri-timer-flash-line",size:"60",color:"white"})])]),_:1})]),_:1}),l(A,{color:"#e05e5e",class:"mb-2 d-flex align-center"},{default:a(()=>[e("div",null,[l(R,null,{default:a(()=>[l(z,{class:"text-white"},{default:a(()=>[D(" Total Minutes Left ")]),_:1})]),_:1}),l(M,{class:"d-flex justify-between"},{default:a(()=>{var o,_;return[e("div",pt,[e("h1",ft,u(((o=t(s).packageDetails)==null?void 0:o.duration_in_minutes)-((_=t(s).packageDetails)==null?void 0:_.time_spent_in_minutes)),1),ht])]}),_:1})]),l(M,null,{default:a(()=>[e("div",gt,[l(y,{icon:"ri-timer-2-line",size:"60"})])]),_:1})]),_:1})]),_:1})]),_:1}))]),_:1})]),_:1})}}},vt={class:"h-auto position-relative"},bt={key:0,class:"overlay"},xt=e("div",{class:"bg-secondary",style:{height:"100%",position:"absolute",left:"0",top:"0","z-index":"9998",width:"100%",opacity:"0.6"}},null,-1),wt={class:"d-flex align-center justify-center",style:{height:"100%",position:"absolute",left:"0",top:"0","z-index":"9999",width:"100%",opacity:"1"}},Vt={class:"text-center"},kt=e("h2",{class:"text-white mt-3"},"This Timesheet Has Changed Owner",-1),Ft={__name:"timesheet-detail",props:{id:Number,require:String},setup(U){const f=U,b=f.id,h=v(!1),c=v(!1);K("reloadData",h),K("updateReload",s=>{h.value=s});const x=s=>{c.value=s};return(s,w)=>(m(),C("div",vt,[t(c)=="true"?(m(),C("div",bt,[xt,e("div",wt,[e("div",Vt,[l(y,{color:"white",icon:"ri-lock-line",size:"50"}),kt,l(Y,{color:"light",class:"mt-4",onClick:w[0]||(w[0]=g=>t(ee).push({path:"/user/timesheet"}))},{default:a(()=>[D(" Back to List ")]),_:1})])])])):F("",!0),l(yt,{id:t(b),onVoid:x},null,8,["id"]),l(Ne,{id:t(b),require:f.require},null,8,["id","require"])]))}};export{Ft as default};
