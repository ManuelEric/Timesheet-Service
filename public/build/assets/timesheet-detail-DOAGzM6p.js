import{_ as ye}from"./DeleteHandler.vue_vue_type_script_setup_true_lang-D7UwbEUu.js";import{r as b,l as K,o as y,f as U,w as a,b as t,am as oe,W as F,u as e,v as z,Y as L,V as w,j as C,m as ne,A as P,s as Y,ao as ie,e as de,a as l,x as Z,c as E,F as be,X as he,t as v,h as re,z as Ve,ap as ke,k as le,an as we,P as xe,i as De,aq as $e,ar as Ce,as as ge}from"./main-wqbXnlwX.js";import{r as R}from"./rules-B5G8qOzK.js";import{a as B,c as ue,V as O,b as W,d as se,e as Te}from"./VCard-D2x-rsu7.js";import{V as ce}from"./VForm-DNqEIkl6.js";import{V as Q,a as T}from"./VRow-CaovE9tP.js";import{V as pe}from"./VTextarea-BkrJpFiJ.js";import{V as X}from"./VDialog-Dv2r5ud1.js";import{a as fe,V as J}from"./VTable-YSHjI8dl.js";import{T as ee}from"./index-BLmnYSMQ.js";import{V as Me}from"./VCheckbox-DM0gQV2e.js";import{V as te}from"./VAutocomplete-DFOWS4Xi.js";import{V as Se}from"./VDivider-CLGQpo9M.js";import{V as Ye,a as ae,b as Ue}from"./VList-DDF9bkb-.js";import"./VAvatar-0Xbu4_hq.js";import"./VImg-CKrPMbH4.js";import"./VTooltip-wzb94TmU.js";import"./VCheckboxBtn-DnTcfVft.js";import"./VSelectionControl-CJcRzlKD.js";import"./VSlideGroup-BONNnrOW.js";import"./ssrBoot-DGk78_wM.js";const je={__name:"activity-add",props:{id:String},emits:["close","reload"],setup(N,{emit:M}){const _=N,V=M,s=b(!1),h=b(),o=b({activity:null,description:null,date:null,start_time:null,end_time:null,start_date:null,end_date:null,meeting_link:null}),f=()=>{o.value={activity:null,description:null,date:null,start_time:null,end_time:null,start_date:null,end_date:null,meeting_link:null}},D=async()=>{const{valid:k}=await h.value.validate();if(k){s.value=!0;try{const n=await P.post("api/v1/timesheet/"+_.id+"/activity",o.value);n&&Y("success",n.message,"bottom-end")}catch(n){Y("error",n.response.data.errors,"bottom-end")}finally{f(),s.value=!1,V("reload"),V("close")}}};return(k,n)=>{const S=K("DialogCloseBtn"),m=K("VDateInput");return y(),U(O,{title:"New Activity"},{default:a(()=>[t(S,{variant:"text",size:"default",onClick:n[0]||(n[0]=i=>V("close"))}),t(B,null,{default:a(()=>[t(ce,{onSubmit:oe(D,["prevent"]),ref_key:"formData",ref:h,"validate-on":"input"},{default:a(()=>[t(Q,null,{default:a(()=>[t(T,{cols:"12",class:"d-none"},{default:a(()=>[t(F,{modelValue:e(o).activity,"onUpdate:modelValue":n[1]||(n[1]=i=>e(o).activity=i),label:"Activity Name",placeholder:"Activity",loading:e(s),disabled:e(s),variant:"solo"},null,8,["modelValue","loading","disabled"])]),_:1}),t(T,{cols:"12"},{default:a(()=>[t(pe,{modelValue:e(o).description,"onUpdate:modelValue":n[2]||(n[2]=i=>e(o).description=i),label:"Meeting Discussion",placeholder:"Meeting Discussion",variant:"solo",loading:e(s),disabled:e(s),rules:e(R).required},null,8,["modelValue","loading","disabled","rules"])]),_:1}),t(T,{md:"6",cols:"12"},{default:a(()=>[t(m,{modelValue:e(o).date,"onUpdate:modelValue":n[3]||(n[3]=i=>e(o).date=i),label:"Date",placeholder:"Select Date","prepend-icon":"",variant:"solo",loading:e(s),disabled:e(s),rules:e(R).required},null,8,["modelValue","loading","disabled","rules"])]),_:1}),t(T,{md:"3",cols:"6"},{default:a(()=>[t(F,{type:"time",modelValue:e(o).start_time,"onUpdate:modelValue":n[4]||(n[4]=i=>e(o).start_time=i),label:"Start Time",placeholder:"Start Time",rules:e(R).required,variant:"solo",class:"mb-3",loading:e(s),disabled:e(s),onChange:n[5]||(n[5]=i=>e(o).start_date=e(z)(e(o).date).format("YYYY-MM-DD")+" "+e(o).start_time+":00")},null,8,["modelValue","rules","loading","disabled"])]),_:1}),t(T,{md:"3",cols:"6"},{default:a(()=>[t(F,{type:"time",modelValue:e(o).end_time,"onUpdate:modelValue":n[6]||(n[6]=i=>e(o).end_time=i),label:"End Time",placeholder:"End Time",variant:"solo",loading:e(s),disabled:e(s),onChange:n[7]||(n[7]=i=>e(o).end_date=e(z)(e(o).date).format("YYYY-MM-DD")+" "+e(o).end_time+":00")},null,8,["modelValue","loading","disabled"])]),_:1}),t(T,{md:"12",cols:"12"},{default:a(()=>[t(F,{type:"text",modelValue:e(o).meeting_link,"onUpdate:modelValue":n[8]||(n[8]=i=>e(o).meeting_link=i),label:"Meeting Link",placeholder:"Meeting Link",variant:"solo",loading:e(s),disabled:e(s)},null,8,["modelValue","loading","disabled"])]),_:1})]),_:1}),t(ue,{class:"mt-5"},{default:a(()=>[t(L,{type:"button",color:"error",loading:e(s),disabled:e(s),onClick:n[9]||(n[9]=i=>V("close"))},{default:a(()=>[t(w,{icon:"ri-close-line",class:"me-3"}),C(" Close ")]),_:1},8,["loading","disabled"]),t(ne),t(L,{type:"submit",color:"success",loading:e(s),disabled:e(s)},{default:a(()=>[C(" Save "),t(w,{icon:"ri-save-line",class:"ms-3"})]),_:1},8,["loading","disabled"])]),_:1})]),_:1},512)]),_:1})]),_:1})}}},Pe={__name:"activity-edit",props:{timesheet_id:Number,activity:String},emits:["close","reload"],setup(N,{emit:M}){const _=b(!1),V=b(),s=N,h=M,o=ie("updateReload"),f=b({activity:s==null?void 0:s.activity.activity,description:s==null?void 0:s.activity.description,date:new Date(s==null?void 0:s.activity.start_date),start_time:s==null?void 0:s.activity.start_time,end_time:s==null?void 0:s.activity.end_time,start_date:z(s==null?void 0:s.activity.start_date).format("YYYY-MM-DD")+" "+(s==null?void 0:s.activity.start_time)+":00",end_date:(s==null?void 0:s.activity.end_time)!=0?z(s==null?void 0:s.activity.start_date).format("YYYY-MM-DD")+" "+(s==null?void 0:s.activity.end_time)+":00":null,meeting_link:s==null?void 0:s.activity.meeting_link}),D=async()=>{var n,S;const{valid:k}=await V.value.validate();if(k){_.value=!0;try{f.value.start_date=z(f.value.date).format("YYYY-MM-DD")+" "+f.value.start_time+":00",f.value.end_date=z(f.value.date).format("YYYY-MM-DD")+" "+f.value.end_time+":00";const m=await P.put("api/v1/timesheet/"+s.timesheet_id+"/activity/"+s.activity.id,f.value);m&&(Y("success",m.message,"bottom-end"),h("reload"))}catch(m){if((S=(n=m==null?void 0:m.response)==null?void 0:n.data)!=null&&S.errors){const i=m.response.data.errors;let r="Validation errors:";if(typeof i!="string"){for(const u in i)i.hasOwnProperty(u)&&(r+=`
${u}: ${i[u].join(", ")}`);Y("error",r,"bottom-end")}else Y("error",m.response.data.errors,"bottom-end")}}finally{_.value=!1,h("close"),setTimeout(()=>{o(!0)},3e3)}}};return(k,n)=>{const S=K("DialogCloseBtn"),m=K("VDateInput");return y(),U(O,{title:"Edit Activity"},{default:a(()=>[t(S,{variant:"text",size:"default",onClick:n[0]||(n[0]=i=>h("close"))}),t(B,null,{default:a(()=>[t(ce,{onSubmit:oe(D,["prevent"]),ref_key:"formData",ref:V,"validate-on":"input"},{default:a(()=>[t(Q,null,{default:a(()=>[t(T,{cols:"12",class:"d-none"},{default:a(()=>[t(F,{modelValue:e(f).activity,"onUpdate:modelValue":n[1]||(n[1]=i=>e(f).activity=i),label:"Activity Name",placeholder:"Activity",variant:"solo",disabled:e(_),loading:e(_)},null,8,["modelValue","disabled","loading"])]),_:1}),t(T,{cols:"12"},{default:a(()=>[t(pe,{modelValue:e(f).description,"onUpdate:modelValue":n[2]||(n[2]=i=>e(f).description=i),label:"Meeting Discussion",rules:e(R).required,placeholder:"Meeting Discussion",variant:"solo",disabled:e(_),loading:e(_)},null,8,["modelValue","rules","disabled","loading"])]),_:1}),t(T,{md:"6",cols:"12"},{default:a(()=>[t(m,{modelValue:e(f).date,"onUpdate:modelValue":n[3]||(n[3]=i=>e(f).date=i),label:"Date",placeholder:"Select Date","prepend-icon":"",variant:"solo",disabled:e(_),loading:e(_),rules:e(R).required},null,8,["modelValue","disabled","loading","rules"])]),_:1}),t(T,{md:"3",cols:"6"},{default:a(()=>[t(F,{type:"time",modelValue:e(f).start_time,"onUpdate:modelValue":n[4]||(n[4]=i=>e(f).start_time=i),label:"Start Time",rules:e(R).required,placeholder:"Start Time",variant:"solo",disabled:e(_),loading:e(_),onChange:n[5]||(n[5]=i=>e(f).start_date=e(z)(s==null?void 0:s.activity.date).format("YYYY-MM-DD")+" "+e(f).start_time+":00")},null,8,["modelValue","rules","disabled","loading"])]),_:1}),t(T,{md:"3",cols:"6"},{default:a(()=>[t(F,{type:"time",modelValue:e(f).end_time,"onUpdate:modelValue":n[6]||(n[6]=i=>e(f).end_time=i),label:"End Time",placeholder:"End Time",variant:"solo",disabled:e(_),loading:e(_),onChange:n[7]||(n[7]=i=>e(f).end_date=e(z)(s==null?void 0:s.activity.date).format("YYYY-MM-DD")+" "+e(f).end_time+":00")},null,8,["modelValue","disabled","loading"])]),_:1}),t(T,{md:"12",cols:"12"},{default:a(()=>[t(F,{type:"text",modelValue:e(f).meeting_link,"onUpdate:modelValue":n[8]||(n[8]=i=>e(f).meeting_link=i),label:"Meeting Link",placeholder:"Meeting Link",variant:"solo",disabled:e(_),loading:e(_)},null,8,["modelValue","disabled","loading"])]),_:1})]),_:1}),t(ue,{class:"mt-5"},{default:a(()=>[t(L,{color:"error",disabled:e(_),loading:e(_),onClick:n[9]||(n[9]=i=>h("close"))},{default:a(()=>[t(w,{icon:"ri-close-line",class:"me-3"}),C(" Close ")]),_:1},8,["disabled","loading"]),t(ne),t(L,{color:"success",type:"submit",disabled:e(_),loading:e(_)},{default:a(()=>[C(" Save "),t(w,{icon:"ri-save-line",class:"ms-3"})]),_:1},8,["disabled","loading"])]),_:1})]),_:1},512)]),_:1})]),_:1})}}},Le={class:"d-flex justify-between align-center"},Ne=l("div",{class:"w-100"},[l("h4",null,"Activity")],-1),Ae=l("thead",null,[l("tr",null,[l("th",{class:"text-uppercase",width:"1%"}," No "),l("th",{class:"text-uppercase text-center"},"Meeting Discussion"),l("th",{class:"text-uppercase text-center"},"Date"),l("th",{class:"text-uppercase text-center"},"Start Time"),l("th",{class:"text-uppercase text-center"},"End Time"),l("th",{class:"text-uppercase text-center"},"Time Spent"),l("th",{class:"text-uppercase text-center"},"Status"),l("th",{class:"text-uppercase text-end"},"#")])],-1),qe={key:0},Be=l("tr",null,[l("th",{colspan:"8",class:"text-center"}," No Activity Found ")],-1),Ee=[Be],Re={key:1},Ie={width:"1%"},ze={class:"d-none"},Fe={class:"text-start"},Oe={class:"text-center"},He={class:"text-center"},Ge={class:"text-center"},Je={class:"text-end"},We=["href"],Xe={__name:"timesheet-detail",props:{id:String},setup(N){const M=N,_=ie("updateReload"),V=b([]),s=b(!1),h=b([{add:!1,edit:!1,delete:!1}]),o=b([]),f=async()=>{s.value=!0;try{const m=await P.get("api/v1/timesheet/"+M.id+"/activities");m&&(V.value=m)}catch(m){console.error(m)}finally{s.value=!1}},D=m=>{h.value[m]?h.value[m]=!1:h.value[m]=!0},k=(m,i)=>{o.value=i,D(m)},n=async()=>{var m,i,r;try{const u=await P.delete("api/v1/timesheet/"+M.id+"/activity/"+o.value.id);u&&(Y("success",u.message,"bottom-end"),D("delete"))}catch(u){((m=u.response)==null?void 0:m.status)==400&&Y("error",(r=(i=u.response)==null?void 0:i.data)==null?void 0:r.errors,"bottom-end")}finally{f(),_(!0)}},S=async m=>{var i,r,u,d;try{const c=await P.patch("api/v1/timesheet/"+M.id+"/activity/"+m.id,m);c&&Y("success",c.message,"bottom-end")}catch(c){if((r=(i=c==null?void 0:c.response)==null?void 0:i.data)!=null&&r.message)Y("error",c.response.data.message,"bottom-end");else if((d=(u=c==null?void 0:c.response)==null?void 0:u.data)!=null&&d.errors){const p=c.response.data.errors;let A="Validation errors:";if(typeof p!="string"){for(const q in p)p.hasOwnProperty(q)&&(A+=`
${q}: ${p[q].join(", ")}`);Y("error",A,"bottom-end")}else Y("error",c.response.data.errors,"bottom-end")}}finally{f(),_(!0)}};return de(()=>{f()}),(m,i)=>(y(),U(O,null,{default:a(()=>[t(W,null,{default:a(()=>[l("div",Le,[Ne,Z((y(),U(L,{onClick:i[0]||(i[0]=r=>D("add"))},{default:a(()=>[t(w,{icon:"ri-add-line"})]),_:1})),[[ee,"New Activity","start"]]),t(X,{modelValue:e(h).add,"onUpdate:modelValue":i[2]||(i[2]=r=>e(h).add=r),"max-width":"600",persistent:""},{default:a(()=>[t(je,{id:M.id,onClose:i[1]||(i[1]=r=>D("add")),onReload:f},null,8,["id"])]),_:1},8,["modelValue"])])]),_:1}),t(B,null,{default:a(()=>[e(s)?(y(),U(J,{key:1,type:"table"})):(y(),U(fe,{key:0,class:"text-no-wrap",height:"400","fixed-header":""},{default:a(()=>{var r;return[Ae,((r=e(V))==null?void 0:r.length)==0?(y(),E("tbody",qe,Ee)):(y(),E("tbody",Re,[(y(!0),E(be,null,he(e(V),(u,d)=>(y(),E("tr",{key:d},[l("td",Ie,v(d+1),1),l("td",ze,v(u.activity),1),l("td",Fe,v(u.description),1),l("td",null,v(m.$moment(u.start_date).format("dddd"))+", "+v(m.$moment(u.start_date).format("MMM Do YYYY")),1),l("td",Oe,v(u.start_time),1),l("td",He,v(u.end_time),1),l("td",Ge,[t(w,{icon:"ri-timer-2-line",class:"cursor-pointer me-3"}),C(" "+v(u.estimate)+" Minutes ",1)]),l("td",null,[Z(t(Me,{color:"success",modelValue:u.status,"onUpdate:modelValue":[c=>u.status=c,c=>S(u)],value:!0,"false-value":!1},null,8,["modelValue","onUpdate:modelValue"]),[[ee,u.status?"Completed":"Not Yet","start"]])]),l("td",Je,[u.meeting_link?(y(),U(L,{key:0,color:"primary",density:"compact",class:"me-1"},{default:a(()=>[l("a",{href:u.meeting_link,target:"_blank",class:"bg-primary"},[t(w,{icon:"ri ri-link"}),C(" Join ")],8,We)]),_:2},1024)):re("",!0),Z((y(),U(L,{color:"warning",density:"compact",class:"me-1",onClick:c=>k("edit",u)},{default:a(()=>[t(w,{icon:"ri-edit-line",class:"cursor-pointer"})]),_:2},1032,["onClick"])),[[ee,"Edit Activity","start"]]),Z((y(),U(L,{color:"error",density:"compact",onClick:c=>k("delete",u)},{default:a(()=>[t(w,{icon:"ri-delete-bin-line",class:"cursor-pointer"})]),_:2},1032,["onClick"])),[[ee,"Delete Activity","start"]])])]))),128))]))]}),_:1}))]),_:1}),t(X,{modelValue:e(h).edit,"onUpdate:modelValue":i[4]||(i[4]=r=>e(h).edit=r),"max-width":"600",persistent:""},{default:a(()=>[t(Pe,{timesheet_id:M==null?void 0:M.id,activity:e(o),onClose:i[3]||(i[3]=r=>D("edit")),onReload:f},null,8,["timesheet_id","activity"])]),_:1},8,["modelValue"]),t(X,{modelValue:e(h).delete,"onUpdate:modelValue":i[6]||(i[6]=r=>e(h).delete=r),"max-width":"400",persistent:""},{default:a(()=>[t(ye,{title:"activity",onClose:i[5]||(i[5]=r=>D("delete")),onDelete:n})]),_:1},8,["modelValue"])]),_:1}))}},Ke={__name:"timesheet-transfer",props:{timesheet_id:Number,require:String},emits:["close","reload"],setup(N,{emit:M}){const _=b(),V=N,s=M,h=b([]),o=b([]),f=b([]),D=V.require.toLowerCase(),k=b(!1),n=b({mentortutor_email:null,subject_id:null}),S=async()=>{const r="api/v1/user/mentor-tutors?role="+D;k.value=!0;try{const u=await P.get(r);u&&(h.value=u)}catch(u){console.error(u)}finally{k.value=!1}},m=async(r,u=null)=>{if(n.value.subject_id=null,D=="mentor")n.value.subject_id=r[0].subjects[0].id;else{k.value=!0;try{const d=await P.get("api/v1/user/mentor-tutors/"+u+"/subjects");d&&(f.value=d)}catch(d){console.error(d)}finally{k.value=!1}}},i=async()=>{var d,c;s("close"),n.value.mentortutor_email=o.value.email;const{valid:r}=await _.value.validate(),u=await ke("Are you sure you want to change the owner?");if(r&&u){k.value=!0;try{const p=await P.patch("api/v1/timesheet/"+V.timesheet_id+"/void/",n.value);p&&(Y("success",p.message,"bottom-end"),le.push({path:"/admin/timesheet/"+p.data.timesheet_id}),n.value={mentortutor_email:null,subject_id:null},o.value=[],setTimeout(()=>{le.go(0)},1e3))}catch(p){if(console.log(p),(c=(d=p==null?void 0:p.response)==null?void 0:d.data)!=null&&c.errors){const A=p.response.data.errors;Y("error",A,"bottom-end")}}finally{s("close"),k.value=!1}}};return de(()=>{S()}),(r,u)=>(y(),U(O,{class:"mx-auto my-8",elevation:"16",width:"450"},{default:a(()=>[t(ce,{ref_key:"formData",ref:_,"validate-on":"input",onSubmit:oe(i,["prevent"])},{default:a(()=>[t(se,null,{default:a(()=>[t(W,null,{default:a(()=>[C(" Timesheet Ownership Transfer ")]),_:1}),t(Te,null,{default:a(()=>[C(" Change Timesheet Handler ")]),_:1})]),_:1}),t(B,null,{default:a(()=>[t(Q,null,{default:a(()=>{var d;return[t(T,{md:"12"},{default:a(()=>[t(te,{variant:"solo",clearable:"",modelValue:e(o),"onUpdate:modelValue":[u[0]||(u[0]=c=>Ve(o)?o.value=c:null),u[1]||(u[1]=c=>m(e(o).roles,e(o).uuid))],label:"Mentor/Tutor",items:e(h),"item-props":c=>({title:c.full_name,subtitle:c.roles.map(p=>p.name).join(", ")}),rules:e(R).required,loading:e(k),disabled:e(k)},null,8,["modelValue","items","item-props","rules","loading","disabled"])]),_:1}),((d=V.require)==null?void 0:d.toLowerCase())=="tutor"?(y(),U(T,{key:0,md:"12"},{default:a(()=>[t(te,{variant:"solo",clearable:"",modelValue:e(n).subject_id,"onUpdate:modelValue":u[2]||(u[2]=c=>e(n).subject_id=c),label:"Subject Tutoring",items:e(f),"item-title":"subject","item-value":"id",loading:e(k),disabled:e(k),rules:e(R).required},null,8,["modelValue","items","loading","disabled","rules"])]),_:1})):re("",!0)]}),_:1})]),_:1}),t(ue,{class:"mx-3 mb-3"},{default:a(()=>[t(L,{color:"error",onClick:u[3]||(u[3]=d=>s("close"))},{default:a(()=>[t(w,{icon:"ri-close-line",class:"me-3"}),C(" Close ")]),_:1}),t(ne),t(L,{color:"success",type:"submit"},{default:a(()=>[C(" Save Changes "),t(w,{icon:"ri-save-line",class:"ms-3"})]),_:1})]),_:1})]),_:1},512)]),_:1}))}},Qe={__name:"user-edit",props:["id","item","package_id"],emits:["close","reload"],setup(N,{emit:M}){var p,A,q,I,H,G;const _=N,V=M,s=b([]),h=b([]),o=b([]),f=b([]),D=b(!1),k=b(!0),n=b(!0),S=b(),m=b({mentortutor_email:(p=_.item)==null?void 0:p.tutormentor_email,subject_id:(A=_.item)==null?void 0:A.subject_id,inhouse_id:(q=_.item)==null?void 0:q.inhouse_id,package_id:_.package_id,duration:(I=_.item)==null?void 0:I.duration,notes:(H=_.item)==null?void 0:H.notes,pic_id:(G=_.item)==null?void 0:G.pic_id}),i=async($=!1)=>{n.value=!0;const x=$?"api/v1/user/mentor-tutors?inhouse=true":"api/v1/user/mentor-tutors";try{const j=await P.get(x);j&&($?f.value=Object.values(j):s.value=j)}catch(j){console.error(j)}finally{n.value=!1}},r=async()=>{n.value=!0;try{const $=await P.get("api/v1/package/component/list");$&&(h.value=$)}catch($){console.error($)}finally{n.value=!1}},u=()=>{const $=m.value.package_id,x=h.value.findIndex(g=>g.id===$);let j=h.value[x];j.detail?(D.value=!0,m.value.duration=j.detail):(D.value=!1,m.value.duration=null)},d=async()=>{n.value=!0;try{const $=await P.get("api/v1/user/component/list");$&&(o.value=$)}catch($){console.error($)}finally{n.value=!1}},c=async()=>{var x,j;const{valid:$}=await S.value.validate();if($)try{const g=await P.put("api/v1/timesheet/"+_.id+"/update",m.value);g&&(m.value={mentortutor_email:null,subject_id:null,inhouse_id:null,package_id:null,duration:"",notes:"",pic_id:[]},Y("success",g.message,"bottom-end"),V("reload"))}catch(g){if((j=(x=g==null?void 0:g.response)==null?void 0:x.data)!=null&&j.errors){const me=g.response.data.errors;let ve="Validation errors:";for(const _e in me)me.hasOwnProperty(_e)&&(ve+=`
${_e}: ${me[_e].join(", ")}`);Y("error",ve,"bottom-end")}}finally{V("close")}};return de(()=>{i(!0),r(),d(),setTimeout(()=>{k.value=!1},2e3)}),($,x)=>{const j=K("DialogCloseBtn");return y(),U(O,{title:"Edit Detail"},{default:a(()=>[t(j,{variant:"text",size:"default",onClick:x[0]||(x[0]=g=>V("close"))}),t(B,null,{default:a(()=>[t(ce,{onSubmit:oe(c,["prevent"]),ref_key:"formData",ref:S,"validate-on":"input"},{default:a(()=>[t(Q,null,{default:a(()=>[t(T,{md:"8"},{default:a(()=>[t(te,{variant:"solo",clearable:"",label:"Package",modelValue:e(m).package_id,"onUpdate:modelValue":[x[1]||(x[1]=g=>e(m).package_id=g),u],items:e(h),"item-props":g=>({title:g.package!=null?g.type_of+" - "+g.package:g.type_of}),"item-value":"id",rules:e(R).required,loading:e(n),disabled:e(n)},null,8,["modelValue","items","item-props","rules","loading","disabled"])]),_:1}),t(T,{md:"4"},{default:a(()=>[t(F,{type:"number",variant:"solo",clearable:"",label:+e(m).duration/60?"Minutes ("+e(m).duration/60+" Hours)":"Minutes",readonly:e(D),modelValue:e(m).duration,"onUpdate:modelValue":x[2]||(x[2]=g=>e(m).duration=g),rules:e(R).required},null,8,["label","readonly","modelValue","rules"])]),_:1}),t(T,{md:"12"},{default:a(()=>[t(te,{variant:"solo",clearable:"",modelValue:e(m).inhouse_id,"onUpdate:modelValue":x[3]||(x[3]=g=>e(m).inhouse_id=g),label:"Inhouse Mentor/Tutor",items:e(f),"item-props":g=>({title:g.full_name}),"item-value":"uuid",rules:e(R).required,loading:e(n),disabled:e(n)},null,8,["modelValue","items","item-props","rules","loading","disabled"])]),_:1}),t(T,{md:"12"},{default:a(()=>[t(te,{variant:"solo",multiple:"",clearable:"",chips:"",label:"PIC",modelValue:e(m).pic_id,"onUpdate:modelValue":x[4]||(x[4]=g=>e(m).pic_id=g),items:e(o),"item-title":"full_name","item-value":"id",rules:e(R).required,loading:e(n),disabled:e(n)},null,8,["modelValue","items","rules","loading","disabled"])]),_:1}),t(T,{md:"12"},{default:a(()=>[t(pe,{label:"Notes",modelValue:e(m).notes,"onUpdate:modelValue":x[5]||(x[5]=g=>e(m).notes=g),variant:"solo"},null,8,["modelValue"])]),_:1})]),_:1}),t(Se,{class:"my-3"}),t(ue,null,{default:a(()=>[t(L,{color:"error",type:"button",onClick:x[6]||(x[6]=g=>V("close"))},{default:a(()=>[t(w,{icon:"ri-close-line",class:"me-3"}),C(" Close ")]),_:1}),t(ne),t(L,{color:"success",type:"submit"},{default:a(()=>[C(" Save "),t(w,{icon:"ri-save-line",class:"ms-3"})]),_:1})]),_:1})]),_:1},512)]),_:1})]),_:1})}}},Ze={class:"w-100"},et={class:"mt-3 font-weight-light"},tt=l("hr",{class:"my-2"},null,-1),lt={key:0},at=l("tr",{class:"bg-secondary"},[l("td",null,"Name"),l("td",null,"School"),l("td",null,"Grade")],-1),st={key:1},it=l("td",{width:"20%"},"Name",-1),ot=l("td",{width:"1%"},":",-1),nt=l("td",null,"School Name",-1),dt=l("td",{width:"1%"},":",-1),rt=l("td",null,"Grade",-1),ut=l("td",{width:"1%"},":",-1),ct=l("td",null,"Email",-1),mt=l("td",{width:"1%"},":",-1),_t={class:"mt-5 font-weight-light"},ft=l("hr",{class:"my-2"},null,-1),pt={width:"30%"},vt=l("td",{width:"1%"},":",-1),gt={key:0},yt={key:1},bt=l("td",null,"Package",-1),ht=l("td",{width:"1%"},":",-1),Vt=l("td",null,"Person in Charge",-1),kt=l("td",{width:"1%"},":",-1),wt=l("td",{width:"1%"},":",-1),xt=l("td",{width:"1%"},":",-1),Dt=l("td",null,"Notes",-1),$t=l("td",{width:"1%"},":",-1),Ct=l("td",null,"Update On",-1),Tt=l("td",{width:"1%"},":",-1),Mt={class:"d-flex align-end w-100"},St={class:"m-0 mb-1 text-white"},Yt=l("h4",{class:"m-0 ms-2 text-white"},"Minutes",-1),Ut={class:"text-end w-100"},jt={class:"d-flex align-end w-100"},Pt={class:"m-0 mb-1 text-white"},Lt=l("h4",{class:"m-0 ms-2 text-white"},"Minutes",-1),Nt={class:"text-end w-100"},At={class:"d-flex align-end w-100"},qt={class:"m-0 mb-1 text-white"},Bt=l("h4",{class:"m-0 ms-2 text-white"},"Minutes",-1),Et={class:"text-end w-100"},Rt={__name:"user-detail",props:{id:String,name:String},emits:["void"],setup(N,{emit:M}){const _=N,V=M,s=ie("reloadData"),h=ie("updateReload"),o=b([]),f=b([{edit:!1,void:!1,delete:!1}]),D=b(!1),k=async i=>{var r,u,d;D.value=!0;try{const c=await P.get("api/v1/timesheet/"+i+"/detail");c&&(o.value=c,V("void",c.packageDetails.void))}catch(c){((r=c.response)==null?void 0:r.status)==400&&(Y("error",(d=(u=c.response)==null?void 0:u.data)==null?void 0:d.errors,"bottom-end"),le.push("/admin/timesheet")),console.log(c)}finally{D.value=!1}},n=async()=>{var i,r,u;try{const d=await P.delete("api/v1/timesheet/"+_.id+"/delete");d&&(o.value=d,Y("success",d.message,"bottom-end"),f.value.delete=!1,le.push("/admin/timesheet/tutoring"))}catch(d){((i=d.response)==null?void 0:i.status)==400&&Y("error",(u=(r=d.response)==null?void 0:r.data)==null?void 0:u.errors,"bottom-end")}},S=i=>{f.value[i]?f.value[i]=!1:f.value[i]=!0},m=async(i,r)=>{var u;$e();try{const d=await P.get("api/v1/timesheet/"+i+"/export",{responseType:"blob"});if(d){const c=window.URL.createObjectURL(new Blob([d],{type:'"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"'})),p=document.createElement("a");p.href=c,p.setAttribute("download",`Timesheet_${r}.xlsx`),document.body.appendChild(p),p.click(),document.body.removeChild(p),window.URL.revokeObjectURL(c),Ce.close()}}catch(d){Y("error",(u=d.response)==null?void 0:u.statusText,"bottom-end"),console.log(d)}};return de(()=>{k(_.id)}),we(()=>{s.value&&(k(_.id),h(!1))}),(i,r)=>{const u=K("router-link");return y(),U(O,{class:"mb-3"},{default:a(()=>[e(D)?(y(),U(J,{key:0,type:"heading"})):(y(),U(W,{key:1,class:"d-flex justify-between align-center"},{default:a(()=>{var d,c,p,A,q;return[l("div",Ze,[t(u,{to:"/admin/timesheet/"+_.name},{default:a(()=>[t(w,{icon:"ri-arrow-left-line",color:"secondary",class:"me-2",size:"25"})]),_:1},8,["to"]),C(" "+v((d=e(o).packageDetails)==null?void 0:d.tutormentor_name)+" | "+v(((p=(c=e(o))==null?void 0:c.packageDetails)==null?void 0:p.package_type)+" - "+((q=(A=e(o))==null?void 0:A.packageDetails)==null?void 0:q.package_name)),1)]),l("div",null,[t(De,{"close-on-content-click":!1,location:"bottom"},{activator:a(({props:I})=>[Z((y(),U(L,xe({color:"secondary"},I),{default:a(()=>[t(w,{icon:"ri-settings-3-line"})]),_:2},1040)),[[ee,"Settings","start"]])]),default:a(()=>[t(Ye,null,{default:a(()=>[t(ae,null,{default:a(()=>[l("div",{class:"cursor-pointer",onClick:r[0]||(r[0]=I=>S("edit"))},[t(w,{icon:"ri-pencil-line",class:"me-2"}),C(" Edit TimeSheet ")])]),_:1}),t(ae,null,{default:a(()=>[l("div",{class:"cursor-pointer",onClick:r[1]||(r[1]=I=>S("void"))},[t(w,{icon:"ri-exchange-2-line",class:"me-2"}),C(" Timesheet Ownership Transfer ")])]),_:1}),t(ae,null,{default:a(()=>[t(Ue,null,{default:a(()=>[l("div",{class:"cursor-pointer",onClick:r[2]||(r[2]=I=>{var H,G,$,x,j,g;return m(_.id,((G=(H=e(o))==null?void 0:H.packageDetails)==null?void 0:G.package_type)+"-"+((x=($=e(o))==null?void 0:$.packageDetails)==null?void 0:x.package_name)+"_"+((g=(j=e(o))==null?void 0:j.packageDetails)==null?void 0:g.tutormentor_name))})},[t(w,{icon:"ri-download-line",class:"me-2"}),C(" Download TimeSheet ")])]),_:1})]),_:1}),t(ae,null,{default:a(()=>[l("div",{class:"cursor-pointer",onClick:r[3]||(r[3]=I=>S("delete"))},[t(w,{icon:"ri-delete-bin-line",class:"me-2"}),C(" Delete TimeSheet ")])]),_:1})]),_:1})]),_:1})])]}),_:1})),t(B,null,{default:a(()=>[e(D)?(y(),U(Q,{key:1},{default:a(()=>[t(T,{md:"7"},{default:a(()=>[t(J,{type:"heading, paragraph, heading, paragraph",class:"mb-3"})]),_:1}),t(T,{md:"5"},{default:a(()=>[t(J,{type:"text@3",color:"#16B1FF",class:"mb-3"}),t(J,{type:"text@3",color:"#91c45e",class:"mb-3"}),t(J,{type:"text@3",color:"#e05e5e",class:"mb-3"})]),_:1})]),_:1})):(y(),U(Q,{key:0,align:"center"},{default:a(()=>[t(T,{md:"7"},{default:a(()=>[l("h4",et,[t(w,{icon:"ri-user-line",size:"17",class:"me-2"}),C(" Basic Profile ")]),tt,t(fe,{density:"compact"},{default:a(()=>{var d,c;return[((d=e(o).clientProfile)==null?void 0:d.length)>1?(y(),E("tbody",lt,[at,(y(!0),E(be,null,he(e(o).clientProfile,p=>(y(),E("tr",null,[l("td",null,v(p.client_name),1),l("td",null,v(p.client_school),1),l("td",null,v(p.client_grade),1)]))),256))])):((c=e(o).clientProfile)==null?void 0:c.length)==1?(y(),E("tbody",st,[l("tr",null,[it,ot,l("td",null,v(e(o).clientProfile[0].client_name),1)]),l("tr",null,[nt,dt,l("td",null,v(e(o).clientProfile[0].client_school),1)]),l("tr",null,[rt,ut,l("td",null,v(e(o).clientProfile[0].client_grade),1)]),l("tr",null,[ct,mt,l("td",null,v(e(o).clientProfile[0].client_mail),1)])])):re("",!0)]}),_:1}),l("h4",_t,[t(w,{icon:"ri-bookmark-line",class:"me-2",size:"17"}),C(" Package Details ")]),ft,t(fe,{density:"compact"},{default:a(()=>{var d,c,p,A,q,I,H,G,$;return[l("tbody",null,[l("tr",null,[l("td",pt,v(_.name=="tutoring"?"Program Name":"Engagement Type"),1),vt,_.name=="tutoring"?(y(),E("td",gt,v((d=e(o).packageDetails)!=null&&d.free_trial?"[TRIAL]":"")+" "+v((c=e(o).packageDetails)==null?void 0:c.program_name),1)):(y(),E("td",yt,v((p=e(o).packageDetails)==null?void 0:p.engagement_type),1))]),l("tr",null,[bt,ht,l("td",null,v(((A=e(o).packageDetails)==null?void 0:A.package_type)+" - "+((q=e(o).packageDetails)==null?void 0:q.package_name)),1)]),l("tr",null,[Vt,kt,l("td",null,v((I=e(o).packageDetails)==null?void 0:I.pic_name),1)]),l("tr",null,[l("td",null,v(_.name=="tutoring"?"Tutor":"Mentor")+" Name",1),wt,l("td",null,v((H=e(o).packageDetails)==null?void 0:H.tutormentor_name),1)]),l("tr",null,[l("td",null,"Inhouse "+v(_.name=="tutoring"?"Tutor":"Mentor"),1),xt,l("td",null,v((G=e(o).packageDetails)==null?void 0:G.inhouse_name),1)]),l("tr",null,[Dt,$t,l("td",null,v(($=e(o).editableColumns)==null?void 0:$.notes),1)]),l("tr",null,[Ct,Tt,l("td",null,v(e(z)().format("LLL")),1)])])]}),_:1})]),_:1}),t(T,{md:"5"},{default:a(()=>[t(O,{color:"#16B1FF",class:"mb-2 d-flex align-center"},{default:a(()=>[l("div",null,[t(se,null,{default:a(()=>[t(W,{class:"text-white"},{default:a(()=>[C(" Total Minutes of Package ")]),_:1})]),_:1}),t(B,{class:"d-flex justify-between"},{default:a(()=>{var d;return[l("div",Mt,[l("h1",St,v((d=e(o).packageDetails)==null?void 0:d.duration_in_minutes),1),Yt])]}),_:1})]),t(B,null,{default:a(()=>[l("div",Ut,[t(w,{icon:"ri-calendar-schedule-line",size:"60"})])]),_:1})]),_:1}),t(O,{color:"#91c45e",class:"mb-2 d-flex align-center"},{default:a(()=>[l("div",null,[t(se,null,{default:a(()=>[t(W,{class:"text-white"},{default:a(()=>[C(" Total Minutes Spent ")]),_:1})]),_:1}),t(B,{class:"d-flex justify-between"},{default:a(()=>{var d;return[l("div",jt,[l("h1",Pt,v((d=e(o).packageDetails)==null?void 0:d.time_spent_in_minutes),1),Lt])]}),_:1})]),t(B,null,{default:a(()=>[l("div",Nt,[t(w,{icon:"ri-timer-flash-line",size:"60",color:"white"})])]),_:1})]),_:1}),t(O,{color:"#e05e5e",class:"mb-2 d-flex align-center"},{default:a(()=>[l("div",null,[t(se,null,{default:a(()=>[t(W,{class:"text-white"},{default:a(()=>[C(" Total Minutes Left ")]),_:1})]),_:1}),t(B,{class:"d-flex justify-between"},{default:a(()=>{var d,c;return[l("div",At,[l("h1",qt,v(((d=e(o).packageDetails)==null?void 0:d.duration_in_minutes)-((c=e(o).packageDetails)==null?void 0:c.time_spent_in_minutes)),1),Bt])]}),_:1})]),t(B,null,{default:a(()=>[l("div",Et,[t(w,{icon:"ri-timer-2-line",size:"60"})])]),_:1})]),_:1})]),_:1})]),_:1}))]),_:1}),t(X,{modelValue:e(f).edit,"onUpdate:modelValue":r[6]||(r[6]=d=>e(f).edit=d),"max-width":"600",persistent:""},{default:a(()=>{var d;return[t(Qe,{item:e(o).editableColumns,package_id:(d=e(o).packageDetails)==null?void 0:d.package_id,id:_.id,onClose:r[4]||(r[4]=c=>S("edit")),onReload:r[5]||(r[5]=c=>k(_.id))},null,8,["item","package_id","id"])]}),_:1},8,["modelValue"]),t(X,{modelValue:e(f).delete,"onUpdate:modelValue":r[8]||(r[8]=d=>e(f).delete=d),"max-width":"400",persistent:""},{default:a(()=>[t(ye,{title:"timesheet",onDelete:n,onClose:r[7]||(r[7]=d=>S("delete"))})]),_:1},8,["modelValue"]),t(X,{modelValue:e(f).void,"onUpdate:modelValue":r[10]||(r[10]=d=>e(f).void=d),"max-width":"400",persistent:""},{default:a(()=>[t(Ke,{timesheet_id:_.id,require:e(o).editableColumns.tutormentor_role,onClose:r[9]||(r[9]=d=>S("void"))},null,8,["timesheet_id","require"])]),_:1},8,["modelValue"])]),_:1})}}},It={class:"h-auto position-relative"},zt={key:0,class:"overlay"},Ft=l("div",{class:"bg-secondary",style:{height:"100%",position:"absolute",left:"0",top:"0","z-index":"9998",width:"100%",opacity:"0.6"}},null,-1),Ot={class:"d-flex align-center justify-center",style:{height:"100%",position:"absolute",left:"0",top:"0","z-index":"9999",width:"100%",opacity:"1"}},Ht={class:"text-center"},Gt=l("h2",{class:"text-white mt-3"},"This Timesheet Has Changed Owner",-1),pl={__name:"timesheet-detail",props:{id:Number,name:String},setup(N){const M=N,_=M.id,V=b(!1),s=b(!1);ge("reloadData",V),ge("updateReload",o=>{V.value=o});const h=o=>{s.value=o};return(o,f)=>(y(),E("div",It,[e(s)=="true"?(y(),E("div",zt,[Ft,l("div",Ot,[l("div",Ht,[t(w,{color:"white",icon:"ri-lock-line",size:"50"}),Gt,t(L,{color:"light",class:"mt-4",onClick:f[0]||(f[0]=D=>e(le).push({path:"/admin/timesheet"+M.name}))},{default:a(()=>[C(" Back to List ")]),_:1})])])])):re("",!0),t(Rt,{id:e(_),name:M.name,onVoid:h},null,8,["id","name"]),t(Xe,{id:e(_)},null,8,["id"])]))}};export{pl as default};
