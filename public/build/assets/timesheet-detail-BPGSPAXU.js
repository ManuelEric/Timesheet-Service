import{r as b,l as I,o as m,f as M,w as a,b as s,am as te,W as j,u as t,v as O,Y,V as y,j as $,m as se,A as N,s as S,ao as G,U as le,e as K,a as e,x as q,h as z,c as C,X as Q,F as Z,t as u,y as ae,an as oe,k as ee,as as W}from"./main-CzT7uzRK.js";import{_ as ie}from"./DeleteHandler.vue_vue_type_script_setup_true_lang-CCcehyLo.js";import{d as ne}from"./debounce-B1BoaA5C.js";import{r as R}from"./rules-B5G8qOzK.js";import{a as T,c as de,V as P,b as B,d as E}from"./VCard-tEuXfKy8.js";import{V as re}from"./VForm-_qgyrfcJ.js";import{V as H,a as D}from"./VRow-JoPojWIY.js";import{V as ce}from"./VTextarea-un1ORx3Z.js";import{V as X}from"./VDialog-DdXC2y6v.js";import{a as J,V as L}from"./VTable-BfmrBn65.js";import{T as F}from"./index-Z5hdUKVe.js";import{V as ue}from"./VCheckbox-BBXEfmyO.js";import"./VAvatar-CJXsJV-i.js";import"./VImg-DBnCC04G.js";import"./VTooltip-BvXBKISB.js";import"./VCheckboxBtn-GL2PgKne.js";import"./VSelectionControl-CeIzsl1E.js";const _e={__name:"activity-add",props:{id:String},emits:["close","reload"],setup(U,{emit:f}){const x=U,h=f,c=b(!1),g=b(),l=b({activity:null,description:null,date:null,start_time:null,end_time:null,start_date:null,end_date:null,meeting_link:null}),w=async()=>{var d,k;const{valid:v}=await g.value.validate();if(v){c.value=!0;try{const p=await N.post("api/v1/timesheet/"+x.id+"/activity",l.value);p&&S("success",p.message,"bottom-end")}catch(p){if((k=(d=p==null?void 0:p.response)==null?void 0:d.data)!=null&&k.errors){const o=p.response.data.errors;let _="Validation errors:";for(const i in o)o.hasOwnProperty(i)&&(_+=`
${i}: ${o[i].join(", ")}`);S("error",_,"bottom-end")}else S("error",p.response.data.message,"bottom-end")}finally{c.value=!1,h("reload"),h("close")}}};return(v,d)=>{const k=I("DialogCloseBtn"),p=I("VDateInput");return m(),M(P,{title:"New Activity"},{default:a(()=>[s(k,{variant:"text",size:"default",onClick:d[0]||(d[0]=o=>h("close"))}),s(T,null,{default:a(()=>[s(re,{onSubmit:te(w,["prevent"]),ref_key:"formData",ref:g,"validate-on":"input"},{default:a(()=>[s(H,null,{default:a(()=>[s(D,{cols:"12",class:"d-none"},{default:a(()=>[s(j,{modelValue:t(l).activity,"onUpdate:modelValue":d[1]||(d[1]=o=>t(l).activity=o),label:"Activity Name",placeholder:"Activity",loading:t(c),disabled:t(c),variant:"solo"},null,8,["modelValue","loading","disabled"])]),_:1}),s(D,{cols:"12"},{default:a(()=>[s(ce,{modelValue:t(l).description,"onUpdate:modelValue":d[2]||(d[2]=o=>t(l).description=o),label:"Meeting Discussion",placeholder:"Meeting Discussion",variant:"solo",loading:t(c),disabled:t(c),rules:t(R).required},null,8,["modelValue","loading","disabled","rules"])]),_:1}),s(D,{md:"6",cols:"12"},{default:a(()=>[s(p,{modelValue:t(l).date,"onUpdate:modelValue":d[3]||(d[3]=o=>t(l).date=o),label:"Date",placeholder:"Select Date","prepend-icon":"",variant:"solo",loading:t(c),disabled:t(c),rules:t(R).required},null,8,["modelValue","loading","disabled","rules"])]),_:1}),s(D,{md:"3",cols:"6"},{default:a(()=>[s(j,{type:"time",modelValue:t(l).start_time,"onUpdate:modelValue":d[4]||(d[4]=o=>t(l).start_time=o),label:"Start Time",placeholder:"Start Time",rules:t(R).required,variant:"solo",class:"mb-3",loading:t(c),disabled:t(c),onChange:d[5]||(d[5]=o=>t(l).start_date=t(O)(t(l).date).format("YYYY-MM-DD")+" "+t(l).start_time+":00")},null,8,["modelValue","rules","loading","disabled"])]),_:1}),s(D,{md:"3",cols:"6"},{default:a(()=>[s(j,{type:"time",modelValue:t(l).end_time,"onUpdate:modelValue":d[6]||(d[6]=o=>t(l).end_time=o),label:"End Time",placeholder:"End Time",variant:"solo",loading:t(c),disabled:t(c),onChange:d[7]||(d[7]=o=>t(l).end_date=t(O)(t(l).date).format("YYYY-MM-DD")+" "+t(l).end_time+":00")},null,8,["modelValue","loading","disabled"])]),_:1}),s(D,{md:"12",cols:"12"},{default:a(()=>[s(j,{type:"text",modelValue:t(l).meeting_link,"onUpdate:modelValue":d[8]||(d[8]=o=>t(l).meeting_link=o),label:"Meeting Link",placeholder:"Meeting Link",variant:"solo",loading:t(c),disabled:t(c)},null,8,["modelValue","loading","disabled"])]),_:1})]),_:1}),s(de,{class:"mt-5"},{default:a(()=>[s(Y,{type:"button",color:"error",loading:t(c),disabled:t(c),onClick:d[9]||(d[9]=o=>h("close"))},{default:a(()=>[s(y,{icon:"ri-close-line",class:"me-3"}),$(" Close ")]),_:1},8,["loading","disabled"]),s(se),s(Y,{loading:t(c),disabled:t(c),type:"submit",color:"success"},{default:a(()=>[$(" Save "),s(y,{icon:"ri-save-line",class:"ms-3"})]),_:1},8,["loading","disabled"])]),_:1})]),_:1},512)]),_:1})]),_:1})}}},me={class:"d-flex justify-between align-center"},pe=e("div",{class:"w-100"},[e("h4",null,"Activity")],-1),fe=e("th",{class:"text-uppercase",width:"1%"}," No ",-1),he=e("th",{class:"text-uppercase text-center"},"Meeting Discussion",-1),ge=e("th",{class:"text-uppercase text-center"},"Date",-1),ve=e("th",{class:"text-uppercase text-center"},"Start Time",-1),ye=e("th",{class:"text-uppercase text-center",style:{width:"200px !important"}}," End Time ",-1),be=e("th",{class:"text-uppercase text-center"},"Time Spent",-1),xe=e("th",{class:"text-uppercase text-center"},"Status",-1),we={key:0,class:"text-uppercase text-end"},Ve={width:"1%"},ke={class:"text-start"},$e={class:"text-center"},De={class:"text-start"},Ce=["onUpdate:modelValue","onChange","disabled"],Te={class:"text-center"},Me={key:0,class:"text-end"},Se=["href"],Ue={__name:"timesheet-detail",props:{id:String,require:String},setup(U){const f=U,x=G("updateReload"),h=b([]),c=b(!1),g=b(le.getUser().role_detail[0].role.toLowerCase()),l=b([{add:!1,delete:!1}]),w=b([]),v=async()=>{c.value=!0;try{const i=await N.get("api/v1/timesheet/"+f.id+"/activities");i&&(h.value=i)}catch(i){console.error(i)}finally{c.value=!1}},d=i=>{l.value[i]?l.value[i]=!1:l.value[i]=!0},k=(i,r)=>{w.value=r,d(i)},p=async()=>{var i,r,n;try{const V=await N.delete("api/v1/timesheet/"+f.id+"/activity/"+w.value.id);V&&(S("success",V.message,"bottom-end"),d("delete"))}catch(V){((i=V.response)==null?void 0:i.status)==400&&S("error",(n=(r=V.response)==null?void 0:r.data)==null?void 0:n.errors,"bottom-end")}finally{v(),x(!0)}},o=ne(async i=>{i.end_date=i.date+" "+i.end_time+":00";try{const r=await N.put("api/v1/timesheet/"+f.id+"/activity/"+i.id,i);r&&S("success",r.message,"bottom-end")}catch(r){console.error(r)}finally{v(),x(!0)}},500),_=async i=>{try{const r=await N.put("api/v1/timesheet/"+f.id+"/activity/"+i.id,i);r&&S("success",r.message,"bottom-end")}catch(r){console.error(r)}finally{v(),x(!0)}};return K(()=>{v()}),(i,r)=>(m(),M(P,null,{default:a(()=>[s(B,null,{default:a(()=>[e("div",me,[pe,t(g)=="external mentor"?q((m(),M(Y,{key:0,onClick:r[0]||(r[0]=n=>d("add"))},{default:a(()=>[s(y,{icon:"ri-add-line"})]),_:1})),[[F,"New Activity","start"]]):z("",!0),s(X,{modelValue:t(l).add,"onUpdate:modelValue":r[2]||(r[2]=n=>t(l).add=n),"max-width":"600",persistent:""},{default:a(()=>[s(_e,{id:f.id,onClose:r[1]||(r[1]=n=>d("add")),onReload:v},null,8,["id"])]),_:1},8,["modelValue"])])]),_:1}),s(T,null,{default:a(()=>[t(c)?(m(),M(L,{key:1,type:"table"})):(m(),M(J,{key:0,class:"text-no-wrap",height:"400","fixed-header":""},{default:a(()=>[e("thead",null,[e("tr",null,[fe,he,ge,ve,ye,be,xe,t(g)!="mentor"?(m(),C("th",we," # ")):z("",!0)])]),e("tbody",null,[(m(!0),C(Z,null,Q(t(h),(n,V)=>(m(),C("tr",{key:V},[e("td",Ve,u(V+1),1),e("td",ke,u(n.description),1),e("td",null,u(i.$moment(n.start_date).format("dddd"))+", "+u(i.$moment(n.start_date).format("MMM Do YYYY")),1),e("td",$e,u(n.start_time),1),e("td",De,[q(e("input",{type:"time",class:"form-control px-2 py-2 border rounded cursor-pointer","onUpdate:modelValue":A=>n.end_time=A,onChange:A=>t(o)(n),disabled:t(g)=="mentor"||n.start_time=="00:00"||n.cutoff_status=="completed"},null,40,Ce),[[ae,n.end_time],[F,n.cutoff_status=="completed"?"Already Cut-Off":"End Time","start"]])]),e("td",Te,u(n.estimate)+" Minutes",1),e("td",null,[q(s(ue,{color:"success",modelValue:n.status,"onUpdate:modelValue":[A=>n.status=A,A=>_(n)],value:!0,disabled:t(g)=="mentor"||n.start_time=="00:00"||n.cutoff_status=="completed"},null,8,["modelValue","onUpdate:modelValue","disabled"]),[[F,n.status?"Completed":"Not Yet","start"]])]),t(g)!="mentor"?(m(),C("td",Me,[s(Y,{color:"primary",density:"compact",class:"me-1"},{default:a(()=>[e("a",{href:n.meeting_link,target:"_blank",class:"bg-primary"},[s(y,{icon:"ri ri-link"}),$(" Join ")],8,Se)]),_:2},1024),q((m(),M(Y,{color:"error",density:"compact",disabled:n.start_time=="00:00"||n.cutoff_status=="completed",onClick:A=>k("delete",n)},{default:a(()=>[s(y,{icon:"ri-delete-bin-line",class:"cursor-pointer"})]),_:2},1032,["disabled","onClick"])),[[F,n.status?"Already Cut-Off":"Delete Activity","start"]])])):z("",!0)]))),128))])]),_:1}))]),_:1}),s(X,{modelValue:t(l).delete,"onUpdate:modelValue":r[4]||(r[4]=n=>t(l).delete=n),"max-width":"400",persistent:""},{default:a(()=>[s(ie,{title:"activity",onClose:r[3]||(r[3]=n=>d("delete")),onDelete:p})]),_:1},8,["modelValue"])]),_:1}))}},Ae={class:"w-100"},Ne={class:"mt-3 font-weight-light"},Pe=e("hr",{class:"my-2"},null,-1),Ye={key:0},Be=e("tr",{class:"bg-secondary"},[e("td",null,"Name"),e("td",null,"School"),e("td",null,"Grade")],-1),Le={key:1},ze=e("td",{width:"20%"},"Name",-1),je=e("td",{width:"1%"},":",-1),qe=e("td",null,"School Name",-1),Fe=e("td",{width:"1%"},":",-1),Re=e("td",null,"Grade",-1),Ee=e("td",{width:"1%"},":",-1),Ie=e("td",null,"Email",-1),Oe=e("td",{width:"1%"},":",-1),Ge={class:"mt-5 font-weight-light"},He=e("hr",{class:"my-2"},null,-1),Je=e("td",{width:"20%"},"Program",-1),We=e("td",{width:"1%"},":",-1),Xe=e("td",null,"Package",-1),Ke=e("td",{width:"1%"},":",-1),Qe=e("td",null,"Person in Charge",-1),Ze=e("td",{width:"1%"},":",-1),et=e("td",null,"Tutor/Mentor",-1),tt=e("td",{width:"1%"},":",-1),st=e("td",null,"Update On",-1),lt=e("td",{width:"1%"},":",-1),at={class:"d-flex align-end w-100"},ot={class:"m-0 mb-1 text-white"},it=e("h4",{class:"m-0 ms-2 text-white"},"Minutes",-1),nt={class:"text-end w-100"},dt={class:"d-flex align-end w-100"},rt={class:"m-0 mb-1 text-white"},ct=e("h4",{class:"m-0 ms-2 text-white"},"Minutes",-1),ut={class:"text-end w-100"},_t={class:"d-flex align-end w-100"},mt={class:"m-0 mb-1 text-white"},pt=e("h4",{class:"m-0 ms-2 text-white"},"Minutes",-1),ft={class:"text-end w-100"},ht={__name:"user-detail",props:{id:String},emits:["void"],setup(U,{emit:f}){const x=U,h=f,c=G("reloadData"),g=G("updateReload"),l=b([]),w=b(!1),v=async d=>{var k,p,o;w.value=!0;try{const _=await N.get("api/v1/timesheet/"+d+"/detail");_&&(l.value=_,h("void",_.packageDetails.void))}catch(_){((k=_.response)==null?void 0:k.status)==400&&(S("error",(o=(p=_.response)==null?void 0:p.data)==null?void 0:o.errors,"bottom-end"),ee.push("/admin/timesheet")),console.log(_)}finally{w.value=!1}};return K(()=>{v(x.id)}),oe(()=>{c.value&&(v(x.id),g(!1))}),(d,k)=>{const p=I("router-link");return m(),M(P,{class:"mb-3"},{default:a(()=>[s(B,{class:"d-flex justify-between align-center"},{default:a(()=>{var o;return[e("div",Ae,[s(p,{to:"/user/timesheet"},{default:a(()=>[s(y,{icon:"ri-arrow-left-line",color:"secondary",class:"me-2",size:"25"})]),_:1}),$(" Timesheet - "+u((o=t(l).packageDetails)==null?void 0:o.package_type),1)])]}),_:1}),s(T,null,{default:a(()=>[t(w)?(m(),M(H,{key:1},{default:a(()=>[s(D,{md:"7"},{default:a(()=>[s(L,{type:"heading, paragraph, heading, paragraph",class:"mb-3"})]),_:1}),s(D,{md:"5"},{default:a(()=>[s(L,{type:"text@3",color:"#16B1FF",class:"mb-3"}),s(L,{type:"text@3",color:"#91c45e",class:"mb-3"}),s(L,{type:"text@3",color:"#e05e5e",class:"mb-3"})]),_:1})]),_:1})):(m(),M(H,{key:0,align:"center"},{default:a(()=>[s(D,{md:"7"},{default:a(()=>[e("h4",Ne,[s(y,{icon:"ri-user-line",size:"17",class:"me-2"}),$(" Basic Profile ")]),Pe,s(J,{density:"compact"},{default:a(()=>{var o,_;return[((o=t(l).clientProfile)==null?void 0:o.length)>1?(m(),C("tbody",Ye,[Be,(m(!0),C(Z,null,Q(t(l).clientProfile,i=>(m(),C("tr",null,[e("td",null,u(i.client_name),1),e("td",null,u(i.client_school),1),e("td",null,u(i.client_grade),1)]))),256))])):((_=t(l).clientProfile)==null?void 0:_.length)==1?(m(),C("tbody",Le,[e("tr",null,[ze,je,e("td",null,u(t(l).clientProfile[0].client_name),1)]),e("tr",null,[qe,Fe,e("td",null,u(t(l).clientProfile[0].client_school),1)]),e("tr",null,[Re,Ee,e("td",null,u(t(l).clientProfile[0].client_grade),1)]),e("tr",null,[Ie,Oe,e("td",null,u(t(l).clientProfile[0].client_mail),1)])])):z("",!0)]}),_:1}),e("h4",Ge,[s(y,{icon:"ri-bookmark-line",class:"me-2",size:"17"}),$(" Package Details ")]),He,s(J,{density:"compact"},{default:a(()=>{var o,_,i,r,n,V;return[e("tbody",null,[e("tr",null,[Je,We,e("td",null,u((o=t(l).packageDetails)!=null&&o.free_trial?"[TRIAL]":"")+" "+u((_=t(l).packageDetails)==null?void 0:_.program_name),1)]),e("tr",null,[Xe,Ke,e("td",null,u(((i=t(l).packageDetails)==null?void 0:i.package_type)+" - "+((r=t(l).packageDetails)==null?void 0:r.package_name)),1)]),e("tr",null,[Qe,Ze,e("td",null,u((n=t(l).packageDetails)==null?void 0:n.pic_name),1)]),e("tr",null,[et,tt,e("td",null,u((V=t(l).packageDetails)==null?void 0:V.tutormentor_name),1)]),e("tr",null,[st,lt,e("td",null,u(t(O)().format("LLL")),1)])])]}),_:1})]),_:1}),s(D,{md:"5"},{default:a(()=>[s(P,{color:"#16B1FF",class:"mb-2 d-flex align-center"},{default:a(()=>[e("div",null,[s(E,null,{default:a(()=>[s(B,{class:"text-white"},{default:a(()=>[$(" Total Minutes of Package ")]),_:1})]),_:1}),s(T,{class:"d-flex justify-between"},{default:a(()=>{var o;return[e("div",at,[e("h1",ot,u((o=t(l).packageDetails)==null?void 0:o.duration_in_minutes),1),it])]}),_:1})]),s(T,null,{default:a(()=>[e("div",nt,[s(y,{icon:"ri-calendar-schedule-line",size:"60"})])]),_:1})]),_:1}),s(P,{color:"#91c45e",class:"mb-2 d-flex align-center"},{default:a(()=>[e("div",null,[s(E,null,{default:a(()=>[s(B,{class:"text-white"},{default:a(()=>[$(" Total Minutes Spent ")]),_:1})]),_:1}),s(T,{class:"d-flex justify-between"},{default:a(()=>{var o;return[e("div",dt,[e("h1",rt,u((o=t(l).packageDetails)==null?void 0:o.time_spent_in_minutes),1),ct])]}),_:1})]),s(T,null,{default:a(()=>[e("div",ut,[s(y,{icon:"ri-timer-flash-line",size:"60",color:"white"})])]),_:1})]),_:1}),s(P,{color:"#e05e5e",class:"mb-2 d-flex align-center"},{default:a(()=>[e("div",null,[s(E,null,{default:a(()=>[s(B,{class:"text-white"},{default:a(()=>[$(" Total Minutes Left ")]),_:1})]),_:1}),s(T,{class:"d-flex justify-between"},{default:a(()=>{var o,_;return[e("div",_t,[e("h1",mt,u(((o=t(l).packageDetails)==null?void 0:o.duration_in_minutes)-((_=t(l).packageDetails)==null?void 0:_.time_spent_in_minutes)),1),pt])]}),_:1})]),s(T,null,{default:a(()=>[e("div",ft,[s(y,{icon:"ri-timer-2-line",size:"60"})])]),_:1})]),_:1})]),_:1})]),_:1}))]),_:1})]),_:1})}}},gt={class:"h-auto position-relative"},vt={key:0,class:"overlay"},yt=e("div",{class:"bg-secondary",style:{height:"100%",position:"absolute",left:"0",top:"0","z-index":"9998",width:"100%",opacity:"0.6"}},null,-1),bt={class:"d-flex align-center justify-center",style:{height:"100%",position:"absolute",left:"0",top:"0","z-index":"9999",width:"100%",opacity:"1"}},xt={class:"text-center"},wt=e("h2",{class:"text-white mt-3"},"This Timesheet Has Changed Owner",-1),qt={__name:"timesheet-detail",props:{id:Number,require:String},setup(U){const f=U,x=f.id,h=b(!1),c=b(!1);W("reloadData",h),W("updateReload",l=>{h.value=l});const g=l=>{c.value=l};return(l,w)=>(m(),C("div",gt,[t(c)=="true"?(m(),C("div",vt,[yt,e("div",bt,[e("div",xt,[s(y,{color:"white",icon:"ri-lock-line",size:"50"}),wt,s(Y,{color:"light",class:"mt-4",onClick:w[0]||(w[0]=v=>t(ee).push({path:"/user/timesheet"}))},{default:a(()=>[$(" Back to List ")]),_:1})])])])):z("",!0),s(ht,{id:t(x),onVoid:g},null,8,["id"]),s(Ue,{id:t(x),require:f.require},null,8,["id","require"])]))}};export{qt as default};
