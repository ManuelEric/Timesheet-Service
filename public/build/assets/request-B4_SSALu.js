import{r as i,o as _,f as N,w as t,b as e,am as j,u as s,Y as D,V as h,j as w,m as Y,A as R,s as z,e as E,z as S,W as X,c as x,F as H,X as J,a as r,t as q}from"./main-wqbXnlwX.js";import{r as $}from"./rules-B5G8qOzK.js";import{a as b,V as P}from"./VRow-CaovE9tP.js";import{V as M,a as A,c as G,b as K}from"./VCard-D2x-rsu7.js";import{V as O}from"./VForm-DNqEIkl6.js";import{V as W}from"./VTextarea-BkrJpFiJ.js";import{V as B,a as F}from"./VAutocomplete-DFOWS4Xi.js";import{V as I}from"./VDialog-Dv2r5ud1.js";import{V as Q,a as Z}from"./VTable-YSHjI8dl.js";import{V as ee}from"./VPagination-VKBDAKhj.js";import{V as L}from"./VTooltip-wzb94TmU.js";import"./VAvatar-0Xbu4_hq.js";import"./VImg-CKrPMbH4.js";import"./VList-DDF9bkb-.js";import"./ssrBoot-DGk78_wM.js";import"./VDivider-CLGQpo9M.js";import"./VCheckboxBtn-DnTcfVft.js";import"./VSelectionControl-CJcRzlKD.js";import"./VSlideGroup-BONNnrOW.js";const te={__name:"cancel-request",props:{data:Object},emits:["close","reload"],setup(T,{emit:v}){const m=v,d=T,f=i(!1),V=i(null),p=i({ref_program:d.data.id,cancellation_reason:null}),u=async()=>{const{valid:n}=await V.value.validate();if(n){f.value=!0;try{await R.patch("api/v1/request/"+d.data.id+"/update",p.value)&&(z("success","Request has been successfully cancelled","bottom-end"),m("reload"))}catch(c){console.log(c)}finally{m("close"),f.value=!1}}};return(n,c)=>(_(),N(P,{class:"justify-center"},{default:t(()=>[e(b,{cols:"12"},{default:t(()=>[e(M,{title:"Cancel Your Request",width:"500","prepend-icon":"ri-send-plane-line"},{default:t(()=>[e(A,null,{default:t(()=>[e(O,{onSubmit:j(u,["prevent"]),ref_key:"formData",ref:V,"validate-on":"input"},{default:t(()=>[e(P,null,{default:t(()=>[e(b,{cols:"12"},{default:t(()=>[e(W,{label:"Reason",modelValue:s(p).cancellation_reason,"onUpdate:modelValue":c[0]||(c[0]=k=>s(p).cancellation_reason=k),variant:"solo",rules:s($).required},null,8,["modelValue","rules"])]),_:1})]),_:1}),e(G,{class:"mt-5"},{default:t(()=>[e(D,{color:"error",type:"button",onClick:c[1]||(c[1]=k=>m("close"))},{default:t(()=>[e(h,{icon:"ri-close-line",class:"me-3"}),w(" Close ")]),_:1}),e(Y),e(D,{color:"success",type:"submit"},{default:t(()=>[w(" Save "),e(h,{icon:"ri-save-line",class:"ms-3"})]),_:1})]),_:1})]),_:1},512)]),_:1})]),_:1})]),_:1})]),_:1}))}},le={__name:"new-request",emits:["close","reload"],setup(T,{emit:v}){const m=v,d=i(!1),f=i(null),V=i([]),p=i([]),u=i([]),n=i({clientprog_id:null,invoice_id:null,student_uuid:null,student_name:null,student_school:null,student_grade:null,program_name:null,engagement_type:null,notes:null}),c=async()=>{try{const l=await R.get("api/v1/mentees");l&&(p.value=l)}catch(l){console.log(l)}},k=async()=>{try{const l=await R.get("api/v1/engagement-type/component/list");l&&(V.value=l)}catch(l){console.log(l)}},U=()=>{n.value.clientprog_id=u.value.clientprog_id,n.value.invoice_id=u.value.invoice_id,n.value.student_uuid=u.value.client.uuid,n.value.student_name=u.value.client.first_name+" "+u.value.client.last_name,n.value.student_grade=u.value.client.grade,n.value.student_school=u.value.client.school_name,n.value.program_name=u.value.program_name},y=async()=>{const{valid:l}=await f.value.validate();if(l){d.value=!0;try{await R.post("api/v1/request/create",n.value)&&(z("success","Request has been successfully created","bottom-end"),m("reload"))}catch(a){console.log(a)}finally{m("close"),d.value=!1}}};return E(()=>{c(),k()}),(l,a)=>(_(),N(P,{class:"justify-center"},{default:t(()=>[e(b,{cols:"12"},{default:t(()=>[e(M,{title:"New Request",width:"500","prepend-icon":"ri-send-plane-line"},{default:t(()=>[e(A,null,{default:t(()=>[e(O,{onSubmit:j(y,["prevent"]),ref_key:"formData",ref:f,"validate-on":"input"},{default:t(()=>[e(P,null,{default:t(()=>[e(b,{cols:"12"},{default:t(()=>[e(B,{variant:"solo",clearable:"",modelValue:s(u),"onUpdate:modelValue":[a[0]||(a[0]=o=>S(u)?u.value=o:null),U],label:"Mentee Name",items:s(p),"item-props":o=>{var g,C;return{title:((g=o.client)==null?void 0:g.first_name)+" "+((C=o.client)==null?void 0:C.last_name),subtitle:o.client.school_name}},rules:s($).required,loading:s(d),disabled:s(d)},null,8,["modelValue","items","item-props","rules","loading","disabled"])]),_:1}),e(b,{cols:"12"},{default:t(()=>[e(B,{variant:"solo",clearable:"",modelValue:s(n).engagement_type,"onUpdate:modelValue":a[1]||(a[1]=o=>s(n).engagement_type=o),items:s(V),"item-props":o=>({title:o.name}),"item-value":"id",label:"Program Name",rules:s($).required,loading:s(d),disabled:s(d)},null,8,["modelValue","items","item-props","rules","loading","disabled"])]),_:1}),e(b,{cols:"12"},{default:t(()=>[e(W,{label:"Notes",modelValue:s(n).notes,"onUpdate:modelValue":a[2]||(a[2]=o=>s(n).notes=o),variant:"solo"},null,8,["modelValue"])]),_:1})]),_:1}),e(G,{class:"mt-5"},{default:t(()=>[e(D,{color:"error",type:"button",onClick:a[3]||(a[3]=o=>m("close"))},{default:t(()=>[e(h,{icon:"ri-close-line",class:"me-3"}),w(" Close ")]),_:1}),e(Y),e(D,{color:"success",type:"submit"},{default:t(()=>[w(" Save "),e(h,{icon:"ri-save-line",class:"ms-3"})]),_:1})]),_:1})]),_:1},512)]),_:1})]),_:1})]),_:1})]),_:1}))}},ae=r("div",{class:"d-flex justify-between align-center"},[r("div",{class:"w-100"},[r("h4",null,"Program List")])],-1),se=r("thead",null,[r("tr",null,[r("th",{class:"text-uppercase",width:"1%"}," # "),r("th",{class:"text-uppercase text-center"},"Student"),r("th",{class:"text-uppercase text-center"},"School Name"),r("th",{class:"text-uppercase text-center"},"Program Name"),r("th",{class:"text-uppercase text-center"},"#")])],-1),oe={key:0},ne={key:0},re={key:1},ue={key:1},ie=r("tr",null,[r("td",{colspan:"6",class:"text-center"}," Sorry, no data found. ")],-1),de=[ie],ce={class:"d-flex justify-center mt-5"},Te={__name:"request",setup(T){const v=i(!1),m=i(!1),d=i(!1),f=i(1),V=i(),p=i(),u=i([]),n=i([]),c=async()=>{v.value=!0;try{const y="api/v1/request",l="?page="+f.value,a=p.value?"&keyword="+p.value:"",o=await R.get(y+l+a);o&&(u.value=o,V.value=o.last_page)}catch(y){console.log(y)}finally{v.value=!1}},k=async()=>{f.value=1,await c()},U=y=>{n.value=y,d.value=!0};return E(()=>{c()}),(y,l)=>(_(),N(M,null,{default:t(()=>[e(K,null,{default:t(()=>[ae]),_:1}),e(A,null,{default:t(()=>[e(P,{class:"my-1 justify-space-between"},{default:t(()=>[e(b,{md:"3",cols:"12"},{default:t(()=>[e(X,{label:"Search",density:"compact",modelValue:s(p),"onUpdate:modelValue":l[0]||(l[0]=a=>S(p)?p.value=a:null),variant:"solo","single-line":"",loading:s(v),disabled:s(v),onChange:k},null,8,["modelValue","loading","disabled"])]),_:1}),e(b,{md:"2",cols:"12"},{default:t(()=>[e(D,{density:"compact",color:"info",block:"",border:"",onClick:l[1]||(l[1]=a=>m.value=!0)},{default:t(()=>[w(" New Request "),e(h,{icon:"ri-add-line",class:"ms-3"})]),_:1})]),_:1})]),_:1}),e(I,{modelValue:s(m),"onUpdate:modelValue":l[3]||(l[3]=a=>S(m)?m.value=a:null),width:"auto",persistent:""},{default:t(()=>[e(le,{onClose:l[2]||(l[2]=a=>m.value=!1),onReload:c})]),_:1},8,["modelValue"]),e(I,{modelValue:s(d),"onUpdate:modelValue":l[5]||(l[5]=a=>S(d)?d.value=a:null),width:"auto",persistent:""},{default:t(()=>[e(te,{data:s(n),onClose:l[4]||(l[4]=a=>d.value=!1),onReload:c},null,8,["data"])]),_:1},8,["modelValue"]),s(v)?(_(),N(Q,{key:0,class:"mx-auto border",type:"table-thead, table-row@10"})):(_(),N(Z,{key:1,class:"table-responsive"},{default:t(()=>{var a,o;return[se,((o=(a=s(u))==null?void 0:a.data)==null?void 0:o.length)>0?(_(),x("tbody",oe,[(_(!0),x(H,null,J(s(u).data,(g,C)=>(_(),x("tr",{key:C},[r("th",null,q(parseInt(C)+1),1),r("th",null,q(g.student_name),1),r("th",null,q(g.student_school),1),r("th",null,q(g.engagement_type)+" "+q(g.timesheet_id),1),r("th",null,[g.timesheet_id?(_(),x("div",re,[e(L,{activator:"parent",location:"start"},{default:t(()=>[w("Already Generated Timesheet")]),_:1}),e(F,{color:"success"},{default:t(()=>[e(h,{icon:"ri-check-line",color:"success"})]),_:1})])):(_(),x("div",ne,[e(L,{activator:"parent",location:"start"},{default:t(()=>[w("Cancel Request")]),_:1}),e(F,{class:"cursor-pointer",onClick:j(me=>U(g),["prevent"])},{default:t(()=>[e(h,{icon:"ri-close-line",color:"error"})]),_:2},1032,["onClick"])]))])]))),128))])):(_(),x("tfoot",ue,de))]}),_:1})),r("div",ce,[e(ee,{modelValue:s(f),"onUpdate:modelValue":l[6]||(l[6]=a=>S(f)?f.value=a:null),length:s(V),"total-visible":4,color:"primary",density:"compact","show-first-last-page":!1},null,8,["modelValue","length"])])]),_:1})]),_:1}))}};export{Te as default};
