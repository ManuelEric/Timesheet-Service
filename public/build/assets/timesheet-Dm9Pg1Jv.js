import{a3 as we,r as m,o as _e,e as g,p as L,w as a,b as t,h as e,a as U,f as i,t as P,F as Z,a0 as oe,q as se,j as fe,H as K,V as W,i as S,k as le,l as M,z as ve,A as $,s as ne,W as Pe,a1 as Te,a4 as je,y as Se,n as pe}from"./main-B9R9RoZq.js";import{r as T}from"./rules-CkvmYWH-.js";import{c as de,d as be,V as ce,b as Ce}from"./VCard-CXaGyAhg.js";import{V as ye}from"./VForm-BiEqnpxz.js";import{V as me,a as f}from"./VRow-wI_eo93L.js";import{V as F}from"./VAutocomplete-DF_5WBG6.js";import{V as re}from"./VTooltip-cE0Fmrkm.js";import{V as Ve}from"./VTextarea-CBNR96FG.js";import{V as ke}from"./VDialog-CspqdkAW.js";import{a as he,V as Ue}from"./VTable-CNJS9BWd.js";import{d as Ie}from"./debounce-BNumHCdF.js";import{V as qe}from"./VPagination-U8aLwNaN.js";import{V as Ee}from"./VBadge-DhjGNy-f.js";import"./VAvatar-vDKrtj1J.js";import"./VImg-CbbqUjRu.js";import"./VList-BN1opfz2.js";import"./ssrBoot-CmorPMfO.js";import"./VDivider-CWmxtmoW.js";import"./VCheckboxBtn-D_ZhZnke.js";import"./VSelectionControl-nYMYYKK0.js";import"./VSlideGroup-DtXE-8S1.js";var Ne={BASE_URL:"/build/",DEV:!1,MODE:"production",PROD:!0,SSR:!1,VITE_API_BASE_URL:"https://timesheet.edu-all.com/",VITE_APP_NAME:"EduALL_Timesheet",VITE_PUSHER_APP_CLUSTER:"mt1",VITE_PUSHER_APP_KEY:"",VITE_PUSHER_HOST:"",VITE_PUSHER_PORT:"443",VITE_PUSHER_SCHEME:"https"};const te=we.create({baseURL:Ne.VITE_CRM_DOMAIN,headers:{"Content-Type":"application/json"}});te.interceptors.request.use(y=>y,y=>Promise.reject(y));te.interceptors.response.use(y=>y,y=>{var b;return((b=y==null?void 0:y.response)==null?void 0:b.status)===401&&router.go(0),Promise.reject(y)});const $e={async get(y,b={}){try{return(await te.get(y,b)).data}catch(w){return Promise.reject(w)}},async post(y,b){try{return(await te.post(y,b)).data}catch(w){return Promise.reject(w)}},async patch(y,b){try{return(await te.patch(y,b)).data}catch(w){return Promise.reject(w)}},async put(y,b){try{return(await te.put(y,b)).data}catch(w){return Promise.reject(w)}},async delete(y){try{return(await te.delete(y)).data}catch(b){return Promise.reject(b)}}},Re={key:0,class:"mb-4 d-flex gap-1"},Me={class:"text-sm"},ge="mentor",Fe={__name:"program_add_specialist_timesheet",emits:["close","reload"],setup(y,{emit:b}){const w=b,u=m(!1),_=m([]),J=m([]),z=m([]);m([]);const B=m([]),q=m([]),G=m([]),A=m(!1),ee=m(null),E=m(null),N=m([]),ae=m(),r=m({ref_details:[],mentortutor_email:null,subject_id:null,inhouse_id:null,package_id:null,duration:"",tax:null,individual_fee:null,notes:"",pic_id:[]}),I=async()=>{const d="get/active/mentees/global";try{const p=await $e.get(d);p&&(z.value=p)}catch(p){console.error(p)}},Q=async(d=!1)=>{const R=d?"api/v1/user/mentor-tutors?inhouse=true&role="+ge:"api/v1/user/mentor-tutors?role="+"External Mentor";try{const j=await $.get(R);j&&(d?G.value=Object.values(j):J.value=j)}catch(j){console.error(j)}},o=async()=>{try{const d=await $.get("api/v1/package/component/list?category="+ge);d&&(B.value=d)}catch(d){console.error(d)}},h=()=>{const d=r.value.package_id,p=B.value.findIndex(j=>j.id===d);let R=B.value[p];R.detail?(A.value=!0,r.value.duration=R.detail):(A.value=!1,r.value.duration=null)},Y=async()=>{try{const d=await $.get("api/v1/user/component/list");d&&(q.value=d)}catch(d){console.error(d)}},V=async(d,p=null,R=0)=>{var j,l,c,n;r.value.subject_id=null,ee.value=R,r.value.tax=(R==1,2.5),r.value.subject_id=(l=(j=d[0])==null?void 0:j.subjects[0])==null?void 0:l.id,r.value.individual_fee=(n=(c=d[0])==null?void 0:c.subjects[0])==null?void 0:n.fee_individual,r.value.individual_fee?O():E.value=null},X=async()=>{try{const d=await $.get("api/v1/engagement-type/component/list");d&&(N.value=d)}catch(d){console.log(d)}},v=async()=>{var p,R,j;r.value.mentortutor_email=_.value.email;const{valid:d}=await ae.value.validate();if(d){u.value=!0;try{const l=await $.post("api/v1/timesheet/create/skip-request",r.value);l&&(ne("success",l.message,"bottom-end"),w("reload"),r.value={ref_details:[],mentortutor_email:null,subject_id:null,subject_name:null,inhouse_id:null,package_id:null,duration:"",notes:"",pic_id:[],tax:null,individual_fee:""},_.value=[],window.open("/admin/timesheet/specialist/"+((p=l.data)==null?void 0:p.timesheet_id),"_blank"))}catch(l){if((j=(R=l==null?void 0:l.response)==null?void 0:R.data)!=null&&j.errors){const c=l.response.data.errors;ne("error",c,"bottom-end")}}finally{w("close"),u.value=!1}}},O=()=>{const d=r.value.individual_fee*(1-r.value.tax/100);E.value=Math.trunc(d)},D=()=>{const d=E.value/(1-r.value.tax/100);r.value.individual_fee=Math.trunc(d)};return _e(()=>{I(),X(),Q(),Q(!0),o(),Y()}),(d,p)=>(g(),L(ce,{"max-width":"650","prepend-icon":"ri-send-plane-line",title:"Assign to Subject Specialist"},{default:a(()=>[t(de,null,{default:a(()=>{var R,j;return[((R=e(r).ref_details)==null?void 0:R.length)>0?(g(),U("div",Re,[i("p",Me,P(((j=e(r).ref_details)==null?void 0:j.length)>1?"Students":"Student")+":",1),(g(!0),U(Z,null,oe(e(r).ref_details,l=>(g(),U("p",{key:l,class:"text-sm bg-info px-2 rounded"},P(l.student_first_name+" "+l.student_last_name),1))),128))])):se("",!0),t(ye,{onSubmit:fe(v,["prevent"]),ref_key:"formData",ref:ae,"validate-on":"input"},{default:a(()=>[t(me,null,{default:a(()=>[t(f,{cols:"12"},{default:a(()=>[t(F,{clearable:"",modelValue:e(r).engagement_type,"onUpdate:modelValue":p[0]||(p[0]=l=>e(r).engagement_type=l),items:e(N),"item-props":l=>({title:l.name}),"item-value":"id",label:"Engagement Type",rules:e(T).required,loading:e(u),disabled:e(u)},null,8,["modelValue","items","item-props","rules","loading","disabled"])]),_:1}),t(f,{md:"12",cols:"12"},{default:a(()=>[t(F,{clearable:"",modelValue:e(r).ref_details,"onUpdate:modelValue":p[1]||(p[1]=l=>e(r).ref_details=l),label:"Mentee Name",items:e(z),"item-props":l=>({title:l.first_name+" "+l.last_name,subtitle:l.sch_name,value:{clientprog_id:l.clientprog_id,invoice_id:l.invoice_id,student_uuid:l.id,student_first_name:l.first_name,student_last_name:l.last_name,student_school:l.sch_name,student_grade:l.grade,program_name:l.program_name,require:l.require,package:l.package,curriculum:l.curriculum,engagement_type:e(r).engagement_type}}),rules:e(T).required,loading:e(u),disabled:e(u),density:"compact",multiple:""},null,8,["modelValue","items","item-props","rules","loading","disabled"])]),_:1}),t(f,{md:"12",cols:"12"},{default:a(()=>[t(F,{density:"compact",clearable:"",modelValue:e(_),"onUpdate:modelValue":[p[2]||(p[2]=l=>K(_)?_.value=l:null),p[3]||(p[3]=l=>V(e(_).roles,e(_).uuid,e(_).has_npwp))],label:"Subject Specialist Name",items:e(J),"item-props":l=>({title:l.full_name,subtitle:l.roles.map(c=>c.name).join(", ")}),rules:e(T).required,loading:e(u),disabled:e(u)},null,8,["modelValue","items","item-props","rules","loading","disabled"])]),_:1}),t(f,{md:"8",cols:"8"},{default:a(()=>[t(F,{density:"compact",clearable:"",label:"Package",modelValue:e(r).package_id,"onUpdate:modelValue":[p[4]||(p[4]=l=>e(r).package_id=l),h],items:e(B),"item-props":l=>({title:l.package!=null?l.type_of+" - "+l.package:l.type_of,subtitle:l.detail?l.detail/60+" Hours":"Customizable"}),"item-value":"id",rules:e(T).required,loading:e(u),disabled:e(u)},null,8,["modelValue","items","item-props","rules","loading","disabled"])]),_:1}),t(f,{md:"4",cols:"4"},{default:a(()=>[t(W,{density:"compact",type:"number",clearable:"",label:+e(r).duration/60?""+e(r).duration/60+" Hours":"Minutes",readonly:e(A),modelValue:e(r).duration,"onUpdate:modelValue":p[5]||(p[5]=l=>e(r).duration=l),rules:e(T).required},null,8,["label","readonly","modelValue","rules"])]),_:1}),t(f,{md:"4",cols:"7"},{default:a(()=>[t(W,{type:"number",clearable:"",label:"Fee/hours (Nett)",modelValue:e(E),"onUpdate:modelValue":[p[6]||(p[6]=l=>K(E)?E.value=l:null),D],density:"compact",rules:e(T).required},null,8,["modelValue","rules"])]),_:1}),t(f,{md:"4",cols:"5"},{default:a(()=>[t(W,{type:"number",clearable:"",label:"Tax",modelValue:e(r).tax,"onUpdate:modelValue":[p[7]||(p[7]=l=>e(r).tax=l),D],rules:e(T).required,density:"compact"},null,8,["modelValue","rules"])]),_:1}),t(f,{md:"4",cols:"12"},{default:a(()=>[t(re,{activator:"parent",location:"top"},{default:a(()=>[S(" Fee Gross is automatically calculated based on the entered Net Fee and Tax Rate. ")]),_:1}),t(W,{type:"number",clearable:"",label:"Fee/hours (Gross)",modelValue:e(r).individual_fee,"onUpdate:modelValue":[p[8]||(p[8]=l=>e(r).individual_fee=l),O],density:"compact",readonly:"",rules:e(T).required},null,8,["modelValue","rules"])]),_:1}),t(f,{md:"6",cols:"12"},{default:a(()=>[t(F,{density:"compact",clearable:"",modelValue:e(r).inhouse_id,"onUpdate:modelValue":p[9]||(p[9]=l=>e(r).inhouse_id=l),label:"Inhouse Mentor",items:e(G),"item-props":l=>({title:l.full_name}),"item-value":"uuid",loading:e(u),disabled:e(u),rules:e(T).required},null,8,["modelValue","items","item-props","loading","disabled","rules"])]),_:1}),t(f,{md:"6",cols:"12"},{default:a(()=>[t(F,{density:"compact",multiple:"",clearable:"",chips:"",label:"PIC",modelValue:e(r).pic_id,"onUpdate:modelValue":p[10]||(p[10]=l=>e(r).pic_id=l),items:e(q),"item-title":"full_name","item-value":"id",loading:e(u),disabled:e(u),rules:e(T).required},null,8,["modelValue","items","loading","disabled","rules"])]),_:1}),t(f,{md:"12"},{default:a(()=>[t(Ve,{label:"Notes",modelValue:e(r).notes,"onUpdate:modelValue":p[11]||(p[11]=l=>e(r).notes=l)},null,8,["modelValue"])]),_:1})]),_:1}),t(be,{class:"mt-5 px-0"},{default:a(()=>[t(le,{variant:"tonal",color:"error",type:"button",onClick:p[12]||(p[12]=l=>w("close"))},{default:a(()=>[t(M,{icon:"ri-close-line",class:"me-3"}),S(" Close ")]),_:1}),t(ve),t(le,{variant:"tonal",color:"success",type:"submit"},{default:a(()=>[S(" Save "),t(M,{icon:"ri-save-line",class:"ms-3"})]),_:1})]),_:1})]),_:1},512)]}),_:1})]),_:1}))}},Ae={key:0,class:"mb-4 d-flex gap-1"},De={class:"text-sm"},He={class:"d-flex justify-between align-center mb-3"},Le=i("h4",{class:"w-100"},"Detail",-1),Be=i("thead",null,[i("tr",null,[i("th",{class:"text-left",nowrap:""}," Subject Tutoring "),i("th",{nowrap:""},"Grade"),i("th",{nowrap:""},"Year"),i("th",{nowrap:""},"Fee Individual - Gross")])],-1),Ge={nowrap:""},Oe={nowrap:""},ze={nowrap:""},Ye={nowrap:""},Ke={__name:"program_add_tutoring",emits:["close","reload"],setup(y,{emit:b}){const w=b,u=m(!1),_=m(null),J=m([]),z=m([]),B=m([]),q=m([]),G=m([]),A=m([]),ee=m([]),E=m(!1),N=m("tutor"),ae=m(null),r=m(null),I=m([]),Q=m(),o=m({ref_id:null,mentortutor_email:null,subject_id:null,inhouse_id:null,package_id:null,tax:null,individual_fee:null,duration:"",notes:"",pic_id:[],curriculum_id:null}),h=async()=>{var n,x;const c="api/v1/program/list";try{u.value=!0;const k=await $.get(c);k&&(J.value=k),u.value=!1}catch(k){ne("error",(x=(n=k.response)==null?void 0:n.data)==null?void 0:x.message,"bottom-end"),console.error(k),u.value=!1}},Y=async(c=!1)=>{const n=c?"api/v1/user/mentor-tutors?inhouse=true&role="+N.value:"api/v1/user/mentor-tutors?role="+N.value;try{const x=await $.get(n);x&&(c?ee.value=Object.values(x):z.value=x)}catch(x){console.error(x)}},V=async()=>{try{const c=await $.get("api/v1/package/component/list?category="+N.value);c&&(G.value=c)}catch(c){console.error(c)}},X=()=>{const c=o.value.package_id,n=G.value.findIndex(k=>k.id===c);let x=G.value[n];x.detail?(E.value=!0,o.value.duration=x.detail):(E.value=!1,o.value.duration=null)},v=async()=>{try{const c=await $.get("api/v1/user/component/list");c&&(A.value=c)}catch(c){console.error(c)}},O=async(c,n=null,x=0)=>{if(ae.value=x,o.value.tax=(x==1,2.5),o.value.subject_id=null,N.value=="mentor")o.value.subject_id=c[0].subjects[0].id;else try{const k=await $.get("api/v1/user/mentor-tutors/"+n+"/subjects");k&&(q.value=k)}catch(k){console.error(k)}},D=async(c,n,x)=>{if(n)try{const k=await $.get("api/v1/component/fee/"+c+"/"+n+"/"+x);k&&(o.value.individual_fee=k.fee_individual,k.fee_individual?j():r.value=null)}catch(k){console.error(k)}},d=async()=>{try{const c=await $.get("api/v1/curriculum/component/list");c&&(B.value=c)}catch(c){console.error(c)}},p=async()=>{var n,x,k;o.value.mentortutor_email=_.value.email;const{valid:c}=await Q.value.validate();if(c){u.value=!0;try{const H=await $.post("api/v1/timesheet/create",o.value);H&&(ne("success",H.message,"bottom-end"),w("reload"),o.value={ref_id:[],mentortutor_email:null,subject_id:null,subject_name:null,inhouse_id:null,package_id:null,duration:"",notes:"",pic_id:[],tax:null,individual_fee:"",curriculum_id:null},_.value=null,window.open("/admin/timesheet/tutoring/"+((n=H.data)==null?void 0:n.timesheet_id),"_blank"))}catch(H){if(console.log(H),(k=(x=H==null?void 0:H.response)==null?void 0:x.data)!=null&&k.errors){const s=H.response.data.errors;ne("error",s,"bottom-end")}}finally{w("close"),u.value=!1}}},R=()=>{o.value={ref_id:I.value.map(c=>c.id),curriculum_id:I.value[0].curriculum??null,package_id:I.value[0].package??null,program_name:I.value[0].program_name??null}},j=()=>{const c=o.value.individual_fee*(1-o.value.tax/100);r.value=Math.trunc(c)},l=()=>{const c=r.value/(1-o.value.tax/100);o.value.individual_fee=Math.trunc(c)};return _e(()=>{h(),Y(),Y(!0),V(),v(),d()}),(c,n)=>{var x;return g(),L(ce,{"max-width":"650","prepend-icon":"ri-send-plane-line",title:((x=e(I)[0])==null?void 0:x.program_name)??"Assign to Tutor"},{default:a(()=>[t(de,null,{default:a(()=>{var k,H;return[((k=e(I))==null?void 0:k.length)>0?(g(),U("div",Ae,[i("p",De,P(((H=e(I))==null?void 0:H.length)>1?"Students":"Student")+":",1),(g(!0),U(Z,null,oe(e(I),s=>(g(),U("p",{key:s,class:"text-sm bg-info px-2 rounded"},P(s.mentee),1))),128))])):se("",!0),t(ye,{onSubmit:fe(p,["prevent"]),ref_key:"formData",ref:Q,"validate-on":"input"},{default:a(()=>[t(me,null,{default:a(()=>[t(f,{md:"12",cols:"12"},{default:a(()=>[t(F,{clearable:"",modelValue:e(I),"onUpdate:modelValue":[n[0]||(n[0]=s=>K(I)?I.value=s:null),R],label:"Mentee Name",items:e(J),"item-props":s=>({title:s.student_name,subtitle:s.program_name+(s.timesheet_id?" ✅":"")+(s.scnd_timesheet_id?" ✅":""),disabled:s.timesheet_id&&s.scnd_timesheet_id,value:{id:s.id,require:s.require,mentee:s.student_name,package:s.package,curriculum:s.curriculum,program_name:s.program_name}}),rules:e(T).required,loading:e(u),disabled:e(u),density:"compact",multiple:""},null,8,["modelValue","items","item-props","rules","loading","disabled"])]),_:1}),t(f,{cols:e(_)?11:12},{default:a(()=>[t(F,{clearable:"",modelValue:e(_),"onUpdate:modelValue":[n[1]||(n[1]=s=>K(_)?_.value=s:null),n[2]||(n[2]=s=>O(e(_).roles,e(_).uuid,e(_).has_npwp))],label:"Tutor Name",items:e(z),"item-props":s=>({title:s.full_name,subtitle:s.roles.map(C=>C.name).join(", ")}),rules:e(T).required,loading:e(u),disabled:e(u),density:"compact"},null,8,["modelValue","items","item-props","rules","loading","disabled"])]),_:1},8,["cols"]),e(_)?(g(),L(f,{key:0,cols:"1"},{default:a(()=>[t(ke,{"max-width":"600"},{activator:a(({props:s})=>[t(re,{activator:"parent",location:"end"},{default:a(()=>[S("Fee Detail")]),_:1}),t(M,Pe({icon:"ri-folder-info-line",class:"cursor-pointer mt-3"},s),null,16)]),default:a(({isActive:s})=>[t(ce,null,{default:a(()=>[t(de,{class:"py-5"},{default:a(()=>{var C;return[i("div",He,[Le,t(le,{size:"x-small",color:"secondary",icon:"ri-close-line",onClick:ie=>s.value=!1},null,8,["onClick"])]),((C=e(_))==null?void 0:C.roles.findIndex(ie=>ie.name==="Tutor"))>=0?(g(),L(he,{key:0,density:"compact"},{default:a(()=>[Be,i("tbody",null,[(g(!0),U(Z,null,oe(e(_).roles,(ie,xe)=>(g(),U(Z,{key:xe},[ie.name=="Tutor"?(g(!0),U(Z,{key:0},oe(ie.subjects,ue=>(g(),U("tr",{key:ue},[i("td",Ge,P(ue.tutor_subject),1),i("td",Oe,P(ue.grade),1),i("td",ze,P(ue.year),1),i("td",Ye,"Rp. "+P(new Intl.NumberFormat("id-ID").format(ue.fee_individual)),1)]))),128)):se("",!0)],64))),128))])]),_:1})):(g(),L(de,{key:1,class:"text-center"},{default:a(()=>[S(" There is no tutoring subject ")]),_:1}))]}),_:2},1024)]),_:2},1024)]),_:1})]),_:1})):se("",!0),t(f,{md:"6",cols:"6"},{default:a(()=>{var s;return[t(F,{clearable:"",modelValue:e(o).curriculum_id,"onUpdate:modelValue":[n[3]||(n[3]=C=>e(o).curriculum_id=C),n[4]||(n[4]=C=>D(e(_).id,e(o).subject_name,e(o).curriculum_id))],label:"Curriculum",items:e(B),"item-props":C=>({title:C.name}),rules:e(T).required,loading:e(u),disabled:e(u)||((s=e(I)[0])==null?void 0:s.curriculum),density:"compact","item-value":"id"},null,8,["modelValue","items","item-props","rules","loading","disabled"])]}),_:1}),t(f,{md:"6",cols:"6"},{default:a(()=>[t(F,{clearable:"",modelValue:e(o).subject_name,"onUpdate:modelValue":[n[5]||(n[5]=s=>e(o).subject_name=s),n[6]||(n[6]=s=>D(e(_).id,e(o).subject_name,e(o).curriculum_id))],label:"Subject Tutoring",items:e(q),loading:e(u),disabled:e(u),rules:e(T).required,density:"compact"},null,8,["modelValue","items","loading","disabled","rules"])]),_:1}),t(f,{md:"8",cols:"8"},{default:a(()=>{var s;return[t(F,{clearable:"",label:"Package",modelValue:e(o).package_id,"onUpdate:modelValue":[n[7]||(n[7]=C=>e(o).package_id=C),X],items:e(G),density:"compact","item-props":C=>({title:C.package!=null?C.type_of+" - "+C.package:C.type_of,subtitle:C.detail?C.detail/60+" Hours":"Customizable"}),"item-value":"id",rules:e(T).required,loading:e(u),disabled:e(u)||((s=e(I)[0])==null?void 0:s.package)},null,8,["modelValue","items","item-props","rules","loading","disabled"])]}),_:1}),t(f,{md:"4",cols:"4"},{default:a(()=>[t(W,{type:"number",clearable:"",label:+e(o).duration/60?"Minutes ("+e(o).duration/60+" Hours)":"Minutes",readonly:e(E),modelValue:e(o).duration,"onUpdate:modelValue":n[8]||(n[8]=s=>e(o).duration=s),density:"compact",rules:e(T).required},null,8,["label","readonly","modelValue","rules"])]),_:1}),t(f,{md:"4",cols:"7"},{default:a(()=>[t(W,{type:"number",clearable:"",label:"Fee/hours (Nett)",modelValue:e(r),"onUpdate:modelValue":[n[9]||(n[9]=s=>K(r)?r.value=s:null),l],density:"compact",rules:e(T).required},null,8,["modelValue","rules"])]),_:1}),t(f,{md:"4",cols:"5"},{default:a(()=>[t(W,{type:"number",clearable:"",label:"Tax",modelValue:e(o).tax,"onUpdate:modelValue":[n[10]||(n[10]=s=>e(o).tax=s),l],rules:e(T).required,density:"compact"},null,8,["modelValue","rules"])]),_:1}),t(f,{md:"4",cols:"12"},{default:a(()=>[t(re,{activator:"parent",location:"top"},{default:a(()=>[S(" Fee Gross is automatically calculated based on the entered Net Fee and Tax Rate. ")]),_:1}),t(W,{type:"number",clearable:"",label:"Fee/hours (Gross)",modelValue:e(o).individual_fee,"onUpdate:modelValue":[n[11]||(n[11]=s=>e(o).individual_fee=s),j],density:"compact",readonly:"",rules:e(T).required},null,8,["modelValue","rules"])]),_:1}),t(f,{md:"6",cols:"6"},{default:a(()=>[t(F,{clearable:"",modelValue:e(o).inhouse_id,"onUpdate:modelValue":n[12]||(n[12]=s=>e(o).inhouse_id=s),label:"Inhouse Mentor/Tutor",items:e(ee),density:"compact","item-props":s=>({title:s.full_name}),"item-value":"uuid",loading:e(u),disabled:e(u),rules:e(T).required},null,8,["modelValue","items","item-props","loading","disabled","rules"])]),_:1}),t(f,{md:"6",cols:"6"},{default:a(()=>[t(F,{multiple:"",clearable:"",chips:"",label:"PIC",modelValue:e(o).pic_id,"onUpdate:modelValue":n[13]||(n[13]=s=>e(o).pic_id=s),items:e(A),"item-title":"full_name","item-value":"id",loading:e(u),density:"compact",disabled:e(u),rules:e(T).required},null,8,["modelValue","items","loading","disabled","rules"])]),_:1}),t(f,{md:"12"},{default:a(()=>[t(Ve,{label:"Notes",modelValue:e(o).notes,"onUpdate:modelValue":n[14]||(n[14]=s=>e(o).notes=s),density:"compact"},null,8,["modelValue"])]),_:1})]),_:1}),t(be,{class:"mt-5 px-0"},{default:a(()=>[t(le,{variant:"tonal",color:"error",type:"button",onClick:n[15]||(n[15]=s=>w("close"))},{default:a(()=>[t(M,{icon:"ri-close-line",class:"me-3"}),S(" Close ")]),_:1}),t(ve),t(le,{variant:"tonal",color:"success",type:"submit"},{default:a(()=>[S(" Save "),t(M,{icon:"ri-save-line",class:"ms-3"})]),_:1})]),_:1})]),_:1},512)]}),_:1})]),_:1},8,["title"])}}},We=i("div",{class:"d-flex justify-between align-center"},[i("div",{class:"w-100"},[i("h4",null,"Timesheet List")])],-1),Je={class:"d-flex gap-2"},Qe=i("th",{class:"text-uppercase",width:"1%"}," No ",-1),Xe=i("th",{class:"text-uppercase text-center"},"School/Student Name",-1),Ze={class:"text-uppercase text-center"},et=i("th",{class:"text-uppercase text-center"},"Package",-1),tt=i("th",{class:"text-uppercase text-center"},"Tutor/Mentor",-1),lt=i("th",{class:"text-uppercase text-center"},"PIC",-1),at=i("th",{class:"text-uppercase text-center"},"Total Hours",-1),ot=i("th",{class:"text-uppercase text-center"},"Used",-1),st=i("th",{class:"text-uppercase text-center"},"#",-1),nt=["onClick"],rt={key:0},it={key:1},ut={class:"text-start"},dt={class:"text-left"},ct={class:"text-left"},mt={class:"text-left"},pt={class:"text-left"},_t={key:0},gt=i("tr",null,[i("td",{colspan:"9",class:"text-center"}," Sorry, no data found. ")],-1),ft=[gt],vt={class:"d-flex justify-center mt-5"},At={__name:"timesheet",props:{name:String},setup(y){const b=y,w=je();m([]);const u=m(!1),_=m(1),J=m(),z=m(),B=m([]),q=m(!1),G=m([]),A=m(),ee=m([]),E=m(),N=async()=>{var O,D;const o="?page="+_.value,h=z.value?"&keyword="+z.value:"",Y=A.value?"&program_name="+encodeURIComponent(A.value):"",V=E.value?"&package_id="+E.value:"",X="&paginate=true",v=b.name!="tutoring"?"&is_subject_specialist=true":"";try{q.value=!0;const d=await $.get("api/v1/timesheet/list"+o+h+Y+V+X+v);d&&(_.value=d.current_page,J.value=d.last_page,B.value=d),q.value=!1}catch(d){ne("error",(D=(O=d.response)==null?void 0:O.data)==null?void 0:D.message,"bottom-end"),console.error(d),q.value=!1}},ae=async()=>{try{const o=await $.get("api/v1/program/component/list");o&&(G.value=o)}catch(o){console.error(o)}},r=async()=>{try{const o=await $.get("api/v1/package/component/list");o&&(ee.value=o)}catch(o){console.error(o)}},I=Ie(async o=>{_.value=1,z.value=o.target.value,await N()},1e3),Q=o=>{const h=w.resolve("/admin/timesheet/"+b.name+"/"+o);window.open(h.href,"_blank")};return Te(()=>{N()}),_e(()=>{N(),ae(),r()}),(o,h)=>{const Y=Se("VText");return g(),U(Z,null,[t(ke,{modelValue:e(u),"onUpdate:modelValue":h[2]||(h[2]=V=>K(u)?u.value=V:null),width:"auto",persistent:""},{default:a(()=>[b.name=="tutoring"?(g(),L(Ke,{key:0,onClose:h[0]||(h[0]=V=>u.value=!1),onReload:N})):(g(),L(Fe,{key:1,onClose:h[1]||(h[1]=V=>u.value=!1),onReload:N}))]),_:1},8,["modelValue"]),t(ce,null,{default:a(()=>[t(Ce,null,{default:a(()=>[We]),_:1}),t(de,null,{default:a(()=>[t(me,{class:"my-1 justify-space-between"},{default:a(()=>[b.name=="tutoring"?(g(),L(f,{key:0,cols:"12",md:"6"},{default:a(()=>[t(me,null,{default:a(()=>[t(f,{cols:"12",md:"6"},{default:a(()=>[t(F,{density:"compact",clearable:"",modelValue:e(A),"onUpdate:modelValue":[h[3]||(h[3]=V=>K(A)?A.value=V:null),N],label:"Program Name",items:e(G),"item-title":"program_name",placeholder:"Select Program Name",loading:e(q),disabled:e(q)},null,8,["modelValue","items","loading","disabled"])]),_:1}),t(f,{cols:"12",md:"6"},{default:a(()=>[t(F,{density:"compact",clearable:"true",modelValue:e(E),"onUpdate:modelValue":[h[4]||(h[4]=V=>K(E)?E.value=V:null),N],label:"Package",items:e(ee),"item-props":V=>({title:V.package!=null?V.type_of+" - "+V.package:V.type_of}),"item-value":"id",placeholder:"Select Package",loading:e(q),disabled:e(q)},null,8,["modelValue","items","item-props","loading","disabled"])]),_:1})]),_:1})]),_:1})):se("",!0),t(f,{cols:"12",md:b.name=="tutoring"?3:12},{default:a(()=>[i("div",Je,[t(W,{density:"compact",loading:e(q),disabled:e(q),"append-inner-icon":"ri-search-line",label:"Search","hide-details":"","single-line":"",onInput:e(I)},null,8,["loading","disabled","onInput"]),i("div",{class:pe(["text-end",b.name=="tutoring"?"":"w-md-75"])},[t(re,{activator:"parent",location:"start"},{default:a(()=>[S("Add New Timesheet")]),_:1}),t(le,{icon:"ri-add-line",onClick:h[5]||(h[5]=V=>u.value=!0)})],2)])]),_:1},8,["md"])]),_:1}),e(q)?(g(),L(Ue,{key:0,class:"mx-auto border",type:"table-thead, table-row@10"})):(g(),L(he,{key:1,class:"text-no-wrap",hover:""},{default:a(()=>{var V,X;return[i("thead",null,[i("tr",null,[Qe,Xe,i("th",Ze,P(b.name=="tutoring"?"Program Name":"Engagement Type"),1),et,tt,lt,at,ot,st])]),i("tbody",null,[(g(!0),U(Z,null,oe(e(B).data,(v,O)=>(g(),U("tr",{key:O,class:pe([v.void=="true"?"bg-secondary":"","cursor-pointer"]),onClick:D=>Q(v.id)},[i("td",null,P(parseInt(O)+1),1),i("td",{class:pe(v.group?"cursor-pointer text-left":"text-left")},[v.group?(g(),L(Y,{key:0},{default:a(()=>[t(M,{icon:"ri-group-line",class:"me-3"}),S(" "+P(v.clients[0])+" ",1),t(Ee,{color:"error",content:v.clients.length-1+"+",inline:""},null,8,["content"]),t(re,{activator:"parent",location:"top",transition:"scroll-y-transition",class:"bg-white"},{default:a(()=>[(g(!0),U(Z,null,oe(v.clients,D=>(g(),U("div",null,P(D),1))),256))]),_:2},1024)]),_:2},1024)):(g(),L(Y,{key:1},{default:a(()=>[t(M,{icon:"ri-user-line",class:"me-3"}),S(" "+P(v.clients),1)]),_:2},1024))],2),b.name=="tutoring"?(g(),U("td",rt,[t(M,{icon:"ri-bookmark-3-line",class:"me-3"}),S(" "+P(v.detail_package=="Trial"?"[TRIAL]":"")+" "+P(v.program_name),1)])):(g(),U("td",it,[t(M,{icon:"ri-bookmark-3-line",class:"me-3"}),S(" "+P(v.engagement_type),1)])),i("td",ut,[t(M,{icon:"ri-bookmark-line",class:"me-3"}),S(" "+P(v.detail_package?v.package_type+" - "+v.detail_package:v.package_type),1)]),i("td",dt,[t(M,{icon:"ri-user-line",class:"me-3"}),S(" "+P(v.tutor_mentor),1)]),i("td",ct,[t(M,{icon:"ri-user-line",class:"cursor-pointer me-3"}),S(" "+P(v.admin),1)]),i("td",mt,[t(M,{icon:"ri-calendar-schedule-line",class:"cursor-pointer me-3"}),S(" "+P(v.duration/60)+" Hours ",1)]),i("td",pt,[t(M,{icon:"ri-timer-2-line",class:"cursor-pointer me-3"}),S(" "+P(v.spent/60)+" Hours ",1)]),i("td",null,[t(le,{color:v.void=="true"?"light":"secondary",onClick:D=>Q(v.id)},{default:a(()=>[t(M,{icon:"ri-timeline-view",class:"cursor-pointer"}),t(re,{activator:"parent",location:"top",transition:"scroll-y-transition"},{default:a(()=>[S(" View Detail ")]),_:1})]),_:2},1032,["color","onClick"])])],10,nt))),128))]),((X=(V=e(B))==null?void 0:V.data)==null?void 0:X.length)==0?(g(),U("tfoot",_t,ft)):se("",!0)]}),_:1})),i("div",vt,[t(qe,{modelValue:e(_),"onUpdate:modelValue":[h[6]||(h[6]=V=>K(_)?_.value=V:null),N],length:e(J),"total-visible":4,color:"primary","show-first-last-page":!1},null,8,["modelValue","length"])])]),_:1})]),_:1})],64)}}};export{At as default};
