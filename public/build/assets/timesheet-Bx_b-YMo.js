import{r as d,e as le,o as f,f as $,w as r,b as l,Z as re,u as e,z,V as k,a as n,t as b,h as G,W as O,Y,j as V,m as ne,A as x,s as X,$ as ie,c as j,F as Z,a0 as ue,l as de,X as ee,n as te}from"./main-tdFVgTs1.js";import{r as w}from"./rules-CkvmYWH-.js";import{a as ae,c as ce,V as oe,b as me}from"./VCard-DZqiDdp7.js";import{V as pe}from"./VForm-BJZdvncB.js";import{V as K,a as v}from"./VRow-DKtJi672.js";import{V as P}from"./VAutocomplete-Jww6c2Gt.js";import{V as _e}from"./VAlert-CsM2ewwc.js";import{V as ge}from"./VTextarea-xSY6r49v.js";import{d as fe}from"./debounce-aJaDYXjf.js";import{V as ve}from"./VDialog-BpbC6Etv.js";import{V as J}from"./VTooltip-BIKd8n37.js";import{a as be,V as ye}from"./VTable-DImXhjXw.js";import{V as Ve}from"./VPagination-CbHGtoo6.js";import{V as ke}from"./VBadge-DOnHaCx6.js";import"./VAvatar-1SDOXhCm.js";import"./VImg-CloLWMSP.js";import"./VList-DQYwWQxY.js";import"./ssrBoot-CYIs_Rrw.js";import"./VDivider-CdrvwV06.js";import"./VCheckboxBtn-C4CbdnZ9.js";import"./VSelectionControl-HThYxuTF.js";import"./VSlideGroup-CDl6l8VU.js";const he={__name:"program_add_tutoring",emits:["close","reload"],setup(Q,{emit:U}){const R=U,i=d(!1),g=d([]),H=d([]),A=d([]),D=d([]),y=d([]),I=d([]),N=d([]),L=d([]),T=d(!1),h=d("tutor"),M=d(null),E=d(),o=d({ref_id:null,mentortutor_email:null,subject_id:null,inhouse_id:null,package_id:null,tax:null,individual_fee:null,duration:"",notes:"",pic_id:[],curriculum_id:null}),W=async()=>{var a,t;const s="api/v1/program/list";try{i.value=!0;const c=await x.get(s);c&&(H.value=c),i.value=!1}catch(c){X("error",(t=(a=c.response)==null?void 0:a.data)==null?void 0:t.message,"bottom-end"),console.error(c),i.value=!1}},p=async(s=!1)=>{const a=s?"api/v1/user/mentor-tutors?inhouse=true&role="+h.value:"api/v1/user/mentor-tutors?role="+h.value;try{const t=await x.get(a);t&&(s?L.value=Object.values(t):A.value=t)}catch(t){console.error(t)}},_=async()=>{try{const s=await x.get("api/v1/package/component/list?category="+h.value);s&&(I.value=s)}catch(s){console.error(s)}},B=()=>{const s=o.value.package_id,a=I.value.findIndex(c=>c.id===s);let t=I.value[a];t.detail?(T.value=!0,o.value.duration=t.detail):(T.value=!1,o.value.duration=null)},m=async()=>{try{const s=await x.get("api/v1/user/component/list");s&&(N.value=s)}catch(s){console.error(s)}},F=async(s,a=null,t=0)=>{if(M.value=t,o.value.tax=t==1?2.5:3,o.value.subject_id=null,h.value=="mentor")o.value.subject_id=s[0].subjects[0].id;else try{const c=await x.get("api/v1/user/mentor-tutors/"+a+"/subjects");c&&(y.value=c)}catch(c){console.error(c)}},u=async(s,a,t)=>{try{const c=await x.get("api/v1/component/fee/"+s+"/"+a+"/"+t);c&&(o.value.individual_fee=c.fee_individual)}catch(c){console.error(c)}},q=async()=>{try{const s=await x.get("api/v1/curriculum/component/list");s&&(D.value=s)}catch(s){console.error(s)}},S=async()=>{var a,t,c;o.value.mentortutor_email=g.value.email;const{valid:s}=await E.value.validate();if(s){i.value=!0;try{const C=await x.post("api/v1/timesheet/create",o.value);C&&(X("success",C.message,"bottom-end"),R("reload"),selected.value=[],o.value={ref_id:[],mentortutor_email:null,subject_id:null,subject_name:null,inhouse_id:null,package_id:null,duration:"",notes:"",pic_id:[],tax:null,individual_fee:""},g.value=[],window.open("/admin/timesheet/tutoring/"+((a=C.data)==null?void 0:a.timesheet_id),"_blank"))}catch(C){if(console.log(C),(c=(t=C==null?void 0:C.response)==null?void 0:t.data)!=null&&c.errors){const se=C.response.data.errors;X("error",se,"bottom-end")}}finally{R("close"),i.value=!1}}};return le(()=>{W(),p(),p(!0),_(),m(),q()}),(s,a)=>(f(),$(oe,{"max-width":"650","prepend-icon":"ri-send-plane-line",title:"Assign to Tutor"},{default:r(()=>[l(ae,null,{default:r(()=>[l(pe,{onSubmit:re(S,["prevent"]),ref_key:"formData",ref:E,"validate-on":"input"},{default:r(()=>[l(K,null,{default:r(()=>[l(v,{md:"12"},{default:r(()=>[l(P,{clearable:"",modelValue:e(o).ref_id,"onUpdate:modelValue":a[0]||(a[0]=t=>e(o).ref_id=t),label:"Mentee Name",items:e(H),"item-props":t=>({title:t.student_name,subtitle:t.program_name+(t.timesheet_id?" ✅":"")+(t.scnd_timesheet_id?" ✅":"")}),"item-value":"id",rules:e(w).required,loading:e(i),disabled:e(i),density:"compact",multiple:""},null,8,["modelValue","items","item-props","rules","loading","disabled"])]),_:1}),l(v,{md:"12"},{default:r(()=>[l(P,{clearable:"",modelValue:e(g),"onUpdate:modelValue":[a[1]||(a[1]=t=>z(g)?g.value=t:null),a[2]||(a[2]=t=>F(e(g).roles,e(g).uuid,e(g).has_npwp))],label:"Tutor Name",items:e(A),"item-props":t=>({title:t.full_name,subtitle:t.roles.map(c=>c.name).join(", ")}),rules:e(w).required,loading:e(i),disabled:e(i),density:"compact"},null,8,["modelValue","items","item-props","rules","loading","disabled"]),e(M)!=null?(f(),$(_e,{key:0,color:e(M)==1?"success":"error",class:"py-1 mt-2"},{default:r(()=>[l(k,{icon:"ri-error-warning-line",class:"mr-2"}),n("small",null," Tutor "+b(e(M)==1?"already":"don`t")+" have NPWP ",1)]),_:1},8,["color"])):G("",!0)]),_:1}),l(v,{md:"6",cols:"12"},{default:r(()=>[l(P,{clearable:"",modelValue:e(o).curriculum_id,"onUpdate:modelValue":a[3]||(a[3]=t=>e(o).curriculum_id=t),label:"Curriculum",items:e(D),"item-props":t=>({title:t.name}),rules:e(w).required,loading:e(i),disabled:e(i),density:"compact","item-value":"id"},null,8,["modelValue","items","item-props","rules","loading","disabled"])]),_:1}),l(v,{md:"6",cols:"12"},{default:r(()=>[l(P,{clearable:"",modelValue:e(o).subject_name,"onUpdate:modelValue":[a[4]||(a[4]=t=>e(o).subject_name=t),a[5]||(a[5]=t=>u(e(g).id,e(o).subject_name,e(o).curriculum_id))],label:"Subject Tutoring",items:e(y),loading:e(i),disabled:e(i),rules:e(w).required,density:"compact"},null,8,["modelValue","items","loading","disabled","rules"])]),_:1}),l(v,{md:"8",col:"12"},{default:r(()=>[l(P,{clearable:"",label:"Package",modelValue:e(o).package_id,"onUpdate:modelValue":[a[6]||(a[6]=t=>e(o).package_id=t),B],items:e(I),density:"compact","item-props":t=>({title:t.package!=null?t.type_of+" - "+t.package:t.type_of,subtitle:t.detail?t.detail/60+" Hours":"Customizable"}),"item-value":"id",rules:e(w).required,loading:e(i),disabled:e(i)},null,8,["modelValue","items","item-props","rules","loading","disabled"])]),_:1}),l(v,{md:"4",cols:"12"},{default:r(()=>[l(O,{type:"number",clearable:"",label:+e(o).duration/60?"Minutes ("+e(o).duration/60+" Hours)":"Minutes",readonly:e(T),modelValue:e(o).duration,"onUpdate:modelValue":a[7]||(a[7]=t=>e(o).duration=t),density:"compact",rules:e(w).required},null,8,["label","readonly","modelValue","rules"])]),_:1}),l(v,{md:"7",cols:"12"},{default:r(()=>[l(O,{type:"number",clearable:"",label:"Fee/hours (Gross)",modelValue:e(o).individual_fee,"onUpdate:modelValue":a[8]||(a[8]=t=>e(o).individual_fee=t),density:"compact",rules:e(w).required},null,8,["modelValue","rules"])]),_:1}),l(v,{md:"5",cols:"12"},{default:r(()=>[l(O,{type:"number",clearable:"",label:"Tax",modelValue:e(o).tax,"onUpdate:modelValue":a[9]||(a[9]=t=>e(o).tax=t),rules:e(w).required,density:"compact"},null,8,["modelValue","rules"])]),_:1}),l(v,{md:"6",col:"12"},{default:r(()=>[l(P,{clearable:"",modelValue:e(o).inhouse_id,"onUpdate:modelValue":a[10]||(a[10]=t=>e(o).inhouse_id=t),label:"Inhouse Mentor/Tutor",items:e(L),density:"compact","item-props":t=>({title:t.full_name}),"item-value":"uuid",loading:e(i),disabled:e(i),rules:e(w).required},null,8,["modelValue","items","item-props","loading","disabled","rules"])]),_:1}),l(v,{md:"6",cols:"12"},{default:r(()=>[l(P,{multiple:"",clearable:"",chips:"",label:"PIC",modelValue:e(o).pic_id,"onUpdate:modelValue":a[11]||(a[11]=t=>e(o).pic_id=t),items:e(N),"item-title":"full_name","item-value":"id",loading:e(i),density:"compact",disabled:e(i),rules:e(w).required},null,8,["modelValue","items","loading","disabled","rules"])]),_:1}),l(v,{md:"12"},{default:r(()=>[l(ge,{label:"Notes",modelValue:e(o).notes,"onUpdate:modelValue":a[12]||(a[12]=t=>e(o).notes=t),density:"compact"},null,8,["modelValue"])]),_:1})]),_:1}),l(ce,{class:"mt-5 px-0"},{default:r(()=>[l(Y,{variant:"tonal",color:"error",type:"button",onClick:a[13]||(a[13]=t=>R("close"))},{default:r(()=>[l(k,{icon:"ri-close-line",class:"me-3"}),V(" Close ")]),_:1}),l(ne),l(Y,{variant:"tonal",color:"success",type:"submit"},{default:r(()=>[V(" Save "),l(k,{icon:"ri-save-line",class:"ms-3"})]),_:1})]),_:1})]),_:1},512)]),_:1})]),_:1}))}},xe=n("div",{class:"d-flex justify-between align-center"},[n("div",{class:"w-100"},[n("h4",null,"Timesheet List")])],-1),we={class:"d-flex gap-2"},Te={key:0},Ce=n("th",{class:"text-uppercase",width:"1%"}," No ",-1),je=n("th",{class:"text-uppercase text-center"},"School/Student Name",-1),Pe={class:"text-uppercase text-center"},Ue=n("th",{class:"text-uppercase text-center"},"Package",-1),Ne=n("th",{class:"text-uppercase text-center"},"Tutor/Mentor",-1),Se=n("th",{class:"text-uppercase text-center"},"PIC",-1),Ie=n("th",{class:"text-uppercase text-center"},"Total Hours",-1),qe=n("th",{class:"text-uppercase text-center"},"Used",-1),$e=n("th",{class:"text-uppercase text-center"},"#",-1),Ae=["onClick"],De={key:0},Me={key:1},Be={class:"text-start"},Fe={class:"text-left"},Re={class:"text-left"},He={class:"text-left"},Le={class:"text-left"},ze={key:0},Ee=n("tr",null,[n("td",{colspan:"9",class:"text-center"}," Sorry, no data found. ")],-1),We=[Ee],Ge={class:"d-flex justify-center mt-5"},gt={__name:"timesheet",props:{name:String},setup(Q){const U=Q,R=ue();d([]);const i=d(!1),g=d(1),H=d(),A=d(),D=d([]),y=d(!1),I=d([]),N=d(),L=d([]),T=d(),h=async()=>{var q,S;const p="?page="+g.value,_=A.value?"&keyword="+A.value:"",B=N.value?"&program_name="+encodeURIComponent(N.value):"",m=T.value?"&package_id="+T.value:"",F="&paginate=true",u=U.name!="tutoring"?"&is_subject_specialist=true":"";try{y.value=!0;const s=await x.get("api/v1/timesheet/list"+p+_+B+m+F+u);s&&(g.value=s.current_page,H.value=s.last_page,D.value=s),y.value=!1}catch(s){X("error",(S=(q=s.response)==null?void 0:q.data)==null?void 0:S.message,"bottom-end"),console.error(s),y.value=!1}},M=async()=>{try{const p=await x.get("api/v1/program/component/list");p&&(I.value=p)}catch(p){console.error(p)}},E=async()=>{try{const p=await x.get("api/v1/package/component/list");p&&(L.value=p)}catch(p){console.error(p)}},o=fe(async p=>{g.value=1,A.value=p.target.value,await h()},1e3),W=p=>{const _=R.resolve("/admin/timesheet/"+U.name+"/"+p);window.open(_.href,"_blank")};return ie(()=>{h()}),le(()=>{h(),M(),E()}),(p,_)=>{const B=de("VText");return f(),j(Z,null,[l(ve,{modelValue:e(i),"onUpdate:modelValue":_[1]||(_[1]=m=>z(i)?i.value=m:null),width:"auto",persistent:""},{default:r(()=>[l(he,{onClose:_[0]||(_[0]=m=>i.value=!1),onReload:h})]),_:1},8,["modelValue"]),l(oe,null,{default:r(()=>[l(me,null,{default:r(()=>[xe]),_:1}),l(ae,null,{default:r(()=>[l(K,{class:"my-1 justify-space-between"},{default:r(()=>[U.name=="tutoring"?(f(),$(v,{key:0,cols:"12",md:"6"},{default:r(()=>[l(K,null,{default:r(()=>[l(v,{cols:"12",md:"6"},{default:r(()=>[l(P,{density:"compact",clearable:"",modelValue:e(N),"onUpdate:modelValue":[_[2]||(_[2]=m=>z(N)?N.value=m:null),h],label:"Program Name",items:e(I),"item-title":"program_name",placeholder:"Select Program Name",loading:e(y),disabled:e(y)},null,8,["modelValue","items","loading","disabled"])]),_:1}),l(v,{cols:"12",md:"6"},{default:r(()=>[l(P,{density:"compact",clearable:"true",modelValue:e(T),"onUpdate:modelValue":[_[3]||(_[3]=m=>z(T)?T.value=m:null),h],label:"Package",items:e(L),"item-props":m=>({title:m.package!=null?m.type_of+" - "+m.package:m.type_of}),"item-value":"id",placeholder:"Select Package",loading:e(y),disabled:e(y)},null,8,["modelValue","items","item-props","loading","disabled"])]),_:1})]),_:1})]),_:1})):G("",!0),l(v,{cols:"12",md:"3"},{default:r(()=>[n("div",we,[l(O,{density:"compact",loading:e(y),disabled:e(y),"append-inner-icon":"ri-search-line",label:"Search","hide-details":"","single-line":"",onInput:e(o)},null,8,["loading","disabled","onInput"]),U.name=="tutoring"?(f(),j("div",Te,[l(J,{activator:"parent",location:"start"},{default:r(()=>[V("Add New Timesheet")]),_:1}),l(Y,{icon:"ri-add-line",onClick:_[4]||(_[4]=m=>i.value=!0)})])):G("",!0)])]),_:1})]),_:1}),e(y)?(f(),$(ye,{key:0,class:"mx-auto border",type:"table-thead, table-row@10"})):(f(),$(be,{key:1,class:"text-no-wrap",hover:""},{default:r(()=>{var m,F;return[n("thead",null,[n("tr",null,[Ce,je,n("th",Pe,b(U.name=="tutoring"?"Program Name":"Engagement Type"),1),Ue,Ne,Se,Ie,qe,$e])]),n("tbody",null,[(f(!0),j(Z,null,ee(e(D).data,(u,q)=>(f(),j("tr",{key:q,class:te([u.void=="true"?"bg-secondary":"","cursor-pointer"]),onClick:S=>W(u.id)},[n("td",null,b(parseInt(q)+1),1),n("td",{class:te(u.group?"cursor-pointer text-left":"text-left")},[u.group?(f(),$(B,{key:0},{default:r(()=>[l(k,{icon:"ri-group-line",class:"me-3"}),V(" "+b(u.clients[0])+" ",1),l(ke,{color:"error",content:u.clients.length-1+"+",inline:""},null,8,["content"]),l(J,{activator:"parent",location:"top",transition:"scroll-y-transition",class:"bg-white"},{default:r(()=>[(f(!0),j(Z,null,ee(u.clients,S=>(f(),j("div",null,b(S),1))),256))]),_:2},1024)]),_:2},1024)):(f(),$(B,{key:1},{default:r(()=>[l(k,{icon:"ri-user-line",class:"me-3"}),V(" "+b(u.clients),1)]),_:2},1024))],2),U.name=="tutoring"?(f(),j("td",De,[l(k,{icon:"ri-bookmark-3-line",class:"me-3"}),V(" "+b(u.detail_package=="Trial"?"[TRIAL]":"")+" "+b(u.program_name),1)])):(f(),j("td",Me,[l(k,{icon:"ri-bookmark-3-line",class:"me-3"}),V(" "+b(u.engagement_type),1)])),n("td",Be,[l(k,{icon:"ri-bookmark-line",class:"me-3"}),V(" "+b(u.detail_package?u.package_type+" - "+u.detail_package:u.package_type),1)]),n("td",Fe,[l(k,{icon:"ri-user-line",class:"me-3"}),V(" "+b(u.tutor_mentor),1)]),n("td",Re,[l(k,{icon:"ri-user-line",class:"cursor-pointer me-3"}),V(" "+b(u.admin),1)]),n("td",He,[l(k,{icon:"ri-calendar-schedule-line",class:"cursor-pointer me-3"}),V(" "+b(u.duration/60)+" Hours ",1)]),n("td",Le,[l(k,{icon:"ri-timer-2-line",class:"cursor-pointer me-3"}),V(" "+b(u.spent/60)+" Hours ",1)]),n("td",null,[l(Y,{color:u.void=="true"?"light":"secondary",onClick:S=>W(u.id)},{default:r(()=>[l(k,{icon:"ri-timeline-view",class:"cursor-pointer"}),l(J,{activator:"parent",location:"top",transition:"scroll-y-transition"},{default:r(()=>[V(" View Detail ")]),_:1})]),_:2},1032,["color","onClick"])])],10,Ae))),128))]),((F=(m=e(D))==null?void 0:m.data)==null?void 0:F.length)==0?(f(),j("tfoot",ze,We)):G("",!0)]}),_:1})),n("div",Ge,[l(Ve,{modelValue:e(g),"onUpdate:modelValue":[_[5]||(_[5]=m=>z(g)?g.value=m:null),h],length:e(H),"total-visible":4,color:"primary","show-first-last-page":!1},null,8,["modelValue","length"])])]),_:1})]),_:1})],64)}}};export{gt as default};
