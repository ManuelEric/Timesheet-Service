import{r as p,o as _e,e as u,p as T,w as l,b as t,f as r,t as $,a as x,F as Q,a0 as ie,h as e,j as ye,H as K,i as k,l as j,W as be,k as ue,q as F,V as Z,z as ke,A,s as oe,a1 as Ce,a2 as Te,y as $e,E as Se,n as je}from"./main-Dc0KKNtM.js";import{r as I}from"./rules-CkvmYWH-.js";import{c as ne,V as de,d as Ve,b as Ue}from"./VCard-fz584orh.js";import{V as he}from"./VForm-uXOn21yM.js";import{V as ve,a as y}from"./VRow-CGM_-gYi.js";import{V as L}from"./VAutocomplete-DQtLb5tb.js";import{V as fe}from"./VDialog-f3ADl8CM.js";import{V as W}from"./VTooltip-Bq2hpvT1.js";import{a as ge,V as qe}from"./VTable-DvzDt9WC.js";import{V as xe}from"./VTextarea-G_iSmRkT.js";import{A as Ne}from"./ApiServiceCRM-DdMrZle_.js";import{d as Fe}from"./debounce-CPMihyLA.js";import{V as Ie}from"./VPagination-DDVDl8RC.js";import{T as Pe}from"./index-BPwfMOlC.js";import{V as Ae}from"./VCheckbox-RzbcjcHp.js";import"./VAvatar-CnTxli7_.js";import"./VImg-C5jg37qj.js";import"./VList-Du0VsdGK.js";import"./ssrBoot-DZJiEKTN.js";import"./VDivider-DcBfXl25.js";import"./VCheckboxBtn-Bdgg-lbM.js";import"./VSelectionControl-zSt2wTst.js";import"./VSlideGroup-DgRl6quH.js";const Me={class:"mb-4 d-flex gap-1"},De={class:"text-sm"},Re={class:"d-flex justify-between align-center mb-3"},Ge=r("h4",{class:"w-100"},"Detail of Active Agreement",-1),Ee=r("thead",null,[r("tr",null,[r("th",{class:"text-left",nowrap:""}," Curriculum "),r("th",{nowrap:""},"Subject Tutoring"),r("th",{nowrap:""},"Grade"),r("th",{nowrap:""},"Fee Individual - Gross")])],-1),He={nowrap:""},Le=["href"],ze={nowrap:""},Be={nowrap:""},Oe={nowrap:""},We={__name:"program_add",props:{selected:Object},emits:["close","reload"],setup(ce,{emit:C}){var d,o,g,V;const w=ce,R=C,i=p(!1),_=p(null),ee=p([]),X=p([]),G=p([]),U=p([]),te=p([]),z=p([]),Y=p(!1),P=(o=(d=w.selected[0])==null?void 0:d.require)==null?void 0:o.toLowerCase(),B=p(null),M=p(null),f=p(w.selected.map(m=>m.mentee)),N=p(),a=p({ref_id:w.selected.map(m=>m.id),mentortutor_email:null,subject_id:null,inhouse_id:null,package_id:((g=w.selected[0])==null?void 0:g.package)??null,tax:null,individual_fee:null,duration:"",notes:"",pic_id:[],curriculum_id:((V=w.selected[0])==null?void 0:V.curriculum)??null}),E=async(m=!1)=>{i.value=!0;const n=m?"api/v1/user/mentor-tutors?inhouse=true&role="+P:"api/v1/user/mentor-tutors?role="+P;try{const S=await A.get(n);S&&(m?z.value=Object.values(S):ee.value=S)}catch(S){console.error(S)}finally{i.value=!1}},b=async()=>{i.value=!0;try{const m=await A.get("api/v1/package/component/list?category="+P);m&&(U.value=m)}catch(m){console.error(m)}finally{i.value=!1}},le=()=>{const m=a.value.package_id,n=U.value.findIndex(O=>O.id===m);let S=U.value[n];S.detail?(Y.value=!0,a.value.duration=S.detail):(Y.value=!1,a.value.duration=null)},c=async()=>{try{const m=await A.get("api/v1/user/component/list");m&&(te.value=m)}catch(m){console.error(m)}},ae=async(m,n=null,S=0)=>{B.value=S,a.value.tax=(S==1,2.5),a.value.subject_id=null,a.value.subject_name=null,a.value.individual_fee=null,M.value=null;const O=a.value.curriculum_id?"/"+a.value.curriculum_id:"";try{const h=await A.get("api/v1/user/mentor-tutors/"+n+"/subjects"+O);if(h){const J=[],s=new Set;for(const q of h)s.has(q.tutor_subject)||(s.add(q.tutor_subject),J.push(q));G.value=J}}catch(h){console.error(h)}},D=async(m,n,S)=>{var h,J;const O=(h=w.selected[0])==null?void 0:h.grade;if(n)try{const s=await A.get("api/v1/component/fee/tutor/"+m+"/"+n+"/"+S+"/"+O);s&&(a.value.individual_fee=((J=w.selected)==null?void 0:J.length)>1?s.fee_group:s.fee_individual,a.value.individual_fee?me():M.value=null)}catch(s){oe("error","We're sorry, but we couldn't find a tutor fee for the selected curriculum and subject. This may be outside the scope of our current agreement. Please reach out to our HR team for assistance or to explore availableÂ options","bottom-end"),console.error(s)}else a.value.individual_fee=null,M.value=null},H=async()=>{try{const m=await A.get("api/v1/curriculum/component/list");m&&(X.value=m)}catch(m){console.error(m)}},pe=async()=>{var n,S,O;a.value.mentortutor_email=_.value.email;const{valid:m}=await N.value.validate();if(m){i.value=!0;try{const h=await A.post("api/v1/timesheet/create",a.value);h&&(oe("success",h.message,"bottom-end"),R("reload"),a.value={ref_id:[],mentortutor_email:null,subject_id:null,subject_name:null,inhouse_id:null,package_id:null,duration:"",notes:"",pic_id:[],tax:null,individual_fee:""},_.value=null,window.open("/admin/timesheet/tutoring/"+((n=h.data)==null?void 0:n.timesheet_id),"_blank"))}catch(h){if(console.log(h),(O=(S=h==null?void 0:h.response)==null?void 0:S.data)!=null&&O.errors){const J=h.response.data.errors;oe("error",J,"bottom-end")}}finally{R("close"),i.value=!1}}},me=()=>{const m=a.value.individual_fee*(1-a.value.tax/100);M.value=Math.trunc(m)},v=()=>{const m=M.value/(1-a.value.tax/100);a.value.individual_fee=Math.trunc(m)};return _e(()=>{E(),E(!0),b(),c(),H()}),(m,n)=>{var S;return u(),T(de,{"max-width":"650","prepend-icon":"ri-send-plane-line",title:(S=w.selected[0])==null?void 0:S.program_name},{default:l(()=>[t(ne,null,{default:l(()=>{var O;return[r("div",Me,[r("p",De,$(((O=w.selected)==null?void 0:O.length)>1?"Students":"Student")+":",1),(u(!0),x(Q,null,ie(e(f),h=>(u(),x("p",{key:h,class:"text-sm bg-info px-2 rounded"},$(h),1))),128))]),t(he,{onSubmit:ye(pe,["prevent"]),ref_key:"formData",ref:N,"validate-on":"input"},{default:l(()=>[t(ve,null,{default:l(()=>{var h,J;return[t(y,{cols:e(_)?11:12},{default:l(()=>[t(L,{clearable:"",modelValue:e(_),"onUpdate:modelValue":[n[0]||(n[0]=s=>K(_)?_.value=s:null),n[1]||(n[1]=s=>ae(e(_).roles,e(_).uuid,e(_).has_npwp))],label:"Tutor Name",items:e(ee),"item-props":s=>{var q;return{title:s.full_name,subtitle:((q=s.roles)==null?void 0:q.length)>0?s.roles.map(se=>se.name).join(", "):"-",disabled:s.is_active==0}},rules:e(I).required,loading:e(i),disabled:e(i),density:"compact"},null,8,["modelValue","items","item-props","rules","loading","disabled"])]),_:1},8,["cols"]),e(_)?(u(),T(y,{key:0,cols:"1"},{default:l(()=>[t(fe,{"max-width":"600"},{activator:l(({props:s})=>[t(W,{activator:"parent",location:"end"},{default:l(()=>[k("Fee Detail")]),_:1}),t(j,be({icon:"ri-folder-info-line",class:"cursor-pointer mt-3"},s),null,16)]),default:l(({isActive:s})=>[t(de,null,{default:l(()=>[t(ne,{class:"py-5"},{default:l(()=>{var q;return[r("div",Re,[Ge,t(ue,{size:"x-small",color:"secondary",icon:"ri-close-line",onClick:se=>s.value=!1},null,8,["onClick"])]),((q=e(_))==null?void 0:q.roles.findIndex(se=>se.name==="Tutor"))>=0?(u(),T(ge,{key:0,density:"compact"},{default:l(()=>[Ee,r("tbody",null,[(u(!0),x(Q,null,ie(e(_).roles,(se,we)=>(u(),x(Q,{key:we},[se.name=="Tutor"?(u(!0),x(Q,{key:0},ie(se.subjects,re=>(u(),x("tr",{key:re},[r("td",He,[k($(re.curriculum_name??"-")+" ",1),re.agreement?(u(),x("a",{key:0,href:re.agreement,target:"_blank",class:"ms-2 d-inline cursor-pointer"},[t(W,{activator:"parent",location:"end"},{default:l(()=>[k(" Check Agreement ")]),_:1}),t(j,{icon:"ri-file-pdf-2-line"})],8,Le)):F("",!0)]),r("td",ze,$(re.tutor_subject??"-"),1),r("td",Be,$(re.grade??"-"),1),r("td",Oe," Rp. "+$(new Intl.NumberFormat("id-ID").format(re.fee_individual)),1)]))),128)):F("",!0)],64))),128))])]),_:1})):(u(),T(ne,{key:1,class:"text-center"},{default:l(()=>[k(" There is no tutoring subject ")]),_:1}))]}),_:2},1024)]),_:2},1024)]),_:1})]),_:1})):F("",!0),t(y,{md:"6",cols:"6"},{default:l(()=>[t(L,{clearable:"",modelValue:e(a).curriculum_id,"onUpdate:modelValue":[n[2]||(n[2]=s=>e(a).curriculum_id=s),n[3]||(n[3]=s=>D(e(_).id,e(a).subject_name,e(a).curriculum_id))],label:"Curriculum",items:e(X),"item-props":s=>({title:s.name}),loading:e(i),readonly:"",density:"compact","item-value":"id"},null,8,["modelValue","items","item-props","loading"])]),_:1}),((J=(h=w.selected[0])==null?void 0:h.require)==null?void 0:J.toLowerCase())=="tutor"?(u(),T(y,{key:1,md:"6",cols:"6"},{default:l(()=>[t(L,{clearable:"",modelValue:e(a).subject_name,"onUpdate:modelValue":[n[4]||(n[4]=s=>e(a).subject_name=s),n[5]||(n[5]=s=>D(e(_).id,e(a).subject_name,e(a).curriculum_id))],label:"Subject Tutoring",items:e(G),"item-value":"tutor_subject","item-title":"tutor_subject",loading:e(i),disabled:e(i),rules:e(I).required,density:"compact"},null,8,["modelValue","items","loading","disabled","rules"])]),_:1})):F("",!0),t(y,{md:"8",cols:"8"},{default:l(()=>{var s;return[t(L,{clearable:"",label:"Package",modelValue:e(a).package_id,"onUpdate:modelValue":[n[6]||(n[6]=q=>e(a).package_id=q),le],items:e(U),density:"compact","item-props":q=>({title:q.package!=null?q.type_of+" - "+q.package:q.type_of,subtitle:q.detail?q.detail/60+" Hours":"Customizable"}),"item-value":"id",rules:e(I).required,loading:e(i),readonly:(s=w.selected[0])==null?void 0:s.package,disabled:e(i)},null,8,["modelValue","items","item-props","rules","loading","readonly","disabled"])]}),_:1}),t(y,{md:"4",cols:"4"},{default:l(()=>[t(Z,{type:"number",clearable:"",label:e(a).duration/60?"Minutes ("+(e(a).duration/60).toFixed(1)+" Hours)":"Minutes",readonly:e(Y),modelValue:e(a).duration,"onUpdate:modelValue":n[7]||(n[7]=s=>e(a).duration=s),density:"compact",rules:e(I).required},null,8,["label","readonly","modelValue","rules"])]),_:1}),t(y,{md:"4",cols:"7"},{default:l(()=>[t(Z,{type:"number",clearable:"",label:"Fee/hours (Nett)",modelValue:e(M),"onUpdate:modelValue":[n[8]||(n[8]=s=>K(M)?M.value=s:null),v],density:"compact",readonly:"",rules:e(I).required},null,8,["modelValue","rules"])]),_:1}),t(y,{md:"4",cols:"5"},{default:l(()=>[t(Z,{type:"number",clearable:"",label:"Tax",modelValue:e(a).tax,"onUpdate:modelValue":[n[9]||(n[9]=s=>e(a).tax=s),v],rules:e(I).required,density:"compact",readonly:""},null,8,["modelValue","rules"])]),_:1}),t(y,{md:"4",cols:"12"},{default:l(()=>[t(W,{activator:"parent",location:"top"},{default:l(()=>[k(" Fee Gross is automatically calculated based on the entered Net Fee and Tax Rate. ")]),_:1}),t(Z,{type:"number",clearable:"",label:"Fee/hours (Gross)",modelValue:e(a).individual_fee,"onUpdate:modelValue":[n[10]||(n[10]=s=>e(a).individual_fee=s),me],density:"compact",readonly:"",rules:e(I).required},null,8,["modelValue","rules"])]),_:1}),t(y,{md:"6",cols:"6"},{default:l(()=>[t(L,{clearable:"",modelValue:e(a).inhouse_id,"onUpdate:modelValue":n[11]||(n[11]=s=>e(a).inhouse_id=s),label:"Inhouse Mentor/Tutor",items:e(z),density:"compact","item-props":s=>({title:s.full_name}),"item-value":"uuid",loading:e(i),disabled:e(i),rules:e(I).required},null,8,["modelValue","items","item-props","loading","disabled","rules"])]),_:1}),t(y,{md:"6",cols:"6"},{default:l(()=>[t(L,{multiple:"",clearable:"",chips:"",label:"PIC",modelValue:e(a).pic_id,"onUpdate:modelValue":n[12]||(n[12]=s=>e(a).pic_id=s),items:e(te),"item-title":"full_name","item-value":"id",loading:e(i),density:"compact",disabled:e(i),rules:e(I).required},null,8,["modelValue","items","loading","disabled","rules"])]),_:1}),t(y,{md:"12"},{default:l(()=>[t(xe,{label:"Notes",modelValue:e(a).notes,"onUpdate:modelValue":n[13]||(n[13]=s=>e(a).notes=s),density:"compact"},null,8,["modelValue"])]),_:1})]}),_:1}),t(Ve,{class:"mt-5 px-0"},{default:l(()=>[t(ue,{variant:"tonal",color:"error",type:"button",onClick:n[14]||(n[14]=h=>R("close"))},{default:l(()=>[t(j,{icon:"ri-close-line",class:"me-3"}),k(" Close ")]),_:1}),t(ke),t(ue,{variant:"tonal",color:"success",type:"submit"},{default:l(()=>[k(" Save "),t(j,{icon:"ri-save-line",class:"ms-3"})]),_:1})]),_:1})]),_:1},512)]}),_:1})]),_:1},8,["title"])}}},Ye={class:"d-flex justify-between align-center mb-3"},Je=r("h4",{class:"w-100"},"Detail of Active Agreement",-1),Ke=r("thead",null,[r("tr",null,[r("th",{class:"text-left",nowrap:""}," Engagement Type "),r("th",{nowrap:""},"Stream"),r("th",{nowrap:""},"Package"),r("th",{nowrap:""},"Fee Individual - Gross")])],-1),Qe={nowrap:""},Xe=["href"],Ze={nowrap:""},et={nowrap:""},tt={nowrap:""},lt={__name:"program_add_specialist",props:{selected:Object},emits:["close","reload"],setup(ce,{emit:C}){var pe,me;const w=ce,R=C,i=p(!1),_=p(null),ee=p([]),X=p([]),G=p(null),U=p([]),te=p([]),z=p([]),Y=p(!1),P=(me=(pe=w.selected[0])==null?void 0:pe.require)==null?void 0:me.toLowerCase(),B=p(null),M=p(),f=p({ref_id:w.selected.map(v=>v.id),mentortutor_email:null,subject_id:null,inhouse_id:null,package_id:null,duration:"",tax:2.5,individual_fee:null,notes:"",pic_id:[]}),N=async(v=!1)=>{const d=P=="mentor"?"External Mentor":P,o=v?"api/v1/user/mentor-tutors?inhouse=true&role="+P:"api/v1/user/mentor-tutors?role="+d;try{const g=await A.get(o);g&&(v?z.value=Object.values(g):ee.value=g)}catch(g){console.error(g)}},a=async()=>{var d,o;const v="external-mentor/streams";try{i.value=!0;const g=await Ne.get(v);g&&(X.value=g),i.value=!1}catch(g){oe("error",(o=(d=g.response)==null?void 0:d.data)==null?void 0:o.message,"bottom-end"),console.error(g),i.value=!1}},E=async(v,d,o)=>{const g=w.selected[0].engagement_type;try{const V=await A.get("api/v1/component/fee/ext-mentor/"+v+"/"+d+"/"+g+"/"+o);V&&(f.value.individual_fee=V.fee_individual,f.value.individual_fee?D():B.value=null)}catch(V){f.value.individual_fee=null,B.value=null,oe("error","We're sorry, but we couldn't find a tutor fee for the selected curriculum and subject. This may be outside the scope of our current agreement. Please reach out to our HR team for assistance or to explore availableÂ options","bottom-end"),console.error(V)}le()},b=async()=>{try{const v=await A.get("api/v1/package/component/list?category="+P);v&&(U.value=v)}catch(v){console.error(v)}},le=()=>{const v=f.value.package_id,d=U.value.findIndex(g=>g.id===v);let o=U.value[d];o.detail?(Y.value=!0,f.value.duration=o.detail):(Y.value=!1,f.value.duration=null)},c=async()=>{try{const v=await A.get("api/v1/user/component/list");v&&(te.value=v)}catch(v){console.error(v)}},ae=async()=>{var d,o,g;f.value.mentortutor_email=_.value.email;const{valid:v}=await M.value.validate();if(v){i.value=!0;try{const V=await A.post("api/v1/timesheet/create",f.value);V&&(oe("success",V.message,"bottom-end"),R("reload"),f.value={ref_id:[],mentortutor_email:null,subject_id:null,subject_name:null,inhouse_id:null,package_id:null,duration:"",notes:"",pic_id:[],tax:null,individual_fee:""},_.value=[],window.open("/admin/timesheet/specialist/"+((d=V.data)==null?void 0:d.timesheet_id),"_blank"))}catch(V){if((g=(o=V==null?void 0:V.response)==null?void 0:o.data)!=null&&g.errors){const m=V.response.data.errors;oe("error",m,"bottom-end")}}finally{R("close"),i.value=!1}}},D=()=>{const v=f.value.individual_fee*(1-f.value.tax/100);B.value=Math.trunc(v)},H=()=>{const v=B.value/(1-f.value.tax/100);f.value.individual_fee=Math.trunc(v)};return _e(()=>{a(),N(),N(!0),b(),c()}),(v,d)=>(u(),T(de,{"max-width":"650","prepend-icon":"ri-send-plane-line",title:"Assign to Subject Specialist"},{default:l(()=>[t(ne,null,{default:l(()=>[t(he,{onSubmit:ye(ae,["prevent"]),ref_key:"formData",ref:M,"validate-on":"input"},{default:l(()=>[t(ve,null,{default:l(()=>[t(y,{md:"6",cols:e(_)?11:12},{default:l(()=>[t(L,{density:"compact",clearable:"",modelValue:e(_),"onUpdate:modelValue":[d[0]||(d[0]=o=>K(_)?_.value=o:null),d[1]||(d[1]=()=>(G.value=null,e(f).package_id=null))],label:"Subject Specialist Name",items:e(ee),"item-props":o=>{var g;return{title:o.full_name,subtitle:((g=o.roles)==null?void 0:g.length)>0?o.roles.map(V=>V.name).join(", "):"-",disabled:o.is_active==0}},rules:e(I).required,loading:e(i),disabled:e(i)},null,8,["modelValue","items","item-props","rules","loading","disabled"])]),_:1},8,["cols"]),e(_)?(u(),T(y,{key:0,cols:"1"},{default:l(()=>[t(fe,{"max-width":"600"},{activator:l(({props:o})=>[t(W,{activator:"parent",location:"end"},{default:l(()=>[k("Fee Detail")]),_:1}),t(j,be({icon:"ri-folder-info-line",class:"cursor-pointer mt-3"},o),null,16)]),default:l(({isActive:o})=>[t(de,null,{default:l(()=>[t(ne,{class:"py-5"},{default:l(()=>{var g;return[r("div",Ye,[Je,t(ue,{size:"x-small",color:"secondary",icon:"ri-close-line",onClick:V=>o.value=!1},null,8,["onClick"])]),((g=e(_))==null?void 0:g.roles.findIndex(V=>V.name==="External Mentor"))>=0?(u(),T(ge,{key:0,density:"compact"},{default:l(()=>[Ke,r("tbody",null,[(u(!0),x(Q,null,ie(e(_).roles,(V,m)=>(u(),x(Q,{key:m},[V.name=="External Mentor"?(u(!0),x(Q,{key:0},ie(V.subjects,n=>(u(),x("tr",{key:n},[r("td",Qe,[k($(n.engagement_type_name??"-")+" ",1),n.agreement?(u(),x("a",{key:0,href:n.agreement,target:"_blank",class:"ms-2 d-inline cursor-pointer"},[t(W,{activator:"parent",location:"end"},{default:l(()=>[k(" Check Agreement ")]),_:1}),t(j,{icon:"ri-file-pdf-2-line"})],8,Xe)):F("",!0)]),r("td",Ze,$(n.stream??"-"),1),r("td",et,$(n.package_name??"-"),1),r("td",tt," Rp. "+$(new Intl.NumberFormat("id-ID").format(n.fee_individual)),1)]))),128)):F("",!0)],64))),128))])]),_:1})):(u(),T(ne,{key:1,class:"text-center"},{default:l(()=>[k(" There is no tutoring subject ")]),_:1}))]}),_:2},1024)]),_:2},1024)]),_:1})]),_:1})):F("",!0),t(y,{md:e(_)?5:6,cols:"12"},{default:l(()=>[t(L,{density:"compact",clearable:"",label:"Stream",modelValue:e(G),"onUpdate:modelValue":d[2]||(d[2]=o=>K(G)?G.value=o:null),items:e(X),"item-title":"stream_name","item-value":"stream_name",loading:e(i),disabled:e(i)},null,8,["modelValue","items","loading","disabled"])]),_:1},8,["md"]),t(y,{md:"8",cols:"8"},{default:l(()=>[t(L,{density:"compact",clearable:"",label:"Package",modelValue:e(f).package_id,"onUpdate:modelValue":[d[3]||(d[3]=o=>e(f).package_id=o),d[4]||(d[4]=o=>E(e(_).id,e(G),e(f).package_id))],items:e(U),"item-props":o=>({title:o.package!=null?o.type_of+" - "+o.package:o.type_of,subtitle:o.detail?o.detail/60+" Hours":"Customizable"}),"item-value":"id",rules:e(I).required,loading:e(i),disabled:e(i)},null,8,["modelValue","items","item-props","rules","loading","disabled"])]),_:1}),t(y,{md:"4",cols:"4"},{default:l(()=>[t(Z,{density:"compact",type:"number",clearable:"",label:+e(f).duration/60?""+e(f).duration/60+" Hours":"Minutes",readonly:e(Y),modelValue:e(f).duration,"onUpdate:modelValue":d[5]||(d[5]=o=>e(f).duration=o),rules:e(I).required},null,8,["label","readonly","modelValue","rules"])]),_:1}),t(y,{md:"4",cols:"7"},{default:l(()=>[t(Z,{type:"number",clearable:"",label:"Fee/hours (Nett)",modelValue:e(B),"onUpdate:modelValue":[d[6]||(d[6]=o=>K(B)?B.value=o:null),H],density:"compact",rules:e(I).required,readonly:""},null,8,["modelValue","rules"])]),_:1}),t(y,{md:"4",cols:"5"},{default:l(()=>[t(Z,{type:"number",clearable:"",label:"Tax",modelValue:e(f).tax,"onUpdate:modelValue":[d[7]||(d[7]=o=>e(f).tax=o),H],rules:e(I).required,density:"compact",readonly:""},null,8,["modelValue","rules"])]),_:1}),t(y,{md:"4",cols:"12"},{default:l(()=>[t(W,{activator:"parent",location:"top"},{default:l(()=>[k(" Fee Gross is automatically calculated based on the entered Net Fee and Tax Rate. ")]),_:1}),t(Z,{type:"number",clearable:"",label:"Fee/hours (Gross)",modelValue:e(f).individual_fee,"onUpdate:modelValue":[d[8]||(d[8]=o=>e(f).individual_fee=o),D],density:"compact",readonly:"",rules:e(I).required},null,8,["modelValue","rules"])]),_:1}),t(y,{md:"6",cols:"12"},{default:l(()=>[t(L,{density:"compact",clearable:"",modelValue:e(f).inhouse_id,"onUpdate:modelValue":d[9]||(d[9]=o=>e(f).inhouse_id=o),label:"Inhouse Mentor",items:e(z),"item-props":o=>({title:o.full_name}),"item-value":"uuid",loading:e(i),disabled:e(i),rules:e(I).required},null,8,["modelValue","items","item-props","loading","disabled","rules"])]),_:1}),t(y,{md:"6",cols:"12"},{default:l(()=>[t(L,{density:"compact",multiple:"",clearable:"",chips:"",label:"PIC",modelValue:e(f).pic_id,"onUpdate:modelValue":d[10]||(d[10]=o=>e(f).pic_id=o),items:e(te),"item-title":"full_name","item-value":"id",loading:e(i),disabled:e(i),rules:e(I).required},null,8,["modelValue","items","loading","disabled","rules"])]),_:1}),t(y,{md:"12"},{default:l(()=>[t(xe,{label:"Notes",modelValue:e(f).notes,"onUpdate:modelValue":d[11]||(d[11]=o=>e(f).notes=o)},null,8,["modelValue"])]),_:1})]),_:1}),t(Ve,{class:"mt-5 px-0"},{default:l(()=>[t(ue,{variant:"tonal",color:"error",type:"button",onClick:d[12]||(d[12]=o=>R("close"))},{default:l(()=>[t(j,{icon:"ri-close-line",class:"me-3"}),k(" Close ")]),_:1}),t(ke),t(ue,{variant:"tonal",color:"success",type:"submit"},{default:l(()=>[k(" Save "),t(j,{icon:"ri-save-line",class:"ms-3"})]),_:1})]),_:1})]),_:1},512)]),_:1})]),_:1}))}},at=["innerHTML"],ot=r("div",{class:"d-flex justify-between align-center"},[r("div",{class:"w-100"},[r("h4",null,"Program Name")])],-1),nt={key:0,class:"d-flex bg-secondary py-1 px-2 rounded-lg",style:{"align-items":"center"}},st=r("th",{class:"text-uppercase",width:"1%"}," # ",-1),rt=r("th",{class:"text-uppercase text-center"},"Timesheet",-1),it=r("th",{class:"text-uppercase text-center"},"Student",-1),ut=r("th",{class:"text-uppercase text-center"},"School Name",-1),dt={class:"text-uppercase text-center"},ct={key:0,class:"text-uppercase text-center"},mt={class:"text-center"},pt={class:"text-left",nowrap:""},ft=["onClick"],_t={class:"text-left",nowrap:""},vt={key:0,class:"text-left",nowrap:""},gt={key:1,class:"text-left",nowrap:""},yt={key:2,nowrap:""},bt={key:0},kt=r("tr",null,[r("td",{colspan:"6",class:"text-center"}," Sorry, no data found. ")],-1),Vt=[kt],ht={class:"d-flex justify-center mt-5"},Ot={__name:"program",props:{name:String},setup(ce){const C=p([]),w=p(!1),R=p(!1),i=ce,_=p(1),ee=p(),X=p(null),G=p([]),U=p(!1),te=p([]),z=p(),Y=p(),P=async()=>{var ae,D;const N=i.name,a="?page="+_.value,E=X.value?"&keyword="+X.value:"",b=z.value?"&program_name="+encodeURIComponent(z.value):"",c=N=="tutoring"?"api/v1/program/list"+a+E+b+"&paginate=true":"api/v1/request"+a+E+"&is_cancelled=true";try{U.value=!0;const H=await A.get(c);H&&(_.value=H.current_page,ee.value=H.last_page,G.value=H),U.value=!1}catch(H){oe("error",(D=(ae=H.response)==null?void 0:ae.data)==null?void 0:D.message,"bottom-end"),console.error(H),U.value=!1}},B=async()=>{try{const N=await A.get("api/v1/program/component/list");N&&(te.value=N)}catch(N){console.error(N)}},M=Fe(async N=>{_.value=1,X.value=N.target.value,await P()},1e3),f=N=>{window.open("/admin/timesheet/"+i.name+"/"+N)};return Ce(()=>{P()}),Te(()=>{C.value=[]}),_e(()=>{P(),B()}),(N,a)=>{const E=$e("VText");return u(),x(Q,null,[t(fe,{modelValue:e(R),"onUpdate:modelValue":a[0]||(a[0]=b=>K(R)?R.value=b:null),width:"400"},{default:l(()=>[t(de,{title:"Notes","prepend-icon":"ri-chat-3-line"},{default:l(()=>[t(ne,null,{default:l(()=>[r("div",{innerHTML:e(Y)},null,8,at)]),_:1})]),_:1})]),_:1},8,["modelValue"]),t(de,null,{default:l(()=>[t(Ue,null,{default:l(()=>[ot]),_:1}),t(ne,null,{default:l(()=>[t(ve,{class:"my-1"},{default:l(()=>[i.name=="tutoring"?(u(),T(y,{key:0,cols:"12",md:"3"},{default:l(()=>[t(L,{clearable:"",modelValue:e(z),"onUpdate:modelValue":[a[1]||(a[1]=b=>K(z)?z.value=b:null),P],label:"Program Name",items:e(te),"item-title":"program_name",placeholder:"Select Program Name",density:"compact","hide-details":"","single-line":"",loading:e(U),disabled:e(U)},null,8,["modelValue","items","loading","disabled"])]),_:1})):F("",!0),t(y,{cols:"12",md:"3"},{default:l(()=>[t(Z,{loading:e(U),disabled:e(U),"append-inner-icon":"ri-search-line",density:"compact",label:"Search","hide-details":"","single-line":"",onInput:e(M)},null,8,["loading","disabled","onInput"])]),_:1}),t(y,{cols:"12",md:i.name=="tutoring"?6:9,class:"text-end"},{default:l(()=>[Se((u(),T(ue,{density:"compact",color:e(C).length>0?"warning":"primary",class:"mb-2",disabled:!(e(C).length>0),onClick:a[2]||(a[2]=b=>w.value=!0)},{default:l(()=>[t(j,{icon:"ri-add-line",class:"me-3"}),k(" Assign "+$(e(C).length>1?"to Group":""),1)]),_:1},8,["color","disabled"])),[[Pe,"Generate Timesheet","start"]])]),_:1},8,["md"])]),_:1}),t(fe,{modelValue:e(w),"onUpdate:modelValue":a[7]||(a[7]=b=>K(w)?w.value=b:null),width:"auto",persistent:""},{default:l(()=>[i.name=="tutoring"?(u(),T(We,{key:0,selected:e(C),onClose:a[3]||(a[3]=b=>{w.value=!1,C.value=[]}),onReload:a[4]||(a[4]=b=>{C.value=[],P()})},null,8,["selected"])):F("",!0),i.name=="specialist"?(u(),T(lt,{key:1,selected:e(C),onClose:a[5]||(a[5]=b=>w.value=!1),onReload:a[6]||(a[6]=b=>{C.value=[],P()})},null,8,["selected"])):F("",!0)]),_:1},8,["modelValue"]),e(C).length>0?(u(),x("div",nt,[k(" Selected: "),(u(!0),x(Q,null,ie(e(C),b=>(u(),x("small",{class:"bg-info px-3 rounded-xl ms-1 d-flex",style:{"font-size":"10px","align-items":"center"},key:b},[k($(b.mentee)+" ",1),t(j,{icon:"ri-close-line",color:"error",class:"ms-2 cursor-pointer",onClick:le=>C.value=e(C).filter(c=>c!==b)},null,8,["onClick"])]))),128))])):F("",!0),e(U)?(u(),T(qe,{key:1,class:"mx-auto border",type:"table-thead, table-row@10"})):(u(),T(ge,{key:2,class:"table-responsive"},{default:l(()=>{var b,le;return[r("thead",null,[r("tr",null,[st,rt,it,ut,r("th",dt,$(i.name=="tutoring"?"Program Name":"Engagement Type"),1),i.name=="tutoring"?(u(),x("th",ct," Tutor Name ")):F("",!0)])]),r("tbody",null,[(u(!0),x(Q,null,ie(e(G).data,(c,ae)=>(u(),x("tr",{key:ae,class:je({"bg-secondary":e(C).includes(c.id)})},[r("td",null,[c.cancellation_reason?(u(),T(E,{key:0},{default:l(()=>[t(W,{activator:"parent",location:"top"},{default:l(()=>[k(" Cancel: "+$(c.cancellation_reason),1)]),_:2},1024),t(j,{icon:"ri-subtract-line",color:"error"})]),_:2},1024)):(!c.timesheet_id||!c.scnd_timesheet_id)&&!c.cancellation_reason?(u(),T(Ae,{key:1,modelValue:e(C),"onUpdate:modelValue":a[8]||(a[8]=D=>K(C)?C.value=D:null),value:{id:c.id,require:c.require,mentee:c.student_name,package:c.package,curriculum:c.curriculum,program_name:c.program_name,grade:c.student_grade,engagement_type:c.engagement_type_id}},null,8,["modelValue","value"])):c.timesheet_id&&c.scnd_timesheet_id&&!c.cancellation_reason?(u(),T(j,{key:2,icon:"ri-check-line",color:"success"})):F("",!0)]),r("td",mt,[c.timesheet_id?(u(),T(E,{key:0,class:"cursor-pointer",onClick:D=>f(c.timesheet_id)},{default:l(()=>[t(j,{icon:"ri-file-check-line",class:"mx-1",color:"success"}),t(W,{activator:"parent",location:"top"},{default:l(()=>[k("Already")]),_:1})]),_:2},1032,["onClick"])):(u(),T(E,{key:1},{default:l(()=>[t(j,{icon:"ri-file-close-line",class:"mx-1",color:"error"}),t(W,{activator:"parent",location:"top"},{default:l(()=>[k("Not Yet")]),_:1})]),_:1})),c.scnd_timesheet_id?(u(),T(E,{key:2,class:"cursor-pointer",onClick:D=>f(c.scnd_timesheet_id)},{default:l(()=>[t(j,{icon:"ri-file-check-line",class:"mx-1",color:"success"}),t(W,{activator:"parent",location:"top"},{default:l(()=>[k("Already")]),_:1})]),_:2},1032,["onClick"])):F("",!0)]),r("td",pt,[t(j,{icon:"ri-user-line",class:"me-3"}),k(" "+$(c.student_name)+" ",1),i.name=="specialist"&&c.notes?(u(),x("div",{key:0,class:"d-inline ms-2 cursor-pointer",onClick:D=>{R.value=!0,Y.value=c.notes}},[t(W,{activator:"parent",location:"start"},{default:l(()=>[k(" Notes ")]),_:1}),t(j,{icon:"ri-chat-3-line",color:"info"})],8,ft)):F("",!0)]),r("td",_t,$(c.student_school),1),i.name=="tutoring"?(u(),x("td",vt,[t(j,{icon:"ri-bookmark-line",class:"me-3"}),k(" "+$(c.free_trial?"[TRIAL]":"")+" "+$(c.program_name),1)])):(u(),x("td",gt,[t(j,{icon:"ri-bookmark-line",class:"me-3"}),k(" "+$(c.engagement_type),1)])),i.name=="tutoring"?(u(),x("td",yt,$(c.tutor_name),1)):F("",!0)],2))),128))]),((le=(b=e(G))==null?void 0:b.data)==null?void 0:le.length)==0?(u(),x("tfoot",bt,Vt)):F("",!0)]}),_:1})),r("div",ht,[t(Ie,{modelValue:e(_),"onUpdate:modelValue":[a[9]||(a[9]=b=>K(_)?_.value=b:null),P],length:e(ee),"total-visible":4,color:"primary",density:"compact","show-first-last-page":!1},null,8,["modelValue","length"])])]),_:1})]),_:1})],64)}}};export{Ot as default};
