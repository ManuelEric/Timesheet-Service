import{r as f,o as ee,y as H,e as w,p as U,w as a,b as e,j as z,h as t,H as F,D as S,V as R,k as h,l as C,i as D,z as W,A,s as I,f as n,a as q,F as Q,q as O,x as te,W as le,a0 as ae,t as Y}from"./main-mrss2PD2.js";import{r as $}from"./rules-CkvmYWH-.js";import{c as B,d as G,V as E,b as se}from"./VCard-DWjdz7UP.js";import{V as J}from"./VForm-CZaKHgEM.js";import{V as L,a as T}from"./VRow-34ihTQfv.js";import{V as j,a as oe}from"./VAutocomplete-C3JWBVzZ.js";import{V as K}from"./VDivider-BYruCjqx.js";import{d as ne}from"./debounce-DLQVPFjc.js";import{V as N}from"./VDialog-DZ4k8g9N.js";import{V as de,a as X}from"./VList-CUmR6oMF.js";import{a as ue,V as re}from"./VTable-BfyHJTbK.js";import{V as ie}from"./VPagination-ClFFr0z6.js";import{V as me}from"./VCheckbox-BZJhtwAo.js";import"./VAvatar-C3vDfAV4.js";import"./VImg-C_sJV_Ub.js";import"./VCheckboxBtn-BloLDdJk.js";import"./VSelectionControl-By4Qs2Av.js";import"./VSlideGroup-BB7M-Gir.js";import"./ssrBoot-BcY7FlK-.js";const Z={__name:"additional_add",props:{title:String},emits:["close","reload"],setup(P,{emit:V}){const k=P,d=V,y=f(),v=f({timesheet_id:null,fee:null,date:null}),p=f([]),m=f([]),_=f(!1),x=f(null),o=async()=>{_.value=!0;try{const i=await A.get("api/v1/user/mentor-tutors?role=tutor");i&&(m.value=i)}catch(i){console.error(i)}finally{_.value=!1}},g=async()=>{_.value=!0;try{const i=await A.get("api/v1/timesheet/component/list?terms="+x.value);i&&(p.value=i)}catch(i){console.error(i)}finally{_.value=!1}},r=async()=>{var s,u;const i=k.title=="bonus"?"api/v1/payment/bonus/create":"api/v1/payment/additional-fee/create",{valid:l}=await y.value.validate();if(l){v.value.date=S(v.value.date).format("YYYY-MM-DD");try{const c=await A.post(i,v.value);c&&I("success",c.message,"bottom-end")}catch(c){const M=(u=(s=c==null?void 0:c.response)==null?void 0:s.data)==null?void 0:u.errors;I("error",M,"bottom-end")}finally{d("close"),d("reload")}}};return ee(()=>{o()}),(i,l)=>{const s=H("VDateInput");return w(),U(E,{title:k.title=="bonus"?"Add Bonus":"Additional Fee"},{default:a(()=>[e(B,null,{default:a(()=>[e(J,{onSubmit:z(r,["prevent"]),ref_key:"formData",ref:y},{default:a(()=>[e(L,null,{default:a(()=>[e(T,{cols:"12"},{default:a(()=>[e(j,{modelValue:t(x),"onUpdate:modelValue":[l[0]||(l[0]=u=>F(x)?x.value=u:null),g],label:"Tutor Name",placeholder:"Timesheet - Package",items:t(m),"item-props":u=>({title:u.full_name,subtitle:u.email}),"item-value":"full_name",rules:t($).required,loading:t(_),disabled:t(_),density:"compact"},null,8,["modelValue","items","item-props","rules","loading","disabled"])]),_:1}),e(T,{cols:"12"},{default:a(()=>[e(j,{modelValue:t(v).timesheet_id,"onUpdate:modelValue":l[1]||(l[1]=u=>t(v).timesheet_id=u),label:"Timesheet - Package",placeholder:"Timesheet - Package",items:t(p),"item-props":u=>({title:u.clients+" ("+u.package_type+" - "+u.package_name+")",subtitle:t(S)(u.timesheet_created_at).format("LL")}),"item-value":"id",rules:t($).required,loading:t(_),disabled:t(_),density:"compact"},null,8,["modelValue","items","item-props","rules","loading","disabled"])]),_:1}),e(T,{cols:"12"},{default:a(()=>[e(s,{modelValue:t(v).date,"onUpdate:modelValue":l[2]||(l[2]=u=>t(v).date=u),"prepend-icon":"",label:"Date",placeholder:"Date",rules:t($).required,variant:"outlined",density:"compact"},null,8,["modelValue","rules"]),e(R,{modelValue:t(v).fee,"onUpdate:modelValue":l[3]||(l[3]=u=>t(v).fee=u),type:"number",label:"Additional Fee",placeholder:"Additional Fee",rules:t($).required,density:"compact"},null,8,["modelValue","rules"])]),_:1})]),_:1}),e(K,{class:"my-3"}),e(G,null,{default:a(()=>[e(h,{color:"error",onClick:l[4]||(l[4]=u=>d("close"))},{default:a(()=>[e(C,{icon:"ri-close-line",class:"me-3"}),D(" Close ")]),_:1}),e(W),e(h,{color:"success",type:"submit"},{default:a(()=>[D(" Save "),e(C,{icon:"ri-save-line",class:"ms-3"})]),_:1})]),_:1})]),_:1},512)]),_:1})]),_:1},8,["title"])}}},ce={class:"d-flex gap-2"},pe={class:""},fe={class:"d-flex gap-2"},ve={class:""},_e={__name:"cutoff_add",emits:["close","reload"],setup(P,{emit:V}){const k=V,d=f(!1),y=f(),v=f(null),p=f(null),m=f({start_date:null,end_date:null,start_time:null,end_time:null}),_=async()=>{var g,r,i,l,s,u,c,M;const{valid:x}=await y.value.validate();if(x){d.value=!0;try{const b=await A.post("api/v1/payment/cut-off/create",m.value);b&&I("success",b.message,"bottom-end")}catch(b){var o=(r=(g=b==null?void 0:b.response)==null?void 0:g.data)==null?void 0:r.errors;(s=(l=(i=b==null?void 0:b.response)==null?void 0:i.data)==null?void 0:l.errors)!=null&&s.end_date&&(o=(M=(c=(u=b==null?void 0:b.response)==null?void 0:u.data)==null?void 0:c.errors)==null?void 0:M.end_date[0]),I("error",o,"bottom-end")}finally{d.value=!1,k("close"),k("reload")}}};return(x,o)=>{const g=H("VDateInput");return w(),U(E,{title:"Cut-Off Date"},{default:a(()=>[e(B,null,{default:a(()=>[e(J,{onSubmit:z(_,["prevent"]),ref_key:"formData",ref:y},{default:a(()=>[e(L,null,{default:a(()=>[e(T,{cols:"12"},{default:a(()=>[n("div",ce,[e(g,{"prepend-icon":"",modelValue:v.value,"onUpdate:modelValue":[o[0]||(o[0]=r=>v.value=r),o[1]||(o[1]=r=>m.value.start_date=t(S)(v.value).format("YYYY-MM-DD")+" "+m.value.start_time+":00")],"input-format":"yyyy-mm-dd",label:"Start Date",variant:"outlined",density:"compact",rules:t($).required},null,8,["modelValue","rules"]),n("div",pe,[e(R,{modelValue:m.value.start_time,"onUpdate:modelValue":[o[2]||(o[2]=r=>m.value.start_time=r),o[3]||(o[3]=r=>m.value.start_date=t(S)(v.value).format("YYYY-MM-DD")+" "+m.value.start_time+":00")],type:"time",density:"compact",label:"Start Time",placeholder:"End Time",rules:t($).required,loading:d.value,disabled:!v.value||d.value},null,8,["modelValue","rules","loading","disabled"])])]),n("div",fe,[e(g,{"prepend-icon":"",modelValue:p.value,"onUpdate:modelValue":[o[4]||(o[4]=r=>p.value=r),o[5]||(o[5]=r=>m.value.end_date=t(S)(p.value).format("YYYY-MM-DD")+" "+m.value.end_time+":00")],label:"End Date",variant:"outlined",density:"compact",rules:t($).required},null,8,["modelValue","rules"]),n("div",ve,[e(R,{modelValue:m.value.end_time,"onUpdate:modelValue":[o[6]||(o[6]=r=>m.value.end_time=r),o[7]||(o[7]=r=>m.value.end_date=t(S)(p.value).format("YYYY-MM-DD")+" "+m.value.end_time+":00")],type:"time",density:"compact",label:"Start Time",placeholder:"End Time",rules:t($).required,loading:d.value,disabled:!p.value||d.value},null,8,["modelValue","rules","loading","disabled"])])])]),_:1})]),_:1}),e(K,{class:"my-3"}),e(G,{class:"px-0"},{default:a(()=>[e(h,{variant:"tonal",color:"error",onClick:o[8]||(o[8]=r=>k("close"))},{default:a(()=>[e(C,{icon:"ri-close-line",class:"me-3"}),D(" Close ")]),_:1}),e(W),e(h,{variant:"tonal",loading:d.value,disabled:d.value,color:"success",type:"submit"},{default:a(()=>[D(" Save "),e(C,{icon:"ri-save-line",class:"ms-3"})]),_:1},8,["loading","disabled"])]),_:1})]),_:1},512)]),_:1})]),_:1})}}},Ve={__name:"cutoff_existing_add",props:{id:Array},emits:["close","reload","reset"],setup(P,{emit:V}){const k=P,d=V,y=f(),v=f({activity_id:k.id,start_date:null,end_date:null}),p=f(null),m=()=>{v.value.start_date=S(p.value[0]).format("YYYY-MM-DD"),v.value.end_date=S(p.value[p.value.length-1]).format("YYYY-MM-DD")},_=async()=>{var o,g;const{valid:x}=await y.value.validate();if(x)try{const r=await A.post("api/v1/payment/cut-off/add",v.value);r&&I("success",r.message,"bottom-end")}catch(r){if((g=(o=r==null?void 0:r.response)==null?void 0:o.data)!=null&&g.errors){const i=r.response.data.errors;let l="Validation errors:";for(const s in i)i.hasOwnProperty(s)&&(l+=`
${s}: ${i[s].join(", ")}`);I("error",l,"bottom-end")}}finally{d("reload"),d("close"),d("reset")}};return(x,o)=>{const g=H("VDateInput");return w(),U(E,{title:"Add to Cut-Off"},{default:a(()=>[e(B,null,{default:a(()=>[e(J,{onSubmit:z(_,["prevent"]),ref_key:"formData",ref:y},{default:a(()=>[e(L,null,{default:a(()=>[e(T,{cols:"12"},{default:a(()=>[e(g,{modelValue:t(p),"onUpdate:modelValue":[o[0]||(o[0]=r=>F(p)?p.value=r:null),m],label:"Start - End Date",rules:t($).required,multiple:"range"},null,8,["modelValue","rules"])]),_:1})]),_:1}),e(K,{class:"my-3"}),e(G,null,{default:a(()=>[e(h,{color:"error",onClick:o[1]||(o[1]=r=>d("close"))},{default:a(()=>[e(C,{icon:"ri-close-line",class:"me-3"}),D(" Close ")]),_:1}),e(W),e(h,{color:"success",type:"submit"},{default:a(()=>[D(" Save "),e(C,{icon:"ri-save-line",class:"ms-3"})]),_:1})]),_:1})]),_:1},512)]),_:1})]),_:1})}}},ye=n("div",{class:"d-flex justify-between align-center"},[n("div",{class:"w-100"},[n("h4",null,"Finished Activities")])],-1),ge=n("thead",null,[n("tr",null,[n("th",{class:"text-uppercase",width:"1%"}," # "),n("th",{class:"text-uppercase",width:"1%"}," No "),n("th",{class:"text-uppercase text-center"},"Timesheet"),n("th",{class:"text-uppercase text-center"},"Activity"),n("th",{class:"text-uppercase text-center"},"Students Name"),n("th",{class:"text-uppercase text-center"},"Mentor/Tutor"),n("th",{class:"text-uppercase text-center"},"Date & Time"),n("th",{class:"text-uppercase text-center"},"Time Spent"),n("th",{class:"text-uppercase text-center"},"Fee/Hours"),n("th",{class:"text-uppercase text-center"},"Total"),n("th",{class:"text-uppercase text-center"},"Cut-Offf Status")])],-1),be={class:"text-center"},xe={key:0},ke=n("tr",null,[n("td",{colspan:"10",class:"text-center"}," Sorry, no data found. ")],-1),De=[ke],we={class:"d-flex justify-center mt-5"},je={__name:"pre",setup(P){const V=f(!1),k=f([]),d=f({cut_off:!1,additional_fee:!1,add_bonus:!1,add_existing:!1}),y=f(1),v=f(),p=f([]),m=f(null),_=f(null),x=f([]),o=async()=>{V.value=!0;const i="?page="+y.value,l=m.value?"&keyword="+m.value:"",s=_.value?"&package_id="+_.value:"";try{const u=await A.get("api/v1/payment/unpaid"+i+l+s);u&&(y.value=u.current_page,v.value=u.last_page,k.value=u)}catch(u){console.error(u)}finally{V.value=!1}},g=ne(async()=>{await o()},500),r=async()=>{V.value=!0;try{const i=await A.get("api/v1/package/component/list");i&&(x.value=i,V.value=!1)}catch(i){V.value=!1,console.error(i)}};return ee(()=>{o(),r()}),(i,l)=>(w(),q(Q,null,[e(E,null,{default:a(()=>[e(se,null,{default:a(()=>[ye]),_:1}),e(B,null,{default:a(()=>[e(L,{class:"my-1"},{default:a(()=>[e(T,{cols:"3",md:"4"},{default:a(()=>[e(j,{loading:t(V),disabled:t(V),clearable:"true",label:"Package Name",items:t(x),"item-title":s=>s.type_of+" - "+s.package,"item-value":"id",modelValue:t(_),"onUpdate:modelValue":[l[0]||(l[0]=s=>F(_)?_.value=s:null),o],placeholder:"Select Timesheet Package",density:"compact"},null,8,["loading","disabled","items","item-title","modelValue"])]),_:1}),e(T,{cols:"3",md:"3"},{default:a(()=>[e(R,{loading:t(V),disabled:t(V),"prepend-inner-icon":"ri-search-line",density:"compact",label:"Search","hide-details":"","single-line":"",modelValue:t(m),"onUpdate:modelValue":l[1]||(l[1]=s=>F(m)?m.value=s:null),onInput:t(g)},null,8,["loading","disabled","modelValue","onInput"])]),_:1}),e(T,{cols:"6",md:"5",class:"text-end"},{default:a(()=>[t(p).length>0?(w(),U(h,{key:0,color:"warning",class:"me-1",onClick:l[2]||(l[2]=s=>t(d).add_existing=!0)},{default:a(()=>[e(C,{icon:"ri-add-box-line",class:"me-2"}),D(" Add to Existing Cut-Off ")]),_:1})):O("",!0),e(te,{"close-on-content-click":!1,location:"bottom"},{activator:a(({props:s})=>[e(h,le({color:"light-primary"},s,{class:"me-1"}),{default:a(()=>[D(" Additional Fee "),e(C,{icon:"ri-arrow-down-s-line",class:"ms-2"})]),_:2},1040)]),default:a(()=>[e(de,null,{default:a(()=>[e(X,null,{default:a(()=>[n("div",{class:"cursor-pointer",onClick:l[3]||(l[3]=s=>t(d).additional_fee=!0)},[e(C,{icon:"ri-wallet-2-line",class:"me-2"}),D(" Additional Fee ")])]),_:1}),e(X,null,{default:a(()=>[n("div",{class:"cursor-pointer",onClick:l[4]||(l[4]=s=>t(d).add_bonus=!0)},[e(C,{icon:"ri-wallet-3-line",class:"me-2"}),D(" Add Bonus ")])]),_:1})]),_:1})]),_:1}),t(p).length==0?(w(),U(h,{key:1,color:"secondary",onClick:l[5]||(l[5]=s=>t(d).cut_off=!0)},{default:a(()=>[e(C,{icon:"ri-scissors-cut-line",class:"me-2"}),D(" Cut-Off ")]),_:1})):O("",!0)]),_:1})]),_:1}),t(V)?(w(),U(re,{key:0,class:"mx-auto border",type:"table-thead, table-row@10"})):(w(),U(ue,{key:1,class:"text-no-wrap"},{default:a(()=>{var s,u;return[ge,n("tbody",null,[(w(!0),q(Q,null,ae(t(k).data,(c,M)=>(w(),q("tr",{key:M},[n("td",null,[e(me,{modelValue:t(p),"onUpdate:modelValue":l[6]||(l[6]=b=>F(p)?p.value=b:null),value:c.id},null,8,["modelValue","value"])]),n("td",null,Y(parseInt(M)+1),1),n("td",null,Y(c.package.type+" - "+c.package.name),1),n("td",null,Y(c.activity),1),n("td",null,Y(c.students),1),n("td",null,Y(c.mentor_tutor),1),n("td",null,Y(c.date),1),n("td",null,Y((c.time_spent/60).toFixed(2)+" Hours"),1),n("td",null,"Rp. "+Y(c.fee_hours),1),n("td",null," Rp. "+Y((c.time_spent/60).toFixed(2)*c.fee_hours),1),n("td",be,[e(oe,{color:c.cutoff_status=="not yet"?"#ff0217":"#91c45e"},{default:a(()=>[D(Y(c.cutoff_status.charAt(0).toUpperCase()+c.cutoff_status.slice(1).toLowerCase()),1)]),_:2},1032,["color"])])]))),128))]),((u=(s=t(k))==null?void 0:s.data)==null?void 0:u.length)==0?(w(),q("tfoot",xe,De)):O("",!0)]}),_:1})),n("div",we,[e(ie,{modelValue:t(y),"onUpdate:modelValue":[l[7]||(l[7]=s=>F(y)?y.value=s:null),o],length:t(v),"total-visible":4,color:"primary",density:"compact","show-first-last-page":!1},null,8,["modelValue","length"])])]),_:1}),e(N,{modelValue:t(d).cut_off,"onUpdate:modelValue":l[9]||(l[9]=s=>t(d).cut_off=s),"max-width":"450",persistent:""},{default:a(()=>[e(_e,{onClose:l[8]||(l[8]=s=>t(d).cut_off=!1),onReload:o})]),_:1},8,["modelValue"]),e(N,{modelValue:t(d).add_existing,"onUpdate:modelValue":l[12]||(l[12]=s=>t(d).add_existing=s),"max-width":"450",persistent:"",scrollable:""},{default:a(()=>[e(Ve,{id:t(p),onClose:l[10]||(l[10]=s=>t(d).add_existing=!1),onReload:o,onReset:l[11]||(l[11]=s=>p.value=[])},null,8,["id"])]),_:1},8,["modelValue"])]),_:1}),e(N,{modelValue:t(d).add_bonus,"onUpdate:modelValue":l[14]||(l[14]=s=>t(d).add_bonus=s),"max-width":"450",persistent:""},{default:a(()=>[e(Z,{title:"bonus",onClose:l[13]||(l[13]=s=>t(d).add_bonus=!1),onReload:o})]),_:1},8,["modelValue"]),e(N,{modelValue:t(d).additional_fee,"onUpdate:modelValue":l[16]||(l[16]=s=>t(d).additional_fee=s),"max-width":"450",persistent:""},{default:a(()=>[e(Z,{title:"fee",onClose:l[15]||(l[15]=s=>t(d).additional_fee=!1),onReload:o})]),_:1},8,["modelValue"])],64))}};export{je as default};
