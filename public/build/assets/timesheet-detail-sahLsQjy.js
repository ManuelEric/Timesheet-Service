import{_ as we}from"./DeleteHandler.vue_vue_type_script_setup_true_lang-BwuRF9qs.js";import{r as y,l as le,o as g,f as Y,w as a,b as t,Z as fe,W as E,u as e,v as z,Y as q,V as $,j as T,m as pe,A as N,s as U,ap as _e,e as ve,a as l,x as ne,c as B,F as xe,X as De,t as v,h as Z,z as $e,aq as Ce,k as ue,$ as Te,P as Me,i as Se,ar as Ye,as as Ue,at as ke}from"./main-BuzMx5U7.js";import{r as j}from"./rules-CkvmYWH-.js";import{a as R,c as ge,V as O,b as ee,d as me,e as je}from"./VCard-C1o08_-3.js";import{V as ye}from"./VForm-D1lcg_Hq.js";import{V as ae,a as w}from"./VRow-C9ns1vl1.js";import{V as he}from"./VTextarea-xqhbRiax.js";import{V as te}from"./VDialog-BzhJPmpe.js";import{a as be,V as Q}from"./VTable-C7gYhwWX.js";import{T as de}from"./index-CjsJDqso.js";import{V as Ne}from"./VCheckbox-CVMfoa_I.js";import{V as re}from"./VAutocomplete-LiEG_nbw.js";import{V as Pe}from"./VTooltip-UYEbFLGn.js";import{V as qe}from"./VDivider-Bp9xNwI7.js";import{V as Le,a as ce,b as Ae}from"./VList-C3F52Lml.js";import"./VAvatar-BjwakY9I.js";import"./VImg-BRAc8Qos.js";import"./VCheckboxBtn-DD6lG9_M.js";import"./VSelectionControl-0WkSH_KN.js";import"./VSlideGroup-CPqhb1Pa.js";import"./ssrBoot-CQtp4TWr.js";const Re={__name:"activity-add",props:{id:String},emits:["close","reload"],setup(L,{emit:M}){const c=L,x=M,s=y(!1),b=y(),o=y({activity:null,description:null,date:null,start_time:null,end_time:null,start_date:null,end_date:null,meeting_link:null}),m=()=>{o.value={activity:null,description:null,date:null,start_time:null,end_time:null,start_date:null,end_date:null,meeting_link:null}},V=async()=>{const{valid:D}=await b.value.validate();if(D){s.value=!0;try{const n=await N.post("api/v1/timesheet/"+c.id+"/activity",o.value);n&&U("success",n.message,"bottom-end")}catch(n){U("error",n.response.data.errors,"bottom-end")}finally{m(),s.value=!1,x("reload"),x("close")}}};return(D,n)=>{const C=le("DialogCloseBtn"),f=le("VDateInput");return g(),Y(O,{title:"New Activity"},{default:a(()=>[t(C,{variant:"text",size:"default",onClick:n[0]||(n[0]=i=>x("close"))}),t(R,null,{default:a(()=>[t(ye,{onSubmit:fe(V,["prevent"]),ref_key:"formData",ref:b,"validate-on":"input"},{default:a(()=>[t(ae,null,{default:a(()=>[t(w,{cols:"12",class:"d-none"},{default:a(()=>[t(E,{density:"compact",modelValue:e(o).activity,"onUpdate:modelValue":n[1]||(n[1]=i=>e(o).activity=i),label:"Activity Name",placeholder:"Activity",loading:e(s),disabled:e(s)},null,8,["modelValue","loading","disabled"])]),_:1}),t(w,{cols:"12"},{default:a(()=>[t(he,{density:"compact",modelValue:e(o).description,"onUpdate:modelValue":n[2]||(n[2]=i=>e(o).description=i),label:"Meeting Discussion",placeholder:"Meeting Discussion",loading:e(s),disabled:e(s),rules:e(j).required},null,8,["modelValue","loading","disabled","rules"])]),_:1}),t(w,{md:"6",cols:"12"},{default:a(()=>[t(f,{density:"compact",modelValue:e(o).date,"onUpdate:modelValue":n[3]||(n[3]=i=>e(o).date=i),label:"Date",placeholder:"Select Date",variant:"outlined","prepend-icon":"",loading:e(s),disabled:e(s),rules:e(j).required},null,8,["modelValue","loading","disabled","rules"])]),_:1}),t(w,{md:"3",cols:"6"},{default:a(()=>[t(E,{density:"compact",type:"time",modelValue:e(o).start_time,"onUpdate:modelValue":n[4]||(n[4]=i=>e(o).start_time=i),label:"Start Time",placeholder:"Start Time",rules:e(j).required,class:"mb-3",loading:e(s),disabled:!e(o).date||e(s),onChange:n[5]||(n[5]=i=>e(o).start_date=e(z)(e(o).date).format("YYYY-MM-DD")+" "+e(o).start_time+":00")},null,8,["modelValue","rules","loading","disabled"])]),_:1}),t(w,{md:"3",cols:"6"},{default:a(()=>[t(E,{density:"compact",type:"time",modelValue:e(o).end_time,"onUpdate:modelValue":n[6]||(n[6]=i=>e(o).end_time=i),label:"End Time",placeholder:"End Time",loading:e(s),disabled:!e(o).date||e(s),onChange:n[7]||(n[7]=i=>e(o).end_date=e(z)(e(o).date).format("YYYY-MM-DD")+" "+e(o).end_time+":00")},null,8,["modelValue","loading","disabled"])]),_:1}),t(w,{md:"12",cols:"12"},{default:a(()=>[t(E,{density:"compact",type:"text",modelValue:e(o).meeting_link,"onUpdate:modelValue":n[8]||(n[8]=i=>e(o).meeting_link=i),label:"Meeting Link",placeholder:"Meeting Link",loading:e(s),disabled:e(s)},null,8,["modelValue","loading","disabled"])]),_:1})]),_:1}),t(ge,{class:"mt-5"},{default:a(()=>[t(q,{variant:"tonal",type:"button",color:"error",loading:e(s),disabled:e(s),onClick:n[9]||(n[9]=i=>x("close"))},{default:a(()=>[t($,{icon:"ri-close-line",class:"me-3"}),T(" Close ")]),_:1},8,["loading","disabled"]),t(pe),t(q,{variant:"tonal",type:"submit",color:"success",loading:e(s),disabled:e(s)},{default:a(()=>[T(" Save "),t($,{icon:"ri-save-line",class:"ms-3"})]),_:1},8,["loading","disabled"])]),_:1})]),_:1},512)]),_:1})]),_:1})}}},Be={__name:"activity-edit",props:{timesheet_id:Number,activity:String},emits:["close","reload"],setup(L,{emit:M}){const c=y(!1),x=y(),s=L,b=M,o=_e("updateReload"),m=y({activity:s==null?void 0:s.activity.activity,description:s==null?void 0:s.activity.description,date:new Date(s==null?void 0:s.activity.start_date),start_time:s==null?void 0:s.activity.start_time,end_time:s==null?void 0:s.activity.end_time,start_date:z(s==null?void 0:s.activity.start_date).format("YYYY-MM-DD")+" "+(s==null?void 0:s.activity.start_time)+":00",end_date:(s==null?void 0:s.activity.end_time)!=0?z(s==null?void 0:s.activity.start_date).format("YYYY-MM-DD")+" "+(s==null?void 0:s.activity.end_time)+":00":null,meeting_link:s==null?void 0:s.activity.meeting_link}),V=async()=>{var n,C;const{valid:D}=await x.value.validate();if(D){c.value=!0;try{m.value.start_date=z(m.value.date).format("YYYY-MM-DD")+" "+m.value.start_time+":00",m.value.end_date=z(m.value.date).format("YYYY-MM-DD")+" "+m.value.end_time+":00";const f=await N.put("api/v1/timesheet/"+s.timesheet_id+"/activity/"+s.activity.id,m.value);f&&(U("success",f.message,"bottom-end"),b("reload"))}catch(f){if((C=(n=f==null?void 0:f.response)==null?void 0:n.data)!=null&&C.errors){const i=f.response.data.errors;let u="Validation errors:";if(typeof i!="string"){for(const r in i)i.hasOwnProperty(r)&&(u+=`
${r}: ${i[r].join(", ")}`);U("error",u,"bottom-end")}else U("error",f.response.data.errors,"bottom-end")}}finally{c.value=!1,b("close"),setTimeout(()=>{o(!0)},3e3)}}};return(D,n)=>{const C=le("DialogCloseBtn"),f=le("VDateInput");return g(),Y(O,{title:"Edit Activity"},{default:a(()=>[t(C,{variant:"text",size:"default",onClick:n[0]||(n[0]=i=>b("close"))}),t(R,null,{default:a(()=>[t(ye,{onSubmit:fe(V,["prevent"]),ref_key:"formData",ref:x,"validate-on":"input"},{default:a(()=>[t(ae,null,{default:a(()=>[t(w,{cols:"12",class:"d-none"},{default:a(()=>[t(E,{density:"compact",modelValue:e(m).activity,"onUpdate:modelValue":n[1]||(n[1]=i=>e(m).activity=i),label:"Activity Name",placeholder:"Activity",disabled:e(c),loading:e(c)},null,8,["modelValue","disabled","loading"])]),_:1}),t(w,{cols:"12"},{default:a(()=>[t(he,{density:"compact",modelValue:e(m).description,"onUpdate:modelValue":n[2]||(n[2]=i=>e(m).description=i),label:"Meeting Discussion",rules:e(j).required,placeholder:"Meeting Discussion",disabled:e(c),loading:e(c)},null,8,["modelValue","rules","disabled","loading"])]),_:1}),t(w,{md:"6",cols:"12"},{default:a(()=>[t(f,{density:"compact",modelValue:e(m).date,"onUpdate:modelValue":n[3]||(n[3]=i=>e(m).date=i),label:"Date",placeholder:"Select Date","prepend-icon":"",disabled:e(c),loading:e(c),rules:e(j).required},null,8,["modelValue","disabled","loading","rules"])]),_:1}),t(w,{md:"3",cols:"6"},{default:a(()=>[t(E,{density:"compact",type:"time",modelValue:e(m).start_time,"onUpdate:modelValue":n[4]||(n[4]=i=>e(m).start_time=i),label:"Start Time",rules:e(j).required,placeholder:"Start Time",disabled:e(c),loading:e(c),onChange:n[5]||(n[5]=i=>e(m).start_date=e(z)(s==null?void 0:s.activity.date).format("YYYY-MM-DD")+" "+e(m).start_time+":00")},null,8,["modelValue","rules","disabled","loading"])]),_:1}),t(w,{md:"3",cols:"6"},{default:a(()=>[t(E,{density:"compact",type:"time",modelValue:e(m).end_time,"onUpdate:modelValue":n[6]||(n[6]=i=>e(m).end_time=i),label:"End Time",placeholder:"End Time",disabled:e(c),loading:e(c),onChange:n[7]||(n[7]=i=>e(m).end_date=e(z)(s==null?void 0:s.activity.date).format("YYYY-MM-DD")+" "+e(m).end_time+":00")},null,8,["modelValue","disabled","loading"])]),_:1}),t(w,{md:"12",cols:"12"},{default:a(()=>[t(E,{density:"compact",type:"text",modelValue:e(m).meeting_link,"onUpdate:modelValue":n[8]||(n[8]=i=>e(m).meeting_link=i),label:"Meeting Link",placeholder:"Meeting Link",disabled:e(c),loading:e(c)},null,8,["modelValue","disabled","loading"])]),_:1})]),_:1}),t(ge,{class:"mt-5"},{default:a(()=>[t(q,{variant:"tonal",color:"error",disabled:e(c),loading:e(c),onClick:n[9]||(n[9]=i=>b("close"))},{default:a(()=>[t($,{icon:"ri-close-line",class:"me-3"}),T(" Close ")]),_:1},8,["disabled","loading"]),t(pe),t(q,{variant:"tonal",color:"success",type:"submit",disabled:e(c),loading:e(c)},{default:a(()=>[T(" Save "),t($,{icon:"ri-save-line",class:"ms-3"})]),_:1},8,["disabled","loading"])]),_:1})]),_:1},512)]),_:1})]),_:1})}}},Ee={class:"d-flex justify-between align-center"},Fe=l("div",{class:"w-100"},[l("h4",null,"Activity")],-1),Ie=l("thead",null,[l("tr",null,[l("th",{class:"text-uppercase",width:"1%"}," No "),l("th",{class:"text-uppercase text-center"},"Meeting Discussion"),l("th",{class:"text-uppercase text-center"},"Date"),l("th",{class:"text-uppercase text-center"},"Start Time"),l("th",{class:"text-uppercase text-center"},"End Time"),l("th",{class:"text-uppercase text-center"},"Time Spent"),l("th",{class:"text-uppercase text-center"},"Status"),l("th",{class:"text-uppercase text-end"},"#")])],-1),ze={key:0},Oe=l("tr",null,[l("th",{colspan:"8",class:"text-center"}," No Activity Found ")],-1),Ge=[Oe],He={key:1},Je={width:"1%"},We={class:"d-none"},Xe={class:"text-start"},Ze={class:"text-center"},Ke={class:"text-center"},Qe={class:"text-center"},et={class:"text-end"},tt=["href"],lt={__name:"timesheet-detail",props:{id:String},setup(L){const M=L,c=_e("updateReload"),x=y([]),s=y(!1),b=y([{add:!1,edit:!1,delete:!1}]),o=y([]),m=async()=>{s.value=!0;try{const f=await N.get("api/v1/timesheet/"+M.id+"/activities");f&&(x.value=f)}catch(f){console.error(f)}finally{s.value=!1}},V=f=>{b.value[f]?b.value[f]=!1:b.value[f]=!0},D=(f,i)=>{o.value=i,V(f)},n=async()=>{var f,i,u;s.value=!0;try{const r=await N.delete("api/v1/timesheet/"+M.id+"/activity/"+o.value.id);r&&(U("success",r.message,"bottom-end"),V("delete"))}catch(r){((f=r.response)==null?void 0:f.status)==400&&U("error",(u=(i=r.response)==null?void 0:i.data)==null?void 0:u.errors,"bottom-end")}finally{s.value=!1,m(),c(!0)}},C=async f=>{var i,u;try{const r=await N.patch("api/v1/timesheet/"+M.id+"/activity/"+f.id,f);r&&U("success",r.message,"bottom-end")}catch(r){if((u=(i=r==null?void 0:r.response)==null?void 0:i.data)!=null&&u.errors){const d=r.response.data.errors;let _="Validation errors:";if(typeof d!="string"){for(const p in d)d.hasOwnProperty(p)&&(_+=`
${p}: ${d[p].join(", ")}`);U("error",_,"bottom-end")}else U("error",r.response.data.errors,"bottom-end")}}finally{m(),c(!0)}};return ve(()=>{m()}),(f,i)=>(g(),Y(O,null,{default:a(()=>[t(ee,null,{default:a(()=>[l("div",Ee,[Fe,ne((g(),Y(q,{onClick:i[0]||(i[0]=u=>V("add"))},{default:a(()=>[t($,{icon:"ri-add-line"})]),_:1})),[[de,"New Activity","start"]]),t(te,{modelValue:e(b).add,"onUpdate:modelValue":i[2]||(i[2]=u=>e(b).add=u),"max-width":"600",persistent:""},{default:a(()=>[t(Re,{id:M.id,onClose:i[1]||(i[1]=u=>V("add")),onReload:m},null,8,["id"])]),_:1},8,["modelValue"])])]),_:1}),t(R,null,{default:a(()=>[e(s)?(g(),Y(Q,{key:1,type:"table"})):(g(),Y(be,{key:0,class:"text-no-wrap","max-height":"400","fixed-header":""},{default:a(()=>{var u;return[Ie,((u=e(x))==null?void 0:u.length)==0?(g(),B("tbody",ze,Ge)):(g(),B("tbody",He,[(g(!0),B(xe,null,De(e(x),(r,d)=>(g(),B("tr",{key:d},[l("td",Je,v(d+1),1),l("td",We,v(r.activity),1),l("td",Xe,v(r.description),1),l("td",null,v(f.$moment(r.start_date).format("dddd"))+", "+v(f.$moment(r.start_date).format("MMM Do YYYY")),1),l("td",Ze,v(r.start_time),1),l("td",Ke,v(r.end_time),1),l("td",Qe,[t($,{icon:"ri-timer-2-line",class:"cursor-pointer me-3"}),T(" "+v(r.estimate)+" Minutes ",1)]),l("td",null,[ne(t(Ne,{color:"success",modelValue:r.status,"onUpdate:modelValue":[_=>r.status=_,_=>C(r)],value:!0,"false-value":!1},null,8,["modelValue","onUpdate:modelValue"]),[[de,r.status?"Completed":"Not Yet","start"]])]),l("td",et,[r.meeting_link?(g(),Y(q,{key:0,color:"primary",density:"compact",class:"me-1"},{default:a(()=>[l("a",{href:r.meeting_link,target:"_blank",class:"bg-primary"},[t($,{icon:"ri ri-link"}),T(" Join ")],8,tt)]),_:2},1024)):Z("",!0),ne((g(),Y(q,{color:"warning",density:"compact",class:"me-1",onClick:_=>D("edit",r)},{default:a(()=>[t($,{icon:"ri-edit-line",class:"cursor-pointer"})]),_:2},1032,["onClick"])),[[de,"Edit Activity","start"]]),ne((g(),Y(q,{color:"error",density:"compact",onClick:_=>D("delete",r)},{default:a(()=>[t($,{icon:"ri-delete-bin-line",class:"cursor-pointer"})]),_:2},1032,["onClick"])),[[de,"Delete Activity","start"]])])]))),128))]))]}),_:1}))]),_:1}),t(te,{modelValue:e(b).edit,"onUpdate:modelValue":i[4]||(i[4]=u=>e(b).edit=u),"max-width":"600",persistent:""},{default:a(()=>[t(Be,{timesheet_id:M==null?void 0:M.id,activity:e(o),onClose:i[3]||(i[3]=u=>V("edit")),onReload:m},null,8,["timesheet_id","activity"])]),_:1},8,["modelValue"]),t(te,{modelValue:e(b).delete,"onUpdate:modelValue":i[6]||(i[6]=u=>e(b).delete=u),"max-width":"400",persistent:""},{default:a(()=>[t(we,{title:"activity",loading:e(s),onClose:i[5]||(i[5]=u=>V("delete")),onDelete:n},null,8,["loading"])]),_:1},8,["modelValue"])]),_:1}))}},at={__name:"timesheet-transfer",props:{timesheet_id:Number,require:String},emits:["close","reload"],setup(L,{emit:M}){const c=y(),x=L,s=M,b=y([]),o=y([]),m=y([]),V=x.require.toLowerCase(),D=y(!1),n=y({mentortutor_email:null,subject_id:null}),C=async()=>{const u="api/v1/user/mentor-tutors?role="+V;D.value=!0;try{const r=await N.get(u);r&&(b.value=r)}catch(r){console.error(r)}finally{D.value=!1}},f=async(u,r=null)=>{if(n.value.subject_id=null,V=="mentor")n.value.subject_id=u[0].subjects[0].id;else{D.value=!0;try{const d=await N.get("api/v1/user/mentor-tutors/"+r+"/subjects");d&&(m.value=d)}catch(d){console.error(d)}finally{D.value=!1}}},i=async()=>{var d,_;s("close"),n.value.mentortutor_email=o.value.email;const{valid:u}=await c.value.validate(),r=await Ce("Are you sure you want to change the owner?");if(u&&r){D.value=!0;try{const p=await N.patch("api/v1/timesheet/"+x.timesheet_id+"/void/",n.value);p&&(U("success",p.message,"bottom-end"),ue.push({path:"/admin/timesheet/"+p.data.timesheet_id}),n.value={mentortutor_email:null,subject_id:null},o.value=[],setTimeout(()=>{ue.go(0)},1e3))}catch(p){if(console.log(p),(_=(d=p==null?void 0:p.response)==null?void 0:d.data)!=null&&_.errors){const I=p.response.data.errors;U("error",I,"bottom-end")}}finally{s("close"),D.value=!1}}};return ve(()=>{C()}),(u,r)=>(g(),Y(O,{class:"mx-auto my-8",elevation:"16",width:"450"},{default:a(()=>[t(ye,{ref_key:"formData",ref:c,"validate-on":"input",onSubmit:fe(i,["prevent"])},{default:a(()=>[t(me,null,{default:a(()=>[t(ee,null,{default:a(()=>[T(" Timesheet Ownership Transfer ")]),_:1}),t(je,null,{default:a(()=>[T(" Change Timesheet Handler ")]),_:1})]),_:1}),t(R,null,{default:a(()=>[t(ae,null,{default:a(()=>{var d;return[t(w,{md:"12"},{default:a(()=>[t(re,{clearable:"",modelValue:e(o),"onUpdate:modelValue":[r[0]||(r[0]=_=>$e(o)?o.value=_:null),r[1]||(r[1]=_=>f(e(o).roles,e(o).uuid))],label:"Mentor/Tutor",items:e(b),"item-props":_=>({title:_.full_name,subtitle:_.roles.map(p=>p.name).join(", ")}),rules:e(j).required,loading:e(D),disabled:e(D)},null,8,["modelValue","items","item-props","rules","loading","disabled"])]),_:1}),((d=x.require)==null?void 0:d.toLowerCase())=="tutor"?(g(),Y(w,{key:0,md:"12"},{default:a(()=>[t(re,{clearable:"",modelValue:e(n).subject_id,"onUpdate:modelValue":r[2]||(r[2]=_=>e(n).subject_id=_),label:"Subject Tutoring",items:e(m),"item-title":"subject","item-value":"id",loading:e(D),disabled:e(D),rules:e(j).required},null,8,["modelValue","items","loading","disabled","rules"])]),_:1})):Z("",!0)]}),_:1})]),_:1}),t(ge,{class:"mx-3 mb-3"},{default:a(()=>[t(q,{color:"error",onClick:r[3]||(r[3]=d=>s("close"))},{default:a(()=>[t($,{icon:"ri-close-line",class:"me-3"}),T(" Close ")]),_:1}),t(pe),t(q,{color:"success",type:"submit"},{default:a(()=>[T(" Save Changes "),t($,{icon:"ri-save-line",class:"ms-3"})]),_:1})]),_:1})]),_:1},512)]),_:1}))}},it={__name:"user-edit",props:["id","item","package_id"],emits:["close","reload"],setup(L,{emit:M}){var F,H,J,W,X,ie,se,Ve;const c=L,x=M,s=y([]),b=y([]),o=y([]),m=y([]),V=y(!1),D=y(!0),n=y(!0),C=y(null),f=y(),i=y({mentortutor_email:(F=c.item)==null?void 0:F.tutormentor_email,subject_id:(H=c.item)==null?void 0:H.subject_id,inhouse_id:(J=c.item)==null?void 0:J.inhouse_id,package_id:c.package_id,duration:(W=c.item)==null?void 0:W.duration,notes:(X=c.item)==null?void 0:X.notes,pic_id:(ie=c.item)==null?void 0:ie.pic_id,tax:(se=c.item)==null?void 0:se.tax,individual_fee:Math.ceil((Ve=c.item)==null?void 0:Ve.individual_fee)}),u=async(S=!1)=>{n.value=!0;const h=S?"api/v1/user/mentor-tutors?inhouse=true":"api/v1/user/mentor-tutors";try{const A=await N.get(h);A&&(S?m.value=Object.values(A):s.value=A)}catch(A){console.error(A)}finally{n.value=!1}},r=async()=>{n.value=!0;try{const S=await N.get("api/v1/package/component/list");S&&(b.value=S)}catch(S){console.error(S)}finally{n.value=!1}},d=()=>{const S=i.value.package_id,h=b.value.findIndex(P=>P.id===S);let A=b.value[h];A.detail?(V.value=!0,i.value.duration=A.detail):(V.value=!1,i.value.duration=null)},_=async()=>{n.value=!0;try{const S=await N.get("api/v1/user/component/list");S&&(o.value=S)}catch(S){console.error(S)}finally{n.value=!1}},p=async()=>{var h,A;const{valid:S}=await f.value.validate();if(S)try{const P=await N.put("api/v1/timesheet/"+c.id+"/update",i.value);P&&(i.value={mentortutor_email:null,subject_id:null,inhouse_id:null,package_id:null,duration:"",notes:"",pic_id:[]},U("success",P.message,"bottom-end"),x("reload"))}catch(P){if((A=(h=P==null?void 0:P.response)==null?void 0:h.data)!=null&&A.errors){const K=P.response.data.errors;let oe="Validation errors:";for(const k in K)K.hasOwnProperty(k)&&(oe+=`
${k}: ${K[k].join(", ")}`);U("error",oe,"bottom-end")}}finally{x("close")}},I=()=>{if(i.value.individual_fee){const S=i.value.individual_fee*(1-i.value.tax/100);C.value=Math.ceil(S)}else C.value=null},G=()=>{const S=C.value/(1-i.value.tax/100);i.value.individual_fee=Math.ceil(S)};return ve(()=>{u(!0),r(),_(),I(),setTimeout(()=>{D.value=!1},2e3)}),(S,h)=>{const A=le("DialogCloseBtn");return g(),Y(O,{title:"Edit Detail"},{default:a(()=>[t(A,{variant:"text",size:"default",onClick:h[0]||(h[0]=P=>x("close"))}),t(R,null,{default:a(()=>[t(ye,{onSubmit:fe(p,["prevent"]),ref_key:"formData",ref:f,"validate-on":"input"},{default:a(()=>[t(ae,null,{default:a(()=>{var P,K,oe;return[t(w,{md:"8",cols:"8"},{default:a(()=>[t(re,{density:"compact",clearable:"",label:"Package",modelValue:e(i).package_id,"onUpdate:modelValue":[h[1]||(h[1]=k=>e(i).package_id=k),d],items:e(b),"item-props":k=>({title:k.package!=null?k.type_of+" - "+k.package:k.type_of}),"item-value":"id",rules:e(j).required,loading:e(n),disabled:e(n)},null,8,["modelValue","items","item-props","rules","loading","disabled"])]),_:1}),t(w,{md:"4",cols:"4"},{default:a(()=>[t(E,{type:"number",clearable:"",label:+e(i).duration/60?"Minutes ("+e(i).duration/60+" Hours)":"Minutes",readonly:e(V),modelValue:e(i).duration,"onUpdate:modelValue":h[2]||(h[2]=k=>e(i).duration=k),rules:e(j).required},null,8,["label","readonly","modelValue","rules"])]),_:1}),t(w,{md:"12",cols:"12"},{default:a(()=>[t(re,{density:"compact",clearable:"",modelValue:e(i).inhouse_id,"onUpdate:modelValue":h[3]||(h[3]=k=>e(i).inhouse_id=k),label:"Inhouse Mentor/Tutor",items:e(m),"item-props":k=>({title:k.full_name}),"item-value":"uuid",rules:e(j).required,loading:e(n),disabled:e(n)},null,8,["modelValue","items","item-props","rules","loading","disabled"])]),_:1}),(P=c.item)!=null&&P.individual_fee?(g(),Y(w,{key:0,md:"4",cols:"7"},{default:a(()=>[t(E,{type:"number",clearable:"",label:"Fee/hours (Nett)",modelValue:e(C),"onUpdate:modelValue":[h[4]||(h[4]=k=>$e(C)?C.value=k:null),G],density:"compact",rules:e(j).required},null,8,["modelValue","rules"])]),_:1})):Z("",!0),(K=c.item)!=null&&K.individual_fee?(g(),Y(w,{key:1,md:"4",cols:"5"},{default:a(()=>[t(E,{type:"number",clearable:"",label:"Tax",modelValue:e(i).tax,"onUpdate:modelValue":[h[5]||(h[5]=k=>e(i).tax=k),G],rules:e(j).required,density:"compact"},null,8,["modelValue","rules"])]),_:1})):Z("",!0),(oe=c.item)!=null&&oe.individual_fee?(g(),Y(w,{key:2,md:"4",cols:"12"},{default:a(()=>[t(Pe,{activator:"parent",location:"top"},{default:a(()=>[T(" Fee Gross is automatically calculated based on the entered Net Fee and Tax Rate. ")]),_:1}),t(E,{type:"number",clearable:"",label:"Fee/hours (Gross)",modelValue:e(i).individual_fee,"onUpdate:modelValue":[h[6]||(h[6]=k=>e(i).individual_fee=k),I],density:"compact",readonly:"",rules:e(j).required},null,8,["modelValue","rules"])]),_:1})):Z("",!0),t(w,{md:"12",cols:"12"},{default:a(()=>[t(re,{density:"compact",multiple:"",clearable:"",chips:"",label:"PIC",modelValue:e(i).pic_id,"onUpdate:modelValue":h[7]||(h[7]=k=>e(i).pic_id=k),items:e(o),"item-title":"full_name","item-value":"id",rules:e(j).required,loading:e(n),disabled:e(n)},null,8,["modelValue","items","rules","loading","disabled"])]),_:1}),t(w,{md:"12",cols:"12"},{default:a(()=>[t(he,{density:"compact",label:"Notes",modelValue:e(i).notes,"onUpdate:modelValue":h[8]||(h[8]=k=>e(i).notes=k)},null,8,["modelValue"])]),_:1})]}),_:1}),t(qe,{class:"my-3 px-0"}),t(ge,null,{default:a(()=>[t(q,{variant:"tonal",color:"error",type:"button",onClick:h[9]||(h[9]=P=>x("close"))},{default:a(()=>[t($,{icon:"ri-close-line",class:"me-3"}),T(" Close ")]),_:1}),t(pe),t(q,{variant:"tonal",color:"success",type:"submit"},{default:a(()=>[T(" Save "),t($,{icon:"ri-save-line",class:"ms-3"})]),_:1})]),_:1})]),_:1},512)]),_:1})]),_:1})}}},st={class:"w-100"},ot={class:"mt-3 font-weight-light"},nt=l("hr",{class:"my-2"},null,-1),dt={key:0},rt=l("tr",{class:"bg-secondary"},[l("td",null,"Name"),l("td",null,"School"),l("td",null,"Grade")],-1),ut={key:1},ct=l("td",{width:"20%"},"Name",-1),mt=l("td",{width:"1%"},":",-1),_t=l("td",null,"School Name",-1),ft=l("td",{width:"1%"},":",-1),pt=l("td",null,"Grade",-1),vt=l("td",{width:"1%"},":",-1),gt=l("td",null,"Email",-1),yt=l("td",{width:"1%"},":",-1),bt={class:"mt-5 font-weight-light"},ht=l("hr",{class:"my-2"},null,-1),Vt={width:"30%"},kt=l("td",{width:"1%"},":",-1),wt={key:0},xt={key:1},Dt=l("td",null,"Package",-1),$t=l("td",{width:"1%"},":",-1),Ct=l("td",null,"Person in Charge",-1),Tt=l("td",{width:"1%"},":",-1),Mt=l("td",{width:"1%"},":",-1),St=l("td",{width:"1%"},":",-1),Yt=l("td",null,"Notes",-1),Ut=l("td",{width:"1%"},":",-1),jt=l("td",null,"Update On",-1),Nt=l("td",{width:"1%"},":",-1),Pt={class:"d-flex align-end w-100"},qt={class:"m-0 mb-1 text-white"},Lt=l("h4",{class:"m-0 ms-2 text-white"},"Minutes",-1),At={class:"text-end w-100"},Rt={class:"d-flex align-end w-100"},Bt={class:"m-0 mb-1 text-white"},Et=l("h4",{class:"m-0 ms-2 text-white"},"Minutes",-1),Ft={class:"text-end w-100"},It={class:"d-flex align-end w-100"},zt={class:"m-0 mb-1 text-white"},Ot=l("h4",{class:"m-0 ms-2 text-white"},"Minutes",-1),Gt={class:"text-end w-100"},Ht={__name:"user-detail",props:{id:String,name:String},emits:["void"],setup(L,{emit:M}){const c=L,x=M,s=_e("reloadData"),b=_e("updateReload"),o=y([]),m=y([{edit:!1,void:!1,delete:!1}]),V=y(!1),D=async i=>{var u,r,d;V.value=!0;try{const _=await N.get("api/v1/timesheet/"+i+"/detail");_&&(o.value=_,x("void",_.packageDetails.void))}catch(_){((u=_.response)==null?void 0:u.status)==400&&(U("error",(d=(r=_.response)==null?void 0:r.data)==null?void 0:d.errors,"bottom-end"),ue.push("/admin/timesheet")),console.log(_)}finally{V.value=!1}},n=async()=>{var i,u,r;V.value=!0;try{const d=await N.delete("api/v1/timesheet/"+c.id+"/delete");d&&(o.value=d,U("success",d.message,"bottom-end"),m.value.delete=!1,ue.push("/admin/timesheet/tutoring"))}catch(d){((i=d.response)==null?void 0:i.status)==400&&U("error",(r=(u=d.response)==null?void 0:u.data)==null?void 0:r.errors,"bottom-end")}finally{V.value=!1}},C=i=>{m.value[i]?m.value[i]=!1:m.value[i]=!0},f=async(i,u)=>{var r;Ye();try{const d=await N.get("api/v1/timesheet/"+i+"/export",{responseType:"blob"});if(d){const _=window.URL.createObjectURL(new Blob([d],{type:'"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"'})),p=document.createElement("a");p.href=_,p.setAttribute("download",`Timesheet_${u}.xlsx`),document.body.appendChild(p),p.click(),document.body.removeChild(p),window.URL.revokeObjectURL(_),Ue.close()}}catch(d){U("error",(r=d.response)==null?void 0:r.statusText,"bottom-end"),console.log(d)}};return ve(()=>{D(c.id)}),Te(()=>{s.value&&(D(c.id),b(!1))}),(i,u)=>{const r=le("router-link");return g(),Y(O,{class:"mb-3"},{default:a(()=>[e(V)?(g(),Y(Q,{key:0,type:"heading"})):(g(),Y(ee,{key:1,class:"d-flex justify-between align-center"},{default:a(()=>{var d,_,p,I,G;return[l("div",st,[t(r,{to:"/admin/timesheet/"+c.name},{default:a(()=>[t($,{icon:"ri-arrow-left-line",color:"secondary",class:"me-2",size:"25"})]),_:1},8,["to"]),T(" "+v((d=e(o).packageDetails)==null?void 0:d.tutormentor_name)+" | "+v(((p=(_=e(o))==null?void 0:_.packageDetails)==null?void 0:p.package_type)+" - "+((G=(I=e(o))==null?void 0:I.packageDetails)==null?void 0:G.package_name)),1)]),l("div",null,[t(Se,{"close-on-content-click":!1,location:"bottom"},{activator:a(({props:F})=>[ne((g(),Y(q,Me({color:"secondary"},F),{default:a(()=>[t($,{icon:"ri-settings-3-line"})]),_:2},1040)),[[de,"Settings","start"]])]),default:a(()=>[t(Le,null,{default:a(()=>[t(ce,null,{default:a(()=>[l("div",{class:"cursor-pointer",onClick:u[0]||(u[0]=F=>C("edit"))},[t($,{icon:"ri-pencil-line",class:"me-2"}),T(" Edit TimeSheet ")])]),_:1}),t(ce,null,{default:a(()=>[l("div",{class:"cursor-pointer",onClick:u[1]||(u[1]=F=>C("void"))},[t($,{icon:"ri-exchange-2-line",class:"me-2"}),T(" Timesheet Ownership Transfer ")])]),_:1}),t(ce,null,{default:a(()=>[t(Ae,null,{default:a(()=>[l("div",{class:"cursor-pointer",onClick:u[2]||(u[2]=F=>{var H,J,W,X,ie,se;return f(c.id,((J=(H=e(o))==null?void 0:H.packageDetails)==null?void 0:J.package_type)+"-"+((X=(W=e(o))==null?void 0:W.packageDetails)==null?void 0:X.package_name)+"_"+((se=(ie=e(o))==null?void 0:ie.packageDetails)==null?void 0:se.tutormentor_name))})},[t($,{icon:"ri-download-line",class:"me-2"}),T(" Download TimeSheet ")])]),_:1})]),_:1}),t(ce,null,{default:a(()=>[l("div",{class:"cursor-pointer",onClick:u[3]||(u[3]=F=>C("delete"))},[t($,{icon:"ri-delete-bin-line",class:"me-2"}),T(" Delete TimeSheet ")])]),_:1})]),_:1})]),_:1})])]}),_:1})),t(R,null,{default:a(()=>[e(V)?(g(),Y(ae,{key:1},{default:a(()=>[t(w,{md:"7"},{default:a(()=>[t(Q,{type:"heading, paragraph, heading, paragraph",class:"mb-3"})]),_:1}),t(w,{md:"5"},{default:a(()=>[t(Q,{type:"text@3",color:"#16B1FF",class:"mb-3"}),t(Q,{type:"text@3",color:"#91c45e",class:"mb-3"}),t(Q,{type:"text@3",color:"#e05e5e",class:"mb-3"})]),_:1})]),_:1})):(g(),Y(ae,{key:0,align:"center"},{default:a(()=>[t(w,{md:"7"},{default:a(()=>[l("h4",ot,[t($,{icon:"ri-user-line",size:"17",class:"me-2"}),T(" Basic Profile ")]),nt,t(be,{density:"compact"},{default:a(()=>{var d,_;return[((d=e(o).clientProfile)==null?void 0:d.length)>1?(g(),B("tbody",dt,[rt,(g(!0),B(xe,null,De(e(o).clientProfile,p=>(g(),B("tr",null,[l("td",null,v(p.client_name),1),l("td",null,v(p.client_school),1),l("td",null,v(p.client_grade<=12?p.client_grade:"Not High School"),1)]))),256))])):((_=e(o).clientProfile)==null?void 0:_.length)==1?(g(),B("tbody",ut,[l("tr",null,[ct,mt,l("td",null,v(e(o).clientProfile[0].client_name),1)]),l("tr",null,[_t,ft,l("td",null,v(e(o).clientProfile[0].client_school),1)]),l("tr",null,[pt,vt,l("td",null,v(e(o).clientProfile[0].client_grade<=12?e(o).clientProfile[0].client_grade:"Not High School"),1)]),l("tr",null,[gt,yt,l("td",null,v(e(o).clientProfile[0].client_mail),1)])])):Z("",!0)]}),_:1}),l("h4",bt,[t($,{icon:"ri-bookmark-line",class:"me-2",size:"17"}),T(" Package Details ")]),ht,t(be,{density:"compact"},{default:a(()=>{var d,_,p,I,G,F,H,J,W,X;return[l("tbody",null,[l("tr",null,[l("td",Vt,v(c.name=="tutoring"?"Program Name":"Engagement Type"),1),kt,c.name=="tutoring"?(g(),B("td",wt,v((d=e(o).packageDetails)!=null&&d.free_trial?"[TRIAL]":"")+" "+v((_=e(o).packageDetails)==null?void 0:_.program_name),1)):(g(),B("td",xt,v((p=e(o).packageDetails)==null?void 0:p.engagement_type),1))]),l("tr",null,[Dt,$t,l("td",null,v((I=e(o).packageDetails)==null?void 0:I.package_type)+" "+v((G=e(o).packageDetails)!=null&&G.package_name?" - "+((F=e(o).packageDetails)==null?void 0:F.package_name):""),1)]),l("tr",null,[Ct,Tt,l("td",null,v((H=e(o).packageDetails)==null?void 0:H.pic_name),1)]),l("tr",null,[l("td",null,v(c.name=="tutoring"?"Tutor":"Mentor")+" Name",1),Mt,l("td",null,v((J=e(o).packageDetails)==null?void 0:J.tutormentor_name),1)]),l("tr",null,[l("td",null,"Inhouse "+v(c.name=="tutoring"?"Tutor":"Mentor"),1),St,l("td",null,v((W=e(o).packageDetails)==null?void 0:W.inhouse_name),1)]),l("tr",null,[Yt,Ut,l("td",null,v((X=e(o).editableColumns)==null?void 0:X.notes),1)]),l("tr",null,[jt,Nt,l("td",null,v(e(z)().format("LLL")),1)])])]}),_:1})]),_:1}),t(w,{md:"5"},{default:a(()=>[t(O,{color:"#16B1FF",class:"mb-2 d-flex align-center"},{default:a(()=>[l("div",null,[t(me,null,{default:a(()=>[t(ee,{class:"text-white"},{default:a(()=>[T(" Total Minutes of Package ")]),_:1})]),_:1}),t(R,{class:"d-flex justify-between"},{default:a(()=>{var d;return[l("div",Pt,[l("h1",qt,v((d=e(o).packageDetails)==null?void 0:d.duration_in_minutes),1),Lt])]}),_:1})]),t(R,null,{default:a(()=>[l("div",At,[t($,{icon:"ri-calendar-schedule-line",size:"60"})])]),_:1})]),_:1}),t(O,{color:"#91c45e",class:"mb-2 d-flex align-center"},{default:a(()=>[l("div",null,[t(me,null,{default:a(()=>[t(ee,{class:"text-white"},{default:a(()=>[T(" Total Minutes Spent ")]),_:1})]),_:1}),t(R,{class:"d-flex justify-between"},{default:a(()=>{var d;return[l("div",Rt,[l("h1",Bt,v((d=e(o).packageDetails)==null?void 0:d.time_spent_in_minutes),1),Et])]}),_:1})]),t(R,null,{default:a(()=>[l("div",Ft,[t($,{icon:"ri-timer-flash-line",size:"60",color:"white"})])]),_:1})]),_:1}),t(O,{color:"#e05e5e",class:"mb-2 d-flex align-center"},{default:a(()=>[l("div",null,[t(me,null,{default:a(()=>[t(ee,{class:"text-white"},{default:a(()=>[T(" Total Minutes Left ")]),_:1})]),_:1}),t(R,{class:"d-flex justify-between"},{default:a(()=>{var d,_;return[l("div",It,[l("h1",zt,v(((d=e(o).packageDetails)==null?void 0:d.duration_in_minutes)-((_=e(o).packageDetails)==null?void 0:_.time_spent_in_minutes)),1),Ot])]}),_:1})]),t(R,null,{default:a(()=>[l("div",Gt,[t($,{icon:"ri-timer-2-line",size:"60"})])]),_:1})]),_:1})]),_:1})]),_:1}))]),_:1}),t(te,{modelValue:e(m).edit,"onUpdate:modelValue":u[6]||(u[6]=d=>e(m).edit=d),"max-width":"600",persistent:""},{default:a(()=>{var d;return[t(it,{item:e(o).editableColumns,package_id:(d=e(o).packageDetails)==null?void 0:d.package_id,id:c.id,onClose:u[4]||(u[4]=_=>C("edit")),onReload:u[5]||(u[5]=_=>D(c.id))},null,8,["item","package_id","id"])]}),_:1},8,["modelValue"]),t(te,{modelValue:e(m).delete,"onUpdate:modelValue":u[8]||(u[8]=d=>e(m).delete=d),"max-width":"400",persistent:""},{default:a(()=>[t(we,{title:"timesheet",loading:e(V),onDelete:n,onClose:u[7]||(u[7]=d=>C("delete"))},null,8,["loading"])]),_:1},8,["modelValue"]),t(te,{modelValue:e(m).void,"onUpdate:modelValue":u[10]||(u[10]=d=>e(m).void=d),"max-width":"400",persistent:""},{default:a(()=>[t(at,{timesheet_id:c.id,require:e(o).editableColumns.tutormentor_role,onClose:u[9]||(u[9]=d=>C("void"))},null,8,["timesheet_id","require"])]),_:1},8,["modelValue"])]),_:1})}}},Jt={class:"h-auto position-relative"},Wt={key:0,class:"overlay"},Xt=l("div",{class:"bg-secondary",style:{height:"100%",position:"absolute",left:"0",top:"0","z-index":"9998",width:"100%",opacity:"0.6"}},null,-1),Zt={class:"d-flex align-center justify-center",style:{height:"100%",position:"absolute",left:"0",top:"0","z-index":"9999",width:"100%",opacity:"1"}},Kt={class:"text-center"},Qt=l("h2",{class:"text-white mt-3"},"This Timesheet Has Changed Owner",-1),Vl={__name:"timesheet-detail",props:{id:Number,name:String},setup(L){const M=L,c=M.id,x=y(!1),s=y(!1);ke("reloadData",x),ke("updateReload",o=>{x.value=o});const b=o=>{s.value=o};return(o,m)=>(g(),B("div",Jt,[e(s)=="true"?(g(),B("div",Wt,[Xt,l("div",Zt,[l("div",Kt,[t($,{color:"white",icon:"ri-lock-line",size:"50"}),Qt,t(q,{color:"light",class:"mt-4",onClick:m[0]||(m[0]=V=>e(ue).push({path:"/admin/timesheet"+M.name}))},{default:a(()=>[T(" Back to List ")]),_:1})])])])):Z("",!0),t(Ht,{id:e(c),name:M.name,onVoid:b},null,8,["id","name"]),t(lt,{id:e(c)},null,8,["id"])]))}};export{Vl as default};
