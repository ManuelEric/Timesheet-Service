import{r as f,e as J,l as E,o as w,f as S,w as a,b as e,Z as L,u as l,W as K,Y,V as C,j as D,m as j,A as M,v as I,s as T,z as $,c as P,F as X,h as q,i as te,P as le,a as o,X as ae,t as h}from"./main-iX2hVWZn.js";import{r as F}from"./rules-B5G8qOzK.js";import{a as N,c as H,V as B,b as se}from"./VCard-CsyFg2eJ.js";import{V as z}from"./VForm-CIT6BXal.js";import{V as O,a as A}from"./VRow-8_HiRVNS.js";import{V as Q,a as oe}from"./VAutocomplete-BmI3t9bN.js";import{V as W}from"./VDivider-4LljInFV.js";import{d as ne}from"./debounce-CKmJOZ8U.js";import{V as R}from"./VDialog-D-jOjZ6_.js";import{V as de,a as Z}from"./VList-CFNVw4Zq.js";import{a as re,V as ue}from"./VTable-3clnl8VD.js";import{V as ie}from"./VPagination-fD14h8uw.js";import{V as ce}from"./VCheckbox-Bn5afuzV.js";import"./VAvatar-jJghZwXg.js";import"./VImg-DfHGMvHg.js";import"./VCheckboxBtn-Bb9IpmyV.js";import"./VSelectionControl-CN44GoHc.js";import"./VSlideGroup-DIj_qv4l.js";import"./ssrBoot-DO5JkbJw.js";const G={__name:"additional_add",props:{title:String},emits:["close","reload"],setup(U,{emit:_}){const b=U,d=_,v=f(),u=f({timesheet_id:null,fee:null,date:null}),m=f([]),y=f(!1),x=async()=>{y.value=!0;try{const n=await M.get("api/v1/timesheet/component/list");n&&(m.value=n)}catch(n){console.error(n)}finally{y.value=!1}},V=async()=>{var c,r;const n=b.title=="bonus"?"api/v1/payment/bonus/create":"api/v1/payment/additional-fee/create",{valid:i}=await v.value.validate();if(i){u.value.date=I(u.value.date).format("YYYY-MM-DD");try{const t=await M.post(n,u.value);t&&T("success",t.message,"bottom-end")}catch(t){const s=(r=(c=t==null?void 0:t.response)==null?void 0:c.data)==null?void 0:r.errors;T("error",s,"bottom-end")}finally{d("close"),d("reload")}}};return J(()=>{x()}),(n,i)=>{const c=E("VDateInput");return w(),S(B,{title:b.title=="bonus"?"Add Bonus":"Additional Fee"},{default:a(()=>[e(N,null,{default:a(()=>[e(z,{onSubmit:L(V,["prevent"]),ref_key:"formData",ref:v},{default:a(()=>[e(O,null,{default:a(()=>[e(A,{cols:"12"},{default:a(()=>[e(Q,{modelValue:l(u).timesheet_id,"onUpdate:modelValue":i[0]||(i[0]=r=>l(u).timesheet_id=r),label:"Timesheet - Package",placeholder:"Timesheet - Package",items:l(m),"item-title":r=>r.package_type+" - "+r.package_name+" | "+r.clients,"item-value":"id",rules:l(F).required,loading:l(y),disabled:l(y)},null,8,["modelValue","items","item-title","rules","loading","disabled"])]),_:1}),e(A,{cols:"12"},{default:a(()=>[e(c,{modelValue:l(u).date,"onUpdate:modelValue":i[1]||(i[1]=r=>l(u).date=r),"prepend-icon":"",label:"Date",placeholder:"Date",rules:l(F).required},null,8,["modelValue","rules"]),e(K,{modelValue:l(u).fee,"onUpdate:modelValue":i[2]||(i[2]=r=>l(u).fee=r),type:"number",label:"Additional Fee",placeholder:"Additional Fee",rules:l(F).required},null,8,["modelValue","rules"])]),_:1})]),_:1}),e(W,{class:"my-3"}),e(H,null,{default:a(()=>[e(Y,{color:"error",onClick:i[3]||(i[3]=r=>d("close"))},{default:a(()=>[e(C,{icon:"ri-close-line",class:"me-3"}),D(" Close ")]),_:1}),e(j),e(Y,{color:"success",type:"submit"},{default:a(()=>[D(" Save "),e(C,{icon:"ri-save-line",class:"ms-3"})]),_:1})]),_:1})]),_:1},512)]),_:1})]),_:1},8,["title"])}}},me={__name:"cutoff_add",emits:["close","reload"],setup(U,{emit:_}){const b=_,d=f(),v=f({start_date:null,end_date:null}),u=f(null),m=()=>{v.value.start_date=I(u.value[0]).format("YYYY-MM-DD"),v.value.end_date=I(u.value[u.value.length-1]).format("YYYY-MM-DD"),console.log(v.value)},y=async()=>{var n,i,c,r,t,s,k,p;const{valid:x}=await d.value.validate();if(x)try{const g=await M.post("api/v1/payment/cut-off/create",v.value);g&&T("success",g.message,"bottom-end")}catch(g){var V=(i=(n=g==null?void 0:g.response)==null?void 0:n.data)==null?void 0:i.errors;(t=(r=(c=g==null?void 0:g.response)==null?void 0:c.data)==null?void 0:r.errors)!=null&&t.end_date&&(V=(p=(k=(s=g==null?void 0:g.response)==null?void 0:s.data)==null?void 0:k.errors)==null?void 0:p.end_date[0]),T("error",V,"bottom-end")}finally{b("close"),b("reload")}};return(x,V)=>{const n=E("VDateInput");return w(),S(B,{title:"Cut-Off Date"},{default:a(()=>[e(N,null,{default:a(()=>[e(z,{onSubmit:L(y,["prevent"]),ref_key:"formData",ref:d},{default:a(()=>[e(O,null,{default:a(()=>[e(A,{cols:"12"},{default:a(()=>[e(n,{modelValue:l(u),"onUpdate:modelValue":[V[0]||(V[0]=i=>$(u)?u.value=i:null),m],label:"Start - End Date",rules:l(F).required,multiple:"range"},null,8,["modelValue","rules"])]),_:1})]),_:1}),e(W,{class:"my-3"}),e(H,null,{default:a(()=>[e(Y,{color:"error",onClick:V[1]||(V[1]=i=>b("close"))},{default:a(()=>[e(C,{icon:"ri-close-line",class:"me-3"}),D(" Close ")]),_:1}),e(j),e(Y,{color:"success",type:"submit"},{default:a(()=>[D(" Save "),e(C,{icon:"ri-save-line",class:"ms-3"})]),_:1})]),_:1})]),_:1},512)]),_:1})]),_:1})}}},fe={__name:"cutoff_existing_add",props:{id:Array},emits:["close","reload","reset"],setup(U,{emit:_}){const b=U,d=_,v=f(),u=f({activity_id:b.id,start_date:null,end_date:null}),m=f(null),y=()=>{u.value.start_date=I(m.value[0]).format("YYYY-MM-DD"),u.value.end_date=I(m.value[m.value.length-1]).format("YYYY-MM-DD")},x=async()=>{var n,i;const{valid:V}=await v.value.validate();if(V)try{const c=await M.post("api/v1/payment/cut-off/add",u.value);c&&T("success",c.message,"bottom-end")}catch(c){if((i=(n=c==null?void 0:c.response)==null?void 0:n.data)!=null&&i.errors){const r=c.response.data.errors;let t="Validation errors:";for(const s in r)r.hasOwnProperty(s)&&(t+=`
${s}: ${r[s].join(", ")}`);T("error",t,"bottom-end")}}finally{d("reload"),d("close"),d("reset")}};return(V,n)=>{const i=E("VDateInput");return w(),S(B,{title:"Add to Cut-Off"},{default:a(()=>[e(N,null,{default:a(()=>[e(z,{onSubmit:L(x,["prevent"]),ref_key:"formData",ref:v},{default:a(()=>[e(O,null,{default:a(()=>[e(A,{cols:"12"},{default:a(()=>[e(i,{modelValue:l(m),"onUpdate:modelValue":[n[0]||(n[0]=c=>$(m)?m.value=c:null),y],label:"Start - End Date",rules:l(F).required,multiple:"range"},null,8,["modelValue","rules"])]),_:1})]),_:1}),e(W,{class:"my-3"}),e(H,null,{default:a(()=>[e(Y,{color:"error",onClick:n[1]||(n[1]=c=>d("close"))},{default:a(()=>[e(C,{icon:"ri-close-line",class:"me-3"}),D(" Close ")]),_:1}),e(j),e(Y,{color:"success",type:"submit"},{default:a(()=>[D(" Save "),e(C,{icon:"ri-save-line",class:"ms-3"})]),_:1})]),_:1})]),_:1},512)]),_:1})]),_:1})}}},pe=o("div",{class:"d-flex justify-between align-center"},[o("div",{class:"w-100"},[o("h4",null,"Finished Activities")])],-1),_e=o("thead",null,[o("tr",null,[o("th",{class:"text-uppercase",width:"1%"}," # "),o("th",{class:"text-uppercase",width:"1%"}," No "),o("th",{class:"text-uppercase text-center"},"Timesheet"),o("th",{class:"text-uppercase text-center"},"Activity"),o("th",{class:"text-uppercase text-center"},"Students Name"),o("th",{class:"text-uppercase text-center"},"Mentor/Tutor"),o("th",{class:"text-uppercase text-center"},"Date & Time"),o("th",{class:"text-uppercase text-center"},"Time Spent"),o("th",{class:"text-uppercase text-center"},"Fee/Hours"),o("th",{class:"text-uppercase text-center"},"Total"),o("th",{class:"text-uppercase text-center"},"Cut-Offf Status")])],-1),ve={class:"text-center"},Ve={key:0},ge=o("tr",null,[o("td",{colspan:"10",class:"text-center"}," Sorry, no data found. ")],-1),ye=[ge],be={class:"d-flex justify-center mt-5"},Oe={__name:"pre",setup(U){const _=f(!1),b=f([]),d=f({cut_off:!1,additional_fee:!1,add_bonus:!1,add_existing:!1}),v=f(1),u=f(),m=f([]),y=f(null),x=f(null),V=f([]),n=async()=>{_.value=!0;const r="?page="+v.value,t=y.value?"&keyword="+y.value:"",s=x.value?"&package_id="+x.value:"";try{const k=await M.get("api/v1/payment/unpaid"+r+t+s);k&&(v.value=k.current_page,u.value=k.last_page,b.value=k)}catch(k){console.error(k)}finally{_.value=!1}},i=ne(async()=>{await n()},500),c=async()=>{_.value=!0;try{const r=await M.get("api/v1/package/component/list");r&&(V.value=r,_.value=!1)}catch(r){_.value=!1,console.error(r)}};return J(()=>{n(),c()}),(r,t)=>(w(),P(X,null,[e(B,null,{default:a(()=>[e(se,null,{default:a(()=>[pe]),_:1}),e(N,null,{default:a(()=>[e(O,{class:"my-1"},{default:a(()=>[e(A,{cols:"3",md:"4"},{default:a(()=>[e(Q,{loading:l(_),disabled:l(_),clearable:"true",label:"Package Name",items:l(V),"item-title":s=>s.type_of+" - "+s.package,"item-value":"id",modelValue:l(x),"onUpdate:modelValue":[t[0]||(t[0]=s=>$(x)?x.value=s:null),n],placeholder:"Select Timesheet Package",density:"compact"},null,8,["loading","disabled","items","item-title","modelValue"])]),_:1}),e(A,{cols:"3",md:"3"},{default:a(()=>[e(K,{loading:l(_),disabled:l(_),"prepend-inner-icon":"ri-search-line",density:"compact",label:"Search","hide-details":"","single-line":"",modelValue:l(y),"onUpdate:modelValue":t[1]||(t[1]=s=>$(y)?y.value=s:null),onInput:l(i)},null,8,["loading","disabled","modelValue","onInput"])]),_:1}),e(A,{cols:"6",md:"5",class:"text-end"},{default:a(()=>[l(m).length>0?(w(),S(Y,{key:0,color:"warning",class:"me-1",onClick:t[2]||(t[2]=s=>l(d).add_existing=!0)},{default:a(()=>[e(C,{icon:"ri-add-box-line",class:"me-2"}),D(" Add to Existing Cut-Off ")]),_:1})):q("",!0),e(te,{"close-on-content-click":!1,location:"bottom"},{activator:a(({props:s})=>[e(Y,le({color:"light-primary"},s,{class:"me-1"}),{default:a(()=>[D(" Additional Fee "),e(C,{icon:"ri-arrow-down-s-line",class:"ms-2"})]),_:2},1040)]),default:a(()=>[e(de,null,{default:a(()=>[e(Z,null,{default:a(()=>[o("div",{class:"cursor-pointer",onClick:t[3]||(t[3]=s=>l(d).additional_fee=!0)},[e(C,{icon:"ri-wallet-2-line",class:"me-2"}),D(" Additional Fee ")])]),_:1}),e(Z,null,{default:a(()=>[o("div",{class:"cursor-pointer",onClick:t[4]||(t[4]=s=>l(d).add_bonus=!0)},[e(C,{icon:"ri-wallet-3-line",class:"me-2"}),D(" Add Bonus ")])]),_:1})]),_:1})]),_:1}),l(m).length==0?(w(),S(Y,{key:1,color:"secondary",onClick:t[5]||(t[5]=s=>l(d).cut_off=!0)},{default:a(()=>[e(C,{icon:"ri-scissors-cut-line",class:"me-2"}),D(" Cut-Off ")]),_:1})):q("",!0)]),_:1})]),_:1}),l(_)?(w(),S(ue,{key:0,class:"mx-auto border",type:"table-thead, table-row@10"})):(w(),S(re,{key:1,class:"text-no-wrap"},{default:a(()=>{var s,k;return[_e,o("tbody",null,[(w(!0),P(X,null,ae(l(b).data,(p,g)=>(w(),P("tr",{key:g},[o("td",null,[e(ce,{modelValue:l(m),"onUpdate:modelValue":t[6]||(t[6]=ee=>$(m)?m.value=ee:null),value:p.id},null,8,["modelValue","value"])]),o("td",null,h(parseInt(g)+1),1),o("td",null,h(p.package.type+" - "+p.package.name),1),o("td",null,h(p.activity),1),o("td",null,h(p.students),1),o("td",null,h(p.mentor_tutor),1),o("td",null,h(p.date),1),o("td",null,h((p.time_spent/60).toFixed(2)+" Hours"),1),o("td",null,"Rp. "+h(p.fee_hours),1),o("td",null," Rp. "+h((p.time_spent/60).toFixed(2)*p.fee_hours),1),o("td",ve,[e(oe,{color:p.cutoff_status=="not yet"?"#ff0217":"#91c45e"},{default:a(()=>[D(h(p.cutoff_status.charAt(0).toUpperCase()+p.cutoff_status.slice(1).toLowerCase()),1)]),_:2},1032,["color"])])]))),128))]),((k=(s=l(b))==null?void 0:s.data)==null?void 0:k.length)==0?(w(),P("tfoot",Ve,ye)):q("",!0)]}),_:1})),o("div",be,[e(ie,{modelValue:l(v),"onUpdate:modelValue":[t[7]||(t[7]=s=>$(v)?v.value=s:null),n],length:l(u),"total-visible":4,color:"primary",density:"compact","show-first-last-page":!1},null,8,["modelValue","length"])])]),_:1}),e(R,{modelValue:l(d).cut_off,"onUpdate:modelValue":t[9]||(t[9]=s=>l(d).cut_off=s),"max-width":"450",persistent:""},{default:a(()=>[e(me,{onClose:t[8]||(t[8]=s=>l(d).cut_off=!1),onReload:n})]),_:1},8,["modelValue"]),e(R,{modelValue:l(d).add_existing,"onUpdate:modelValue":t[12]||(t[12]=s=>l(d).add_existing=s),"max-width":"450",persistent:"",scrollable:""},{default:a(()=>[e(fe,{id:l(m),onClose:t[10]||(t[10]=s=>l(d).add_existing=!1),onReload:n,onReset:t[11]||(t[11]=s=>m.value=[])},null,8,["id"])]),_:1},8,["modelValue"])]),_:1}),e(R,{modelValue:l(d).add_bonus,"onUpdate:modelValue":t[14]||(t[14]=s=>l(d).add_bonus=s),"max-width":"450",persistent:""},{default:a(()=>[e(G,{title:"bonus",onClose:t[13]||(t[13]=s=>l(d).add_bonus=!1),onReload:n})]),_:1},8,["modelValue"]),e(R,{modelValue:l(d).additional_fee,"onUpdate:modelValue":t[16]||(t[16]=s=>l(d).additional_fee=s),"max-width":"450",persistent:""},{default:a(()=>[e(G,{title:"fee",onClose:t[15]||(t[15]=s=>l(d).additional_fee=!1),onReload:n})]),_:1},8,["modelValue"])],64))}};export{Oe as default};
