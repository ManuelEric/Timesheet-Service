import{r as p,o as _e,e as i,p as T,w as l,b as t,f as s,t as $,a as x,F as K,a0 as ie,h as e,j as ye,H as J,i as k,l as U,W as be,k as ue,q,V as X,z as ke,A,s as ae,a1 as Ce,a2 as Te,y as $e,E as Se,n as Ue}from"./main-CIyTb30b.js";import{r as F}from"./rules-CkvmYWH-.js";import{c as oe,V as de,d as Ve,b as Ne}from"./VCard-C29YU8gH.js";import{V as he}from"./VForm-BpW83qwK.js";import{V as ve,a as y}from"./VRow-Qu8MLV5u.js";import{V as L}from"./VAutocomplete-Cb3oZRW_.js";import{V as fe}from"./VDialog-MgaX4bNX.js";import{V as W}from"./VTooltip-DNVkbYjw.js";import{a as ge,V as je}from"./VTable-DhFykMyG.js";import{V as xe}from"./VTextarea-D3aFUxft.js";import{A as qe}from"./ApiServiceCRM-T1R0ZJwB.js";import{d as Fe}from"./debounce-C7jnRZm_.js";import{V as Ie}from"./VPagination-C1dQCmem.js";import{T as Pe}from"./index-Q_ly0H3Z.js";import{V as Ae}from"./VCheckbox-4Wa-QGww.js";import"./VAvatar-BX5jpCoU.js";import"./VImg-W4GSKdm2.js";import"./VList-_Z-6DLT-.js";import"./ssrBoot-DemGpwGB.js";import"./VDivider-CZWgXtvS.js";import"./VCheckboxBtn-Br7Sis1X.js";import"./VSelectionControl-BXKEtM3o.js";import"./VSlideGroup-CaDoTvXL.js";const Me={class:"mb-4 d-flex gap-1"},De={class:"text-sm"},Re={class:"d-flex justify-between align-center mb-3"},Ge=s("h4",{class:"w-100"},"Detail of Active Agreement",-1),Ee=s("thead",null,[s("tr",null,[s("th",{class:"text-left",nowrap:""}," Curriculum "),s("th",{nowrap:""},"Subject Tutoring"),s("th",{nowrap:""},"Grade"),s("th",{nowrap:""},"Fee Individual - Gross")])],-1),He={nowrap:""},Le=["href"],ze={nowrap:""},Be={nowrap:""},Oe={nowrap:""},We={__name:"program_add",props:{selected:Object},emits:["close","reload"],setup(ce,{emit:C}){var d,o,g,V;const w=ce,R=C,r=p(!1),_=p(null),Z=p([]),Q=p([]),G=p([]),N=p([]),ee=p([]),z=p([]),Y=p(!1),I=(o=(d=w.selected[0])==null?void 0:d.require)==null?void 0:o.toLowerCase(),B=p(null),M=p(null),f=p(w.selected.map(m=>m.mentee)),j=p(),a=p({ref_id:w.selected.map(m=>m.id),mentortutor_email:null,subject_id:null,inhouse_id:null,package_id:((g=w.selected[0])==null?void 0:g.package)??null,tax:null,individual_fee:null,duration:"",notes:"",pic_id:[],curriculum_id:((V=w.selected[0])==null?void 0:V.curriculum)??null}),E=async(m=!1)=>{r.value=!0;const n=m?"api/v1/user/mentor-tutors?inhouse=true&role="+I:"api/v1/user/mentor-tutors?role="+I;try{const S=await A.get(n);S&&(m?z.value=Object.values(S):Z.value=S)}catch(S){console.error(S)}finally{r.value=!1}},b=async()=>{r.value=!0;try{const m=await A.get("api/v1/package/component/list?category="+I);m&&(N.value=m)}catch(m){console.error(m)}finally{r.value=!1}},te=()=>{const m=a.value.package_id,n=N.value.findIndex(O=>O.id===m);let S=N.value[n];S.detail?(Y.value=!0,a.value.duration=S.detail):(Y.value=!1,a.value.duration=null)},c=async()=>{try{const m=await A.get("api/v1/user/component/list");m&&(ee.value=m)}catch(m){console.error(m)}},le=async(m,n=null,S=0)=>{B.value=S,a.value.tax=(S==1,2.5),a.value.subject_id=null,a.value.subject_name=null,a.value.individual_fee=null,M.value=null;const O=a.value.curriculum_id?"/"+a.value.curriculum_id:"";try{const h=await A.get("api/v1/user/mentor-tutors/"+n+"/subjects"+O);h&&(G.value=h)}catch(h){console.error(h)}},D=async(m,n,S)=>{var h,ne;const O=(h=w.selected[0])==null?void 0:h.grade;if(n)try{const u=await A.get("api/v1/component/fee/tutor/"+m+"/"+n+"/"+S+"/"+O);u&&(a.value.individual_fee=((ne=w.selected)==null?void 0:ne.length)>1?u.fee_group:u.fee_individual,a.value.individual_fee?me():M.value=null)}catch(u){ae("error","We're sorry, but we couldn't find a tutor fee for the selected curriculum and subject. This may be outside the scope of our current agreement. Please reach out to our HR team for assistance or to explore availableÂ options","bottom-end"),console.error(u)}else a.value.individual_fee=null,M.value=null},H=async()=>{try{const m=await A.get("api/v1/curriculum/component/list");m&&(Q.value=m)}catch(m){console.error(m)}},pe=async()=>{var n,S,O;a.value.mentortutor_email=_.value.email;const{valid:m}=await j.value.validate();if(m){r.value=!0;try{const h=await A.post("api/v1/timesheet/create",a.value);h&&(ae("success",h.message,"bottom-end"),R("reload"),a.value={ref_id:[],mentortutor_email:null,subject_id:null,subject_name:null,inhouse_id:null,package_id:null,duration:"",notes:"",pic_id:[],tax:null,individual_fee:""},_.value=null,window.open("/admin/timesheet/tutoring/"+((n=h.data)==null?void 0:n.timesheet_id),"_blank"))}catch(h){if(console.log(h),(O=(S=h==null?void 0:h.response)==null?void 0:S.data)!=null&&O.errors){const ne=h.response.data.errors;ae("error",ne,"bottom-end")}}finally{R("close"),r.value=!1}}},me=()=>{const m=a.value.individual_fee*(1-a.value.tax/100);M.value=Math.trunc(m)},v=()=>{const m=M.value/(1-a.value.tax/100);a.value.individual_fee=Math.trunc(m)};return _e(()=>{E(),E(!0),b(),c(),H()}),(m,n)=>{var S;return i(),T(de,{"max-width":"650","prepend-icon":"ri-send-plane-line",title:(S=w.selected[0])==null?void 0:S.program_name},{default:l(()=>[t(oe,null,{default:l(()=>{var O;return[s("div",Me,[s("p",De,$(((O=w.selected)==null?void 0:O.length)>1?"Students":"Student")+":",1),(i(!0),x(K,null,ie(e(f),h=>(i(),x("p",{key:h,class:"text-sm bg-info px-2 rounded"},$(h),1))),128))]),t(he,{onSubmit:ye(pe,["prevent"]),ref_key:"formData",ref:j,"validate-on":"input"},{default:l(()=>[t(ve,null,{default:l(()=>{var h,ne;return[t(y,{cols:e(_)?11:12},{default:l(()=>[t(L,{clearable:"",modelValue:e(_),"onUpdate:modelValue":[n[0]||(n[0]=u=>J(_)?_.value=u:null),n[1]||(n[1]=u=>le(e(_).roles,e(_).uuid,e(_).has_npwp))],label:"Tutor Name",items:e(Z),"item-props":u=>{var P;return{title:u.full_name,subtitle:((P=u.roles)==null?void 0:P.length)>0?u.roles.map(se=>se.name).join(", "):"-",disabled:u.is_active==0}},rules:e(F).required,loading:e(r),disabled:e(r),density:"compact"},null,8,["modelValue","items","item-props","rules","loading","disabled"])]),_:1},8,["cols"]),e(_)?(i(),T(y,{key:0,cols:"1"},{default:l(()=>[t(fe,{"max-width":"600"},{activator:l(({props:u})=>[t(W,{activator:"parent",location:"end"},{default:l(()=>[k("Fee Detail")]),_:1}),t(U,be({icon:"ri-folder-info-line",class:"cursor-pointer mt-3"},u),null,16)]),default:l(({isActive:u})=>[t(de,null,{default:l(()=>[t(oe,{class:"py-5"},{default:l(()=>{var P;return[s("div",Re,[Ge,t(ue,{size:"x-small",color:"secondary",icon:"ri-close-line",onClick:se=>u.value=!1},null,8,["onClick"])]),((P=e(_))==null?void 0:P.roles.findIndex(se=>se.name==="Tutor"))>=0?(i(),T(ge,{key:0,density:"compact"},{default:l(()=>[Ee,s("tbody",null,[(i(!0),x(K,null,ie(e(_).roles,(se,we)=>(i(),x(K,{key:we},[se.name=="Tutor"?(i(!0),x(K,{key:0},ie(se.subjects,re=>(i(),x("tr",{key:re},[s("td",He,[k($(re.curriculum_name??"-")+" ",1),re.agreement?(i(),x("a",{key:0,href:re.agreement,target:"_blank",class:"ms-2 d-inline cursor-pointer"},[t(W,{activator:"parent",location:"end"},{default:l(()=>[k(" Check Agreement ")]),_:1}),t(U,{icon:"ri-file-pdf-2-line"})],8,Le)):q("",!0)]),s("td",ze,$(re.tutor_subject??"-"),1),s("td",Be,$(re.grade??"-"),1),s("td",Oe," Rp. "+$(new Intl.NumberFormat("id-ID").format(re.fee_individual)),1)]))),128)):q("",!0)],64))),128))])]),_:1})):(i(),T(oe,{key:1,class:"text-center"},{default:l(()=>[k(" There is no tutoring subject ")]),_:1}))]}),_:2},1024)]),_:2},1024)]),_:1})]),_:1})):q("",!0),t(y,{md:"6",cols:"6"},{default:l(()=>[t(L,{clearable:"",modelValue:e(a).curriculum_id,"onUpdate:modelValue":[n[2]||(n[2]=u=>e(a).curriculum_id=u),n[3]||(n[3]=u=>D(e(_).id,e(a).subject_name,e(a).curriculum_id))],label:"Curriculum",items:e(Q),"item-props":u=>({title:u.name}),loading:e(r),readonly:"",density:"compact","item-value":"id"},null,8,["modelValue","items","item-props","loading"])]),_:1}),((ne=(h=w.selected[0])==null?void 0:h.require)==null?void 0:ne.toLowerCase())=="tutor"?(i(),T(y,{key:1,md:"6",cols:"6"},{default:l(()=>[t(L,{clearable:"",modelValue:e(a).subject_name,"onUpdate:modelValue":[n[4]||(n[4]=u=>e(a).subject_name=u),n[5]||(n[5]=u=>D(e(_).id,e(a).subject_name,e(a).curriculum_id))],label:"Subject Tutoring",items:e(G),"item-value":"tutor_subject","item-title":"tutor_subject",loading:e(r),disabled:e(r),rules:e(F).required,density:"compact"},null,8,["modelValue","items","loading","disabled","rules"])]),_:1})):q("",!0),t(y,{md:"8",cols:"8"},{default:l(()=>{var u;return[t(L,{clearable:"",label:"Package",modelValue:e(a).package_id,"onUpdate:modelValue":[n[6]||(n[6]=P=>e(a).package_id=P),te],items:e(N),density:"compact","item-props":P=>({title:P.package!=null?P.type_of+" - "+P.package:P.type_of,subtitle:P.detail?P.detail/60+" Hours":"Customizable"}),"item-value":"id",rules:e(F).required,loading:e(r),readonly:(u=w.selected[0])==null?void 0:u.package,disabled:e(r)},null,8,["modelValue","items","item-props","rules","loading","readonly","disabled"])]}),_:1}),t(y,{md:"4",cols:"4"},{default:l(()=>[t(X,{type:"number",clearable:"",label:e(a).duration/60?"Minutes ("+(e(a).duration/60).toFixed(1)+" Hours)":"Minutes",readonly:e(Y),modelValue:e(a).duration,"onUpdate:modelValue":n[7]||(n[7]=u=>e(a).duration=u),density:"compact",rules:e(F).required},null,8,["label","readonly","modelValue","rules"])]),_:1}),t(y,{md:"4",cols:"7"},{default:l(()=>[t(X,{type:"number",clearable:"",label:"Fee/hours (Nett)",modelValue:e(M),"onUpdate:modelValue":[n[8]||(n[8]=u=>J(M)?M.value=u:null),v],density:"compact",readonly:"",rules:e(F).required},null,8,["modelValue","rules"])]),_:1}),t(y,{md:"4",cols:"5"},{default:l(()=>[t(X,{type:"number",clearable:"",label:"Tax",modelValue:e(a).tax,"onUpdate:modelValue":[n[9]||(n[9]=u=>e(a).tax=u),v],rules:e(F).required,density:"compact",readonly:""},null,8,["modelValue","rules"])]),_:1}),t(y,{md:"4",cols:"12"},{default:l(()=>[t(W,{activator:"parent",location:"top"},{default:l(()=>[k(" Fee Gross is automatically calculated based on the entered Net Fee and Tax Rate. ")]),_:1}),t(X,{type:"number",clearable:"",label:"Fee/hours (Gross)",modelValue:e(a).individual_fee,"onUpdate:modelValue":[n[10]||(n[10]=u=>e(a).individual_fee=u),me],density:"compact",readonly:"",rules:e(F).required},null,8,["modelValue","rules"])]),_:1}),t(y,{md:"6",cols:"6"},{default:l(()=>[t(L,{clearable:"",modelValue:e(a).inhouse_id,"onUpdate:modelValue":n[11]||(n[11]=u=>e(a).inhouse_id=u),label:"Inhouse Mentor/Tutor",items:e(z),density:"compact","item-props":u=>({title:u.full_name}),"item-value":"uuid",loading:e(r),disabled:e(r),rules:e(F).required},null,8,["modelValue","items","item-props","loading","disabled","rules"])]),_:1}),t(y,{md:"6",cols:"6"},{default:l(()=>[t(L,{multiple:"",clearable:"",chips:"",label:"PIC",modelValue:e(a).pic_id,"onUpdate:modelValue":n[12]||(n[12]=u=>e(a).pic_id=u),items:e(ee),"item-title":"full_name","item-value":"id",loading:e(r),density:"compact",disabled:e(r),rules:e(F).required},null,8,["modelValue","items","loading","disabled","rules"])]),_:1}),t(y,{md:"12"},{default:l(()=>[t(xe,{label:"Notes",modelValue:e(a).notes,"onUpdate:modelValue":n[13]||(n[13]=u=>e(a).notes=u),density:"compact"},null,8,["modelValue"])]),_:1})]}),_:1}),t(Ve,{class:"mt-5 px-0"},{default:l(()=>[t(ue,{variant:"tonal",color:"error",type:"button",onClick:n[14]||(n[14]=h=>R("close"))},{default:l(()=>[t(U,{icon:"ri-close-line",class:"me-3"}),k(" Close ")]),_:1}),t(ke),t(ue,{variant:"tonal",color:"success",type:"submit"},{default:l(()=>[k(" Save "),t(U,{icon:"ri-save-line",class:"ms-3"})]),_:1})]),_:1})]),_:1},512)]}),_:1})]),_:1},8,["title"])}}},Ye={class:"d-flex justify-between align-center mb-3"},Je=s("h4",{class:"w-100"},"Detail of Active Agreement",-1),Ke=s("thead",null,[s("tr",null,[s("th",{class:"text-left",nowrap:""}," Engagement Type "),s("th",{nowrap:""},"Stream"),s("th",{nowrap:""},"Package"),s("th",{nowrap:""},"Fee Individual - Gross")])],-1),Qe={nowrap:""},Xe=["href"],Ze={nowrap:""},et={nowrap:""},tt={nowrap:""},lt={__name:"program_add_specialist",props:{selected:Object},emits:["close","reload"],setup(ce,{emit:C}){var pe,me;const w=ce,R=C,r=p(!1),_=p(null),Z=p([]),Q=p([]),G=p(null),N=p([]),ee=p([]),z=p([]),Y=p(!1),I=(me=(pe=w.selected[0])==null?void 0:pe.require)==null?void 0:me.toLowerCase(),B=p(null),M=p(),f=p({ref_id:w.selected.map(v=>v.id),mentortutor_email:null,subject_id:null,inhouse_id:null,package_id:null,duration:"",tax:2.5,individual_fee:null,notes:"",pic_id:[]}),j=async(v=!1)=>{const d=I=="mentor"?"External Mentor":I,o=v?"api/v1/user/mentor-tutors?inhouse=true&role="+I:"api/v1/user/mentor-tutors?role="+d;try{const g=await A.get(o);g&&(v?z.value=Object.values(g):Z.value=g)}catch(g){console.error(g)}},a=async()=>{var d,o;const v="external-mentor/streams";try{r.value=!0;const g=await qe.get(v);g&&(Q.value=g),r.value=!1}catch(g){ae("error",(o=(d=g.response)==null?void 0:d.data)==null?void 0:o.message,"bottom-end"),console.error(g),r.value=!1}},E=async(v,d,o)=>{const g=w.selected[0].engagement_type;try{const V=await A.get("api/v1/component/fee/ext-mentor/"+v+"/"+d+"/"+g+"/"+o);V&&(f.value.individual_fee=V.fee_individual,f.value.individual_fee?D():B.value=null)}catch(V){f.value.individual_fee=null,B.value=null,ae("error","We're sorry, but we couldn't find a tutor fee for the selected curriculum and subject. This may be outside the scope of our current agreement. Please reach out to our HR team for assistance or to explore availableÂ options","bottom-end"),console.error(V)}te()},b=async()=>{try{const v=await A.get("api/v1/package/component/list?category="+I);v&&(N.value=v)}catch(v){console.error(v)}},te=()=>{const v=f.value.package_id,d=N.value.findIndex(g=>g.id===v);let o=N.value[d];o.detail?(Y.value=!0,f.value.duration=o.detail):(Y.value=!1,f.value.duration=null)},c=async()=>{try{const v=await A.get("api/v1/user/component/list");v&&(ee.value=v)}catch(v){console.error(v)}},le=async()=>{var d,o,g;f.value.mentortutor_email=_.value.email;const{valid:v}=await M.value.validate();if(v){r.value=!0;try{const V=await A.post("api/v1/timesheet/create",f.value);V&&(ae("success",V.message,"bottom-end"),R("reload"),f.value={ref_id:[],mentortutor_email:null,subject_id:null,subject_name:null,inhouse_id:null,package_id:null,duration:"",notes:"",pic_id:[],tax:null,individual_fee:""},_.value=[],window.open("/admin/timesheet/specialist/"+((d=V.data)==null?void 0:d.timesheet_id),"_blank"))}catch(V){if((g=(o=V==null?void 0:V.response)==null?void 0:o.data)!=null&&g.errors){const m=V.response.data.errors;ae("error",m,"bottom-end")}}finally{R("close"),r.value=!1}}},D=()=>{const v=f.value.individual_fee*(1-f.value.tax/100);B.value=Math.trunc(v)},H=()=>{const v=B.value/(1-f.value.tax/100);f.value.individual_fee=Math.trunc(v)};return _e(()=>{a(),j(),j(!0),b(),c()}),(v,d)=>(i(),T(de,{"max-width":"650","prepend-icon":"ri-send-plane-line",title:"Assign to Subject Specialist"},{default:l(()=>[t(oe,null,{default:l(()=>[t(he,{onSubmit:ye(le,["prevent"]),ref_key:"formData",ref:M,"validate-on":"input"},{default:l(()=>[t(ve,null,{default:l(()=>[t(y,{md:"6",cols:e(_)?11:12},{default:l(()=>[t(L,{density:"compact",clearable:"",modelValue:e(_),"onUpdate:modelValue":[d[0]||(d[0]=o=>J(_)?_.value=o:null),d[1]||(d[1]=()=>(_.value=null,G.value=null,e(f).package_id=null))],label:"Subject Specialist Name",items:e(Z),"item-props":o=>{var g;return{title:o.full_name,subtitle:((g=o.roles)==null?void 0:g.length)>0?o.roles.map(V=>V.name).join(", "):"-",disabled:o.is_active==0}},rules:e(F).required,loading:e(r),disabled:e(r)},null,8,["modelValue","items","item-props","rules","loading","disabled"])]),_:1},8,["cols"]),e(_)?(i(),T(y,{key:0,cols:"1"},{default:l(()=>[t(fe,{"max-width":"600"},{activator:l(({props:o})=>[t(W,{activator:"parent",location:"end"},{default:l(()=>[k("Fee Detail")]),_:1}),t(U,be({icon:"ri-folder-info-line",class:"cursor-pointer mt-3"},o),null,16)]),default:l(({isActive:o})=>[t(de,null,{default:l(()=>[t(oe,{class:"py-5"},{default:l(()=>{var g;return[s("div",Ye,[Je,t(ue,{size:"x-small",color:"secondary",icon:"ri-close-line",onClick:V=>o.value=!1},null,8,["onClick"])]),((g=e(_))==null?void 0:g.roles.findIndex(V=>V.name==="External Mentor"))>=0?(i(),T(ge,{key:0,density:"compact"},{default:l(()=>[Ke,s("tbody",null,[(i(!0),x(K,null,ie(e(_).roles,(V,m)=>(i(),x(K,{key:m},[V.name=="External Mentor"?(i(!0),x(K,{key:0},ie(V.subjects,n=>(i(),x("tr",{key:n},[s("td",Qe,[k($(n.engagement_type_name??"-")+" ",1),n.agreement?(i(),x("a",{key:0,href:n.agreement,target:"_blank",class:"ms-2 d-inline cursor-pointer"},[t(W,{activator:"parent",location:"end"},{default:l(()=>[k(" Check Agreement ")]),_:1}),t(U,{icon:"ri-file-pdf-2-line"})],8,Xe)):q("",!0)]),s("td",Ze,$(n.stream??"-"),1),s("td",et,$(n.package_name??"-"),1),s("td",tt," Rp. "+$(new Intl.NumberFormat("id-ID").format(n.fee_individual)),1)]))),128)):q("",!0)],64))),128))])]),_:1})):(i(),T(oe,{key:1,class:"text-center"},{default:l(()=>[k(" There is no tutoring subject ")]),_:1}))]}),_:2},1024)]),_:2},1024)]),_:1})]),_:1})):q("",!0),t(y,{md:e(_)?5:6,cols:"12"},{default:l(()=>[t(L,{density:"compact",clearable:"",label:"Stream",modelValue:e(G),"onUpdate:modelValue":d[2]||(d[2]=o=>J(G)?G.value=o:null),items:e(Q),"item-title":"stream_name","item-value":"stream_name",loading:e(r),disabled:e(r)},null,8,["modelValue","items","loading","disabled"])]),_:1},8,["md"]),t(y,{md:"8",cols:"8"},{default:l(()=>[t(L,{density:"compact",clearable:"",label:"Package",modelValue:e(f).package_id,"onUpdate:modelValue":[d[3]||(d[3]=o=>e(f).package_id=o),d[4]||(d[4]=o=>E(e(_).id,e(G),e(f).package_id))],items:e(N),"item-props":o=>({title:o.package!=null?o.type_of+" - "+o.package:o.type_of,subtitle:o.detail?o.detail/60+" Hours":"Customizable"}),"item-value":"id",rules:e(F).required,loading:e(r),disabled:e(r)},null,8,["modelValue","items","item-props","rules","loading","disabled"])]),_:1}),t(y,{md:"4",cols:"4"},{default:l(()=>[t(X,{density:"compact",type:"number",clearable:"",label:+e(f).duration/60?""+e(f).duration/60+" Hours":"Minutes",readonly:e(Y),modelValue:e(f).duration,"onUpdate:modelValue":d[5]||(d[5]=o=>e(f).duration=o),rules:e(F).required},null,8,["label","readonly","modelValue","rules"])]),_:1}),t(y,{md:"4",cols:"7"},{default:l(()=>[t(X,{type:"number",clearable:"",label:"Fee/hours (Nett)",modelValue:e(B),"onUpdate:modelValue":[d[6]||(d[6]=o=>J(B)?B.value=o:null),H],density:"compact",rules:e(F).required,readonly:""},null,8,["modelValue","rules"])]),_:1}),t(y,{md:"4",cols:"5"},{default:l(()=>[t(X,{type:"number",clearable:"",label:"Tax",modelValue:e(f).tax,"onUpdate:modelValue":[d[7]||(d[7]=o=>e(f).tax=o),H],rules:e(F).required,density:"compact",readonly:""},null,8,["modelValue","rules"])]),_:1}),t(y,{md:"4",cols:"12"},{default:l(()=>[t(W,{activator:"parent",location:"top"},{default:l(()=>[k(" Fee Gross is automatically calculated based on the entered Net Fee and Tax Rate. ")]),_:1}),t(X,{type:"number",clearable:"",label:"Fee/hours (Gross)",modelValue:e(f).individual_fee,"onUpdate:modelValue":[d[8]||(d[8]=o=>e(f).individual_fee=o),D],density:"compact",readonly:"",rules:e(F).required},null,8,["modelValue","rules"])]),_:1}),t(y,{md:"6",cols:"12"},{default:l(()=>[t(L,{density:"compact",clearable:"",modelValue:e(f).inhouse_id,"onUpdate:modelValue":d[9]||(d[9]=o=>e(f).inhouse_id=o),label:"Inhouse Mentor",items:e(z),"item-props":o=>({title:o.full_name}),"item-value":"uuid",loading:e(r),disabled:e(r),rules:e(F).required},null,8,["modelValue","items","item-props","loading","disabled","rules"])]),_:1}),t(y,{md:"6",cols:"12"},{default:l(()=>[t(L,{density:"compact",multiple:"",clearable:"",chips:"",label:"PIC",modelValue:e(f).pic_id,"onUpdate:modelValue":d[10]||(d[10]=o=>e(f).pic_id=o),items:e(ee),"item-title":"full_name","item-value":"id",loading:e(r),disabled:e(r),rules:e(F).required},null,8,["modelValue","items","loading","disabled","rules"])]),_:1}),t(y,{md:"12"},{default:l(()=>[t(xe,{label:"Notes",modelValue:e(f).notes,"onUpdate:modelValue":d[11]||(d[11]=o=>e(f).notes=o)},null,8,["modelValue"])]),_:1})]),_:1}),t(Ve,{class:"mt-5 px-0"},{default:l(()=>[t(ue,{variant:"tonal",color:"error",type:"button",onClick:d[12]||(d[12]=o=>R("close"))},{default:l(()=>[t(U,{icon:"ri-close-line",class:"me-3"}),k(" Close ")]),_:1}),t(ke),t(ue,{variant:"tonal",color:"success",type:"submit"},{default:l(()=>[k(" Save "),t(U,{icon:"ri-save-line",class:"ms-3"})]),_:1})]),_:1})]),_:1},512)]),_:1})]),_:1}))}},at=["innerHTML"],ot=s("div",{class:"d-flex justify-between align-center"},[s("div",{class:"w-100"},[s("h4",null,"Program Name")])],-1),nt={key:0,class:"d-flex bg-secondary py-1 px-2 rounded-lg",style:{"align-items":"center"}},st=s("th",{class:"text-uppercase",width:"1%"}," # ",-1),rt=s("th",{class:"text-uppercase text-center"},"Timesheet",-1),it=s("th",{class:"text-uppercase text-center"},"Student",-1),ut=s("th",{class:"text-uppercase text-center"},"School Name",-1),dt={class:"text-uppercase text-center"},ct={key:0,class:"text-uppercase text-center"},mt={class:"text-center"},pt={class:"text-left",nowrap:""},ft=["onClick"],_t={class:"text-left",nowrap:""},vt={key:0,class:"text-left",nowrap:""},gt={key:1,class:"text-left",nowrap:""},yt={key:2,nowrap:""},bt={key:0},kt=s("tr",null,[s("td",{colspan:"6",class:"text-center"}," Sorry, no data found. ")],-1),Vt=[kt],ht={class:"d-flex justify-center mt-5"},Ot={__name:"program",props:{name:String},setup(ce){const C=p([]),w=p(!1),R=p(!1),r=ce,_=p(1),Z=p(),Q=p(null),G=p([]),N=p(!1),ee=p([]),z=p(),Y=p(),I=async()=>{var le,D;const j=r.name,a="?page="+_.value,E=Q.value?"&keyword="+Q.value:"",b=z.value?"&program_name="+encodeURIComponent(z.value):"",c=j=="tutoring"?"api/v1/program/list"+a+E+b+"&paginate=true":"api/v1/request"+a+E+"&is_cancelled=true";try{N.value=!0;const H=await A.get(c);H&&(_.value=H.current_page,Z.value=H.last_page,G.value=H),N.value=!1}catch(H){ae("error",(D=(le=H.response)==null?void 0:le.data)==null?void 0:D.message,"bottom-end"),console.error(H),N.value=!1}},B=async()=>{try{const j=await A.get("api/v1/program/component/list");j&&(ee.value=j)}catch(j){console.error(j)}},M=Fe(async j=>{_.value=1,Q.value=j.target.value,await I()},1e3),f=j=>{window.open("/admin/timesheet/"+r.name+"/"+j)};return Ce(()=>{I()}),Te(()=>{C.value=[]}),_e(()=>{I(),B()}),(j,a)=>{const E=$e("VText");return i(),x(K,null,[t(fe,{modelValue:e(R),"onUpdate:modelValue":a[0]||(a[0]=b=>J(R)?R.value=b:null),width:"400"},{default:l(()=>[t(de,{title:"Notes","prepend-icon":"ri-chat-3-line"},{default:l(()=>[t(oe,null,{default:l(()=>[s("div",{innerHTML:e(Y)},null,8,at)]),_:1})]),_:1})]),_:1},8,["modelValue"]),t(de,null,{default:l(()=>[t(Ne,null,{default:l(()=>[ot]),_:1}),t(oe,null,{default:l(()=>[t(ve,{class:"my-1"},{default:l(()=>[r.name=="tutoring"?(i(),T(y,{key:0,cols:"12",md:"3"},{default:l(()=>[t(L,{clearable:"",modelValue:e(z),"onUpdate:modelValue":[a[1]||(a[1]=b=>J(z)?z.value=b:null),I],label:"Program Name",items:e(ee),"item-title":"program_name",placeholder:"Select Program Name",density:"compact","hide-details":"","single-line":"",loading:e(N),disabled:e(N)},null,8,["modelValue","items","loading","disabled"])]),_:1})):q("",!0),t(y,{cols:"12",md:"3"},{default:l(()=>[t(X,{loading:e(N),disabled:e(N),"append-inner-icon":"ri-search-line",density:"compact",label:"Search","hide-details":"","single-line":"",onInput:e(M)},null,8,["loading","disabled","onInput"])]),_:1}),t(y,{cols:"12",md:r.name=="tutoring"?6:9,class:"text-end"},{default:l(()=>[Se((i(),T(ue,{density:"compact",color:e(C).length>0?"warning":"primary",class:"mb-2",disabled:!(e(C).length>0),onClick:a[2]||(a[2]=b=>w.value=!0)},{default:l(()=>[t(U,{icon:"ri-add-line",class:"me-3"}),k(" Assign "+$(e(C).length>1?"to Group":""),1)]),_:1},8,["color","disabled"])),[[Pe,"Generate Timesheet","start"]])]),_:1},8,["md"])]),_:1}),t(fe,{modelValue:e(w),"onUpdate:modelValue":a[7]||(a[7]=b=>J(w)?w.value=b:null),width:"auto",persistent:""},{default:l(()=>[r.name=="tutoring"?(i(),T(We,{key:0,selected:e(C),onClose:a[3]||(a[3]=b=>{w.value=!1,C.value=[]}),onReload:a[4]||(a[4]=b=>{C.value=[],I()})},null,8,["selected"])):q("",!0),r.name=="specialist"?(i(),T(lt,{key:1,selected:e(C),onClose:a[5]||(a[5]=b=>w.value=!1),onReload:a[6]||(a[6]=b=>{C.value=[],I()})},null,8,["selected"])):q("",!0)]),_:1},8,["modelValue"]),e(C).length>0?(i(),x("div",nt,[k(" Selected: "),(i(!0),x(K,null,ie(e(C),b=>(i(),x("small",{class:"bg-info px-3 rounded-xl ms-1 d-flex",style:{"font-size":"10px","align-items":"center"},key:b},[k($(b.mentee)+" ",1),t(U,{icon:"ri-close-line",color:"error",class:"ms-2 cursor-pointer",onClick:te=>C.value=e(C).filter(c=>c!==b)},null,8,["onClick"])]))),128))])):q("",!0),e(N)?(i(),T(je,{key:1,class:"mx-auto border",type:"table-thead, table-row@10"})):(i(),T(ge,{key:2,class:"table-responsive"},{default:l(()=>{var b,te;return[s("thead",null,[s("tr",null,[st,rt,it,ut,s("th",dt,$(r.name=="tutoring"?"Program Name":"Engagement Type"),1),r.name=="tutoring"?(i(),x("th",ct," Tutor Name ")):q("",!0)])]),s("tbody",null,[(i(!0),x(K,null,ie(e(G).data,(c,le)=>(i(),x("tr",{key:le,class:Ue({"bg-secondary":e(C).includes(c.id)})},[s("td",null,[c.cancellation_reason?(i(),T(E,{key:0},{default:l(()=>[t(W,{activator:"parent",location:"top"},{default:l(()=>[k(" Cancel: "+$(c.cancellation_reason),1)]),_:2},1024),t(U,{icon:"ri-subtract-line",color:"error"})]),_:2},1024)):(!c.timesheet_id||!c.scnd_timesheet_id)&&!c.cancellation_reason?(i(),T(Ae,{key:1,modelValue:e(C),"onUpdate:modelValue":a[8]||(a[8]=D=>J(C)?C.value=D:null),value:{id:c.id,require:c.require,mentee:c.student_name,package:c.package,curriculum:c.curriculum,program_name:c.program_name,grade:c.student_grade,engagement_type:c.engagement_type_id}},null,8,["modelValue","value"])):c.timesheet_id&&c.scnd_timesheet_id&&!c.cancellation_reason?(i(),T(U,{key:2,icon:"ri-check-line",color:"success"})):q("",!0)]),s("td",mt,[c.timesheet_id?(i(),T(E,{key:0,class:"cursor-pointer",onClick:D=>f(c.timesheet_id)},{default:l(()=>[t(U,{icon:"ri-file-check-line",class:"mx-1",color:"success"}),t(W,{activator:"parent",location:"top"},{default:l(()=>[k("Already")]),_:1})]),_:2},1032,["onClick"])):(i(),T(E,{key:1},{default:l(()=>[t(U,{icon:"ri-file-close-line",class:"mx-1",color:"error"}),t(W,{activator:"parent",location:"top"},{default:l(()=>[k("Not Yet")]),_:1})]),_:1})),c.scnd_timesheet_id?(i(),T(E,{key:2,class:"cursor-pointer",onClick:D=>f(c.scnd_timesheet_id)},{default:l(()=>[t(U,{icon:"ri-file-check-line",class:"mx-1",color:"success"}),t(W,{activator:"parent",location:"top"},{default:l(()=>[k("Already")]),_:1})]),_:2},1032,["onClick"])):q("",!0)]),s("td",pt,[t(U,{icon:"ri-user-line",class:"me-3"}),k(" "+$(c.student_name)+" ",1),r.name=="specialist"&&c.notes?(i(),x("div",{key:0,class:"d-inline ms-2 cursor-pointer",onClick:D=>{R.value=!0,Y.value=c.notes}},[t(W,{activator:"parent",location:"start"},{default:l(()=>[k(" Notes ")]),_:1}),t(U,{icon:"ri-chat-3-line",color:"info"})],8,ft)):q("",!0)]),s("td",_t,$(c.student_school),1),r.name=="tutoring"?(i(),x("td",vt,[t(U,{icon:"ri-bookmark-line",class:"me-3"}),k(" "+$(c.free_trial?"[TRIAL]":"")+" "+$(c.program_name),1)])):(i(),x("td",gt,[t(U,{icon:"ri-bookmark-line",class:"me-3"}),k(" "+$(c.engagement_type),1)])),r.name=="tutoring"?(i(),x("td",yt,$(c.tutor_name),1)):q("",!0)],2))),128))]),((te=(b=e(G))==null?void 0:b.data)==null?void 0:te.length)==0?(i(),x("tfoot",bt,Vt)):q("",!0)]}),_:1})),s("div",ht,[t(Ie,{modelValue:e(_),"onUpdate:modelValue":[a[9]||(a[9]=b=>J(_)?_.value=b:null),I],length:e(Z),"total-visible":4,color:"primary",density:"compact","show-first-last-page":!1},null,8,["modelValue","length"])])]),_:1})]),_:1})],64)}}};export{Ot as default};
