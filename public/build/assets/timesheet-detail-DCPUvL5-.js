import{_ as we}from"./DeleteHandler.vue_vue_type_script_setup_true_lang-DWyWJr-l.js";import{r as y,y as ae,e as g,p as Y,w as a,b as t,j as pe,V as I,h as e,D as z,k as P,l as $,i as T,z as fe,A as N,s as U,a5 as _e,o as ve,f as l,E as ne,a as F,F as xe,a0 as De,t as v,q as X,H as $e,a6 as Ce,d as ue,a1 as Te,W as Me,x as Se,a7 as Ye,a8 as Ue,a9 as ke}from"./main-B9R9RoZq.js";import{r as j}from"./rules-CkvmYWH-.js";import{c as R,d as ge,V as O,b as te,a as me,e as je}from"./VCard-CXaGyAhg.js";import{V as ye}from"./VForm-BiEqnpxz.js";import{V as se,a as w}from"./VRow-wI_eo93L.js";import{V as he}from"./VTextarea-CBNR96FG.js";import{V as le}from"./VDialog-CspqdkAW.js";import{a as be,V as ee}from"./VTable-CNJS9BWd.js";import{T as de}from"./index-CBrOBdho.js";import{V as Ne}from"./VCheckbox-tzhrUkxQ.js";import{V as re}from"./VAutocomplete-DF_5WBG6.js";import{V as Le}from"./VTooltip-cE0Fmrkm.js";import{V as Pe}from"./VDivider-CWmxtmoW.js";import{V as qe,a as ce,b as Ae}from"./VList-BN1opfz2.js";import"./VAvatar-vDKrtj1J.js";import"./VImg-CbbqUjRu.js";import"./VCheckboxBtn-D_ZhZnke.js";import"./VSelectionControl-nYMYYKK0.js";import"./VSlideGroup-DtXE-8S1.js";import"./ssrBoot-CmorPMfO.js";const Re={__name:"activity-add",props:{id:String},emits:["close","reload"],setup(q,{emit:M}){const c=q,x=M,o=y(!1),b=y(),i=y({activity:null,description:null,date:null,start_time:null,end_time:null,start_date:null,end_date:null,meeting_link:null}),m=()=>{i.value={activity:null,description:null,date:null,start_time:null,end_time:null,start_date:null,end_date:null,meeting_link:null}},V=async()=>{const{valid:D}=await b.value.validate();if(D){o.value=!0;try{const n=await N.post("api/v1/timesheet/"+c.id+"/activity",i.value);n&&U("success",n.message,"bottom-end")}catch(n){U("error",n.response.data.errors,"bottom-end")}finally{m(),o.value=!1,x("reload"),x("close")}}};return(D,n)=>{const C=ae("DialogCloseBtn"),p=ae("VDateInput");return g(),Y(O,{title:"New Activity"},{default:a(()=>[t(C,{variant:"text",size:"default",onClick:n[0]||(n[0]=s=>x("close"))}),t(R,null,{default:a(()=>[t(ye,{onSubmit:pe(V,["prevent"]),ref_key:"formData",ref:b,"validate-on":"input"},{default:a(()=>[t(se,null,{default:a(()=>[t(w,{cols:"12",class:"d-none"},{default:a(()=>[t(I,{density:"compact",modelValue:e(i).activity,"onUpdate:modelValue":n[1]||(n[1]=s=>e(i).activity=s),label:"Activity Name",placeholder:"Activity",loading:e(o),disabled:e(o)},null,8,["modelValue","loading","disabled"])]),_:1}),t(w,{cols:"12"},{default:a(()=>[t(he,{density:"compact",modelValue:e(i).description,"onUpdate:modelValue":n[2]||(n[2]=s=>e(i).description=s),label:"Meeting Discussion",placeholder:"Meeting Discussion",loading:e(o),disabled:e(o),rules:e(j).required},null,8,["modelValue","loading","disabled","rules"])]),_:1}),t(w,{md:"6",cols:"12"},{default:a(()=>[t(p,{density:"compact",modelValue:e(i).date,"onUpdate:modelValue":n[3]||(n[3]=s=>e(i).date=s),label:"Date",placeholder:"Select Date",variant:"outlined","prepend-icon":"",loading:e(o),disabled:e(o),rules:e(j).required},null,8,["modelValue","loading","disabled","rules"])]),_:1}),t(w,{md:"3",cols:"6"},{default:a(()=>[t(I,{density:"compact",type:"time",modelValue:e(i).start_time,"onUpdate:modelValue":n[4]||(n[4]=s=>e(i).start_time=s),label:"Start Time",placeholder:"Start Time",rules:e(j).required,class:"mb-3",loading:e(o),disabled:!e(i).date||e(o),onChange:n[5]||(n[5]=s=>e(i).start_date=e(z)(e(i).date).format("YYYY-MM-DD")+" "+e(i).start_time+":00")},null,8,["modelValue","rules","loading","disabled"])]),_:1}),t(w,{md:"3",cols:"6"},{default:a(()=>[t(I,{density:"compact",type:"time",modelValue:e(i).end_time,"onUpdate:modelValue":n[6]||(n[6]=s=>e(i).end_time=s),label:"End Time",placeholder:"End Time",loading:e(o),disabled:!e(i).date||e(o),onChange:n[7]||(n[7]=s=>e(i).end_date=e(z)(e(i).date).format("YYYY-MM-DD")+" "+e(i).end_time+":00")},null,8,["modelValue","loading","disabled"])]),_:1}),t(w,{md:"12",cols:"12"},{default:a(()=>[t(I,{density:"compact",type:"text",modelValue:e(i).meeting_link,"onUpdate:modelValue":n[8]||(n[8]=s=>e(i).meeting_link=s),label:"Meeting Link",placeholder:"Meeting Link",loading:e(o),disabled:e(o)},null,8,["modelValue","loading","disabled"])]),_:1})]),_:1}),t(ge,{class:"mt-5"},{default:a(()=>[t(P,{variant:"tonal",type:"button",color:"error",loading:e(o),disabled:e(o),onClick:n[9]||(n[9]=s=>x("close"))},{default:a(()=>[t($,{icon:"ri-close-line",class:"me-3"}),T(" Close ")]),_:1},8,["loading","disabled"]),t(fe),t(P,{variant:"tonal",type:"submit",color:"success",loading:e(o),disabled:e(o)},{default:a(()=>[T(" Save "),t($,{icon:"ri-save-line",class:"ms-3"})]),_:1},8,["loading","disabled"])]),_:1})]),_:1},512)]),_:1})]),_:1})}}},Fe={__name:"activity-edit",props:{timesheet_id:Number,activity:String},emits:["close","reload"],setup(q,{emit:M}){const c=y(!1),x=y(),o=q,b=M,i=_e("updateReload"),m=y({activity:o==null?void 0:o.activity.activity,description:o==null?void 0:o.activity.description,date:new Date(o==null?void 0:o.activity.start_date),start_time:o==null?void 0:o.activity.start_time,end_time:o==null?void 0:o.activity.end_time,start_date:z(o==null?void 0:o.activity.start_date).format("YYYY-MM-DD")+" "+(o==null?void 0:o.activity.start_time)+":00",end_date:(o==null?void 0:o.activity.end_time)!=0?z(o==null?void 0:o.activity.start_date).format("YYYY-MM-DD")+" "+(o==null?void 0:o.activity.end_time)+":00":null,meeting_link:o==null?void 0:o.activity.meeting_link}),V=async()=>{var n,C;const{valid:D}=await x.value.validate();if(D){c.value=!0;try{m.value.start_date=z(m.value.date).format("YYYY-MM-DD")+" "+m.value.start_time+":00",m.value.end_date=z(m.value.date).format("YYYY-MM-DD")+" "+m.value.end_time+":00";const p=await N.put("api/v1/timesheet/"+o.timesheet_id+"/activity/"+o.activity.id,m.value);p&&(U("success",p.message,"bottom-end"),b("reload"))}catch(p){if((C=(n=p==null?void 0:p.response)==null?void 0:n.data)!=null&&C.errors){const s=p.response.data.errors;let u="Validation errors:";if(typeof s!="string"){for(const d in s)s.hasOwnProperty(d)&&(u+=`
${d}: ${s[d].join(", ")}`);U("error",u,"bottom-end")}else U("error",p.response.data.errors,"bottom-end")}}finally{c.value=!1,b("close"),setTimeout(()=>{i(!0)},3e3)}}};return(D,n)=>{const C=ae("DialogCloseBtn"),p=ae("VDateInput");return g(),Y(O,{title:"Edit Activity"},{default:a(()=>[t(C,{variant:"text",size:"default",onClick:n[0]||(n[0]=s=>b("close"))}),t(R,null,{default:a(()=>[t(ye,{onSubmit:pe(V,["prevent"]),ref_key:"formData",ref:x,"validate-on":"input"},{default:a(()=>[t(se,null,{default:a(()=>[t(w,{cols:"12",class:"d-none"},{default:a(()=>[t(I,{density:"compact",modelValue:e(m).activity,"onUpdate:modelValue":n[1]||(n[1]=s=>e(m).activity=s),label:"Activity Name",placeholder:"Activity",disabled:e(c),loading:e(c)},null,8,["modelValue","disabled","loading"])]),_:1}),t(w,{cols:"12"},{default:a(()=>[t(he,{density:"compact",modelValue:e(m).description,"onUpdate:modelValue":n[2]||(n[2]=s=>e(m).description=s),label:"Meeting Discussion",rules:e(j).required,placeholder:"Meeting Discussion",disabled:e(c),loading:e(c)},null,8,["modelValue","rules","disabled","loading"])]),_:1}),t(w,{md:"6",cols:"12"},{default:a(()=>[t(p,{density:"compact",modelValue:e(m).date,"onUpdate:modelValue":n[3]||(n[3]=s=>e(m).date=s),label:"Date",placeholder:"Select Date","prepend-icon":"",disabled:e(c),loading:e(c),rules:e(j).required},null,8,["modelValue","disabled","loading","rules"])]),_:1}),t(w,{md:"3",cols:"6"},{default:a(()=>[t(I,{density:"compact",type:"time",modelValue:e(m).start_time,"onUpdate:modelValue":n[4]||(n[4]=s=>e(m).start_time=s),label:"Start Time",rules:e(j).required,placeholder:"Start Time",disabled:e(c),loading:e(c),onChange:n[5]||(n[5]=s=>e(m).start_date=e(z)(o==null?void 0:o.activity.date).format("YYYY-MM-DD")+" "+e(m).start_time+":00")},null,8,["modelValue","rules","disabled","loading"])]),_:1}),t(w,{md:"3",cols:"6"},{default:a(()=>[t(I,{density:"compact",type:"time",modelValue:e(m).end_time,"onUpdate:modelValue":n[6]||(n[6]=s=>e(m).end_time=s),label:"End Time",placeholder:"End Time",disabled:e(c),loading:e(c),onChange:n[7]||(n[7]=s=>e(m).end_date=e(z)(o==null?void 0:o.activity.date).format("YYYY-MM-DD")+" "+e(m).end_time+":00")},null,8,["modelValue","disabled","loading"])]),_:1}),t(w,{md:"12",cols:"12"},{default:a(()=>[t(I,{density:"compact",type:"text",modelValue:e(m).meeting_link,"onUpdate:modelValue":n[8]||(n[8]=s=>e(m).meeting_link=s),label:"Meeting Link",placeholder:"Meeting Link",disabled:e(c),loading:e(c)},null,8,["modelValue","disabled","loading"])]),_:1})]),_:1}),t(ge,{class:"mt-5"},{default:a(()=>[t(P,{variant:"tonal",color:"error",disabled:e(c),loading:e(c),onClick:n[9]||(n[9]=s=>b("close"))},{default:a(()=>[t($,{icon:"ri-close-line",class:"me-3"}),T(" Close ")]),_:1},8,["disabled","loading"]),t(fe),t(P,{variant:"tonal",color:"success",type:"submit",disabled:e(c),loading:e(c)},{default:a(()=>[T(" Save "),t($,{icon:"ri-save-line",class:"ms-3"})]),_:1},8,["disabled","loading"])]),_:1})]),_:1},512)]),_:1})]),_:1})}}},Ie={class:"d-flex justify-between align-center"},Ee=l("div",{class:"w-100"},[l("h4",null,"Activity")],-1),Be=l("thead",null,[l("tr",null,[l("th",{class:"text-uppercase",width:"1%"}," No "),l("th",{class:"text-uppercase text-start"},"Meeting Discussion"),l("th",{class:"text-uppercase text-center"},"Date"),l("th",{class:"text-uppercase text-center"},"Start Time"),l("th",{class:"text-uppercase text-center"},"End Time"),l("th",{class:"text-uppercase text-center"},"Time Spent"),l("th",{class:"text-uppercase text-left"},"Fee Hours"),l("th",{class:"text-uppercase text-center"},"Status"),l("th",{class:"text-uppercase text-end"},"#")])],-1),ze={key:0},Oe=l("tr",null,[l("th",{colspan:"8",class:"text-center"}," No Activity Found ")],-1),He=[Oe],Ge={key:1},Je={width:"1%"},We={class:"d-none"},Ke={class:"text-start"},Qe=["innerHTML"],Xe={class:"text-center"},Ze={class:"text-center"},et={class:"text-center"},tt={class:"text-left"},lt={class:"text-end"},at=["href"],st={__name:"timesheet-detail",props:{id:String},setup(q){const M=q,c=_e("updateReload"),x=y([]),o=y(!1),b=y([{add:!1,edit:!1,delete:!1}]),i=y([]),m=async()=>{o.value=!0;try{const p=await N.get("api/v1/timesheet/"+M.id+"/activities");p&&(x.value=p)}catch(p){console.error(p)}finally{o.value=!1}},V=p=>{b.value[p]?b.value[p]=!1:b.value[p]=!0},D=(p,s)=>{i.value=s,V(p)},n=async()=>{var p,s,u;o.value=!0;try{const d=await N.delete("api/v1/timesheet/"+M.id+"/activity/"+i.value.id);d&&(U("success",d.message,"bottom-end"),V("delete"))}catch(d){((p=d.response)==null?void 0:p.status)==400&&U("error",(u=(s=d.response)==null?void 0:s.data)==null?void 0:u.errors,"bottom-end")}finally{o.value=!1,m(),c(!0)}},C=async p=>{var s,u;try{const d=await N.patch("api/v1/timesheet/"+M.id+"/activity/"+p.id,p);d&&U("success",d.message,"bottom-end")}catch(d){if((u=(s=d==null?void 0:d.response)==null?void 0:s.data)!=null&&u.errors){const r=d.response.data.errors;let _="Validation errors:";if(typeof r!="string"){for(const f in r)r.hasOwnProperty(f)&&(_+=`
${f}: ${r[f].join(", ")}`);U("error",_,"bottom-end")}else U("error",d.response.data.errors,"bottom-end")}}finally{m(),c(!0)}};return ve(()=>{m()}),(p,s)=>(g(),Y(O,null,{default:a(()=>[t(te,null,{default:a(()=>[l("div",Ie,[Ee,ne((g(),Y(P,{onClick:s[0]||(s[0]=u=>V("add"))},{default:a(()=>[t($,{icon:"ri-add-line"})]),_:1})),[[de,"New Activity","start"]]),t(le,{modelValue:e(b).add,"onUpdate:modelValue":s[2]||(s[2]=u=>e(b).add=u),"max-width":"600",persistent:""},{default:a(()=>[t(Re,{id:M.id,onClose:s[1]||(s[1]=u=>V("add")),onReload:m},null,8,["id"])]),_:1},8,["modelValue"])])]),_:1}),t(R,null,{default:a(()=>[e(o)?(g(),Y(ee,{key:1,type:"table"})):(g(),Y(be,{key:0,class:"text-no-wrap","max-height":"400","fixed-header":""},{default:a(()=>{var u;return[Be,((u=e(x))==null?void 0:u.length)==0?(g(),F("tbody",ze,He)):(g(),F("tbody",Ge,[(g(!0),F(xe,null,De(e(x),(d,r)=>(g(),F("tr",{key:r},[l("td",Je,v(r+1),1),l("td",We,v(d.activity),1),l("td",Ke,[l("div",{class:"py-2",style:{width:"250px","text-wrap":"wrap"},innerHTML:d.description},null,8,Qe)]),l("td",null,v(p.$moment(d.start_date).format("dddd"))+", "+v(p.$moment(d.start_date).format("MMM Do YYYY")),1),l("td",Xe,v(d.start_time),1),l("td",Ze,v(d.end_time),1),l("td",et,[t($,{icon:"ri-timer-2-line",class:"cursor-pointer me-3"}),T(" "+v(d.estimate)+" Minutes ",1)]),l("td",tt,"Rp. "+v(new Intl.NumberFormat("id-ID").format(d.fee_hours)),1),l("td",null,[ne(t(Ne,{color:"success",modelValue:d.status,"onUpdate:modelValue":[_=>d.status=_,_=>C(d)],value:!0,"false-value":!1},null,8,["modelValue","onUpdate:modelValue"]),[[de,d.status?"Completed":"Not Yet","start"]])]),l("td",lt,[d.meeting_link?(g(),Y(P,{key:0,color:"primary",density:"compact",class:"me-1"},{default:a(()=>[l("a",{href:d.meeting_link,target:"_blank",class:"bg-primary"},[t($,{icon:"ri ri-link"}),T(" Join ")],8,at)]),_:2},1024)):X("",!0),ne((g(),Y(P,{color:"warning",density:"compact",class:"me-1",onClick:_=>D("edit",d)},{default:a(()=>[t($,{icon:"ri-edit-line",class:"cursor-pointer"})]),_:2},1032,["onClick"])),[[de,"Edit Activity","start"]]),ne((g(),Y(P,{color:"error",density:"compact",onClick:_=>D("delete",d)},{default:a(()=>[t($,{icon:"ri-delete-bin-line",class:"cursor-pointer"})]),_:2},1032,["onClick"])),[[de,"Delete Activity","start"]])])]))),128))]))]}),_:1}))]),_:1}),t(le,{modelValue:e(b).edit,"onUpdate:modelValue":s[4]||(s[4]=u=>e(b).edit=u),"max-width":"600",persistent:""},{default:a(()=>[t(Fe,{timesheet_id:M==null?void 0:M.id,activity:e(i),onClose:s[3]||(s[3]=u=>V("edit")),onReload:m},null,8,["timesheet_id","activity"])]),_:1},8,["modelValue"]),t(le,{modelValue:e(b).delete,"onUpdate:modelValue":s[6]||(s[6]=u=>e(b).delete=u),"max-width":"400",persistent:""},{default:a(()=>[t(we,{title:"activity",loading:e(o),onClose:s[5]||(s[5]=u=>V("delete")),onDelete:n},null,8,["loading"])]),_:1},8,["modelValue"])]),_:1}))}},it={__name:"timesheet-transfer",props:{timesheet_id:Number,require:String},emits:["close","reload"],setup(q,{emit:M}){const c=y(),x=q,o=M,b=y([]),i=y([]),m=y([]),V=x.require.toLowerCase(),D=y(!1),n=y({mentortutor_email:null,subject_id:null}),C=async()=>{const u="api/v1/user/mentor-tutors?role="+V;D.value=!0;try{const d=await N.get(u);d&&(b.value=d)}catch(d){console.error(d)}finally{D.value=!1}},p=async(u,d=null)=>{if(n.value.subject_id=null,V=="mentor")n.value.subject_id=u[0].subjects[0].id;else{D.value=!0;try{const r=await N.get("api/v1/user/mentor-tutors/"+d+"/subjects");r&&(m.value=r)}catch(r){console.error(r)}finally{D.value=!1}}},s=async()=>{var r,_;o("close"),n.value.mentortutor_email=i.value.email;const{valid:u}=await c.value.validate(),d=await Ce("Are you sure you want to change the owner?");if(u&&d){D.value=!0;try{const f=await N.patch("api/v1/timesheet/"+x.timesheet_id+"/void/",n.value);f&&(U("success",f.message,"bottom-end"),ue.push({path:"/admin/timesheet/"+f.data.timesheet_id}),n.value={mentortutor_email:null,subject_id:null},i.value=[],setTimeout(()=>{ue.go(0)},1e3))}catch(f){if(console.log(f),(_=(r=f==null?void 0:f.response)==null?void 0:r.data)!=null&&_.errors){const B=f.response.data.errors;U("error",B,"bottom-end")}}finally{o("close"),D.value=!1}}};return ve(()=>{C()}),(u,d)=>(g(),Y(O,{class:"mx-auto my-8",elevation:"16",width:"450"},{default:a(()=>[t(ye,{ref_key:"formData",ref:c,"validate-on":"input",onSubmit:pe(s,["prevent"])},{default:a(()=>[t(me,null,{default:a(()=>[t(te,null,{default:a(()=>[T(" Timesheet Ownership Transfer ")]),_:1}),t(je,null,{default:a(()=>[T(" Change Timesheet Handler ")]),_:1})]),_:1}),t(R,null,{default:a(()=>[t(se,null,{default:a(()=>{var r;return[t(w,{md:"12"},{default:a(()=>[t(re,{clearable:"",modelValue:e(i),"onUpdate:modelValue":[d[0]||(d[0]=_=>$e(i)?i.value=_:null),d[1]||(d[1]=_=>p(e(i).roles,e(i).uuid))],label:"Mentor/Tutor",items:e(b),"item-props":_=>({title:_.full_name,subtitle:_.roles.map(f=>f.name).join(", ")}),rules:e(j).required,loading:e(D),disabled:e(D)},null,8,["modelValue","items","item-props","rules","loading","disabled"])]),_:1}),((r=x.require)==null?void 0:r.toLowerCase())=="tutor"?(g(),Y(w,{key:0,md:"12"},{default:a(()=>[t(re,{clearable:"",modelValue:e(n).subject_id,"onUpdate:modelValue":d[2]||(d[2]=_=>e(n).subject_id=_),label:"Subject Tutoring",items:e(m),"item-title":"subject","item-value":"id",loading:e(D),disabled:e(D),rules:e(j).required},null,8,["modelValue","items","loading","disabled","rules"])]),_:1})):X("",!0)]}),_:1})]),_:1}),t(ge,{class:"mx-3 mb-3"},{default:a(()=>[t(P,{color:"error",onClick:d[3]||(d[3]=r=>o("close"))},{default:a(()=>[t($,{icon:"ri-close-line",class:"me-3"}),T(" Close ")]),_:1}),t(fe),t(P,{color:"success",type:"submit"},{default:a(()=>[T(" Save Changes "),t($,{icon:"ri-save-line",class:"ms-3"})]),_:1})]),_:1})]),_:1},512)]),_:1}))}},ot={__name:"user-edit",props:["id","item","package_id"],emits:["close","reload"],setup(q,{emit:M}){var E,G,J,W,K,Q,ie,Ve;const c=q,x=M,o=y([]),b=y([]),i=y([]),m=y([]),V=y(!1),D=y(!0),n=y(!0),C=y(null),p=y(),s=y({mentortutor_email:(E=c.item)==null?void 0:E.tutormentor_email,subject_id:(G=c.item)==null?void 0:G.subject_id,inhouse_id:(J=c.item)==null?void 0:J.inhouse_id,package_id:c.package_id,duration:(W=c.item)==null?void 0:W.duration,notes:(K=c.item)==null?void 0:K.notes,pic_id:(Q=c.item)==null?void 0:Q.pic_id,tax:(ie=c.item)==null?void 0:ie.tax,individual_fee:Math.trunc((Ve=c.item)==null?void 0:Ve.individual_fee)}),u=async(S=!1)=>{n.value=!0;const h=S?"api/v1/user/mentor-tutors?inhouse=true":"api/v1/user/mentor-tutors";try{const A=await N.get(h);A&&(S?m.value=Object.values(A):o.value=A)}catch(A){console.error(A)}finally{n.value=!1}},d=async()=>{n.value=!0;try{const S=await N.get("api/v1/package/component/list");S&&(b.value=S)}catch(S){console.error(S)}finally{n.value=!1}},r=()=>{const S=s.value.package_id,h=b.value.findIndex(L=>L.id===S);let A=b.value[h];A.detail?(V.value=!0,s.value.duration=A.detail):(V.value=!1,s.value.duration=null)},_=async()=>{n.value=!0;try{const S=await N.get("api/v1/user/component/list");S&&(i.value=S)}catch(S){console.error(S)}finally{n.value=!1}},f=async()=>{var h,A;const{valid:S}=await p.value.validate();if(S)try{const L=await N.put("api/v1/timesheet/"+c.id+"/update",s.value);L&&(s.value={mentortutor_email:null,subject_id:null,inhouse_id:null,package_id:null,duration:"",notes:"",pic_id:[]},U("success",L.message,"bottom-end"),x("reload"))}catch(L){if((A=(h=L==null?void 0:L.response)==null?void 0:h.data)!=null&&A.errors){const Z=L.response.data.errors;let oe="Validation errors:";for(const k in Z)Z.hasOwnProperty(k)&&(oe+=`
${k}: ${Z[k].join(", ")}`);U("error",oe,"bottom-end")}}finally{x("close")}},B=()=>{if(s.value.individual_fee){const S=s.value.individual_fee*(1-s.value.tax/100);C.value=Math.trunc(S)}else C.value=null},H=()=>{const S=C.value/(1-s.value.tax/100);s.value.individual_fee=Math.trunc(S)};return ve(()=>{u(!0),d(),_(),B(),setTimeout(()=>{D.value=!1},2e3)}),(S,h)=>{const A=ae("DialogCloseBtn");return g(),Y(O,{title:"Edit Detail"},{default:a(()=>[t(A,{variant:"text",size:"default",onClick:h[0]||(h[0]=L=>x("close"))}),t(R,null,{default:a(()=>[t(ye,{onSubmit:pe(f,["prevent"]),ref_key:"formData",ref:p,"validate-on":"input"},{default:a(()=>[t(se,null,{default:a(()=>{var L,Z,oe;return[t(w,{md:"8",cols:"8"},{default:a(()=>[t(re,{density:"compact",clearable:"",label:"Package",modelValue:e(s).package_id,"onUpdate:modelValue":[h[1]||(h[1]=k=>e(s).package_id=k),r],items:e(b),"item-props":k=>({title:k.package!=null?k.type_of+" - "+k.package:k.type_of}),"item-value":"id",rules:e(j).required,loading:e(n),disabled:e(n)},null,8,["modelValue","items","item-props","rules","loading","disabled"])]),_:1}),t(w,{md:"4",cols:"4"},{default:a(()=>[t(I,{type:"number",clearable:"",label:+e(s).duration/60?"Minutes ("+e(s).duration/60+" Hours)":"Minutes",readonly:e(V),modelValue:e(s).duration,"onUpdate:modelValue":h[2]||(h[2]=k=>e(s).duration=k),rules:e(j).required},null,8,["label","readonly","modelValue","rules"])]),_:1}),t(w,{md:"12",cols:"12"},{default:a(()=>[t(re,{density:"compact",clearable:"",modelValue:e(s).inhouse_id,"onUpdate:modelValue":h[3]||(h[3]=k=>e(s).inhouse_id=k),label:"Inhouse Mentor/Tutor",items:e(m),"item-props":k=>({title:k.full_name}),"item-value":"uuid",rules:e(j).required,loading:e(n),disabled:e(n)},null,8,["modelValue","items","item-props","rules","loading","disabled"])]),_:1}),(L=c.item)!=null&&L.individual_fee?(g(),Y(w,{key:0,md:"4",cols:"7"},{default:a(()=>[t(I,{type:"number",clearable:"",label:"Fee/hours (Nett)",modelValue:e(C),"onUpdate:modelValue":[h[4]||(h[4]=k=>$e(C)?C.value=k:null),H],density:"compact",rules:e(j).required},null,8,["modelValue","rules"])]),_:1})):X("",!0),(Z=c.item)!=null&&Z.individual_fee?(g(),Y(w,{key:1,md:"4",cols:"5"},{default:a(()=>[t(I,{type:"number",clearable:"",label:"Tax",modelValue:e(s).tax,"onUpdate:modelValue":[h[5]||(h[5]=k=>e(s).tax=k),H],rules:e(j).required,density:"compact"},null,8,["modelValue","rules"])]),_:1})):X("",!0),(oe=c.item)!=null&&oe.individual_fee?(g(),Y(w,{key:2,md:"4",cols:"12"},{default:a(()=>[t(Le,{activator:"parent",location:"top"},{default:a(()=>[T(" Fee Gross is automatically calculated based on the entered Net Fee and Tax Rate. ")]),_:1}),t(I,{type:"number",clearable:"",label:"Fee/hours (Gross)",modelValue:e(s).individual_fee,"onUpdate:modelValue":[h[6]||(h[6]=k=>e(s).individual_fee=k),B],density:"compact",readonly:"",rules:e(j).required},null,8,["modelValue","rules"])]),_:1})):X("",!0),t(w,{md:"12",cols:"12"},{default:a(()=>[t(re,{density:"compact",multiple:"",clearable:"",chips:"",label:"PIC",modelValue:e(s).pic_id,"onUpdate:modelValue":h[7]||(h[7]=k=>e(s).pic_id=k),items:e(i),"item-title":"full_name","item-value":"id",rules:e(j).required,loading:e(n),disabled:e(n)},null,8,["modelValue","items","rules","loading","disabled"])]),_:1}),t(w,{md:"12",cols:"12"},{default:a(()=>[t(he,{density:"compact",label:"Notes",modelValue:e(s).notes,"onUpdate:modelValue":h[8]||(h[8]=k=>e(s).notes=k)},null,8,["modelValue"])]),_:1})]}),_:1}),t(Pe,{class:"my-3 px-0"}),t(ge,null,{default:a(()=>[t(P,{variant:"tonal",color:"error",type:"button",onClick:h[9]||(h[9]=L=>x("close"))},{default:a(()=>[t($,{icon:"ri-close-line",class:"me-3"}),T(" Close ")]),_:1}),t(fe),t(P,{variant:"tonal",color:"success",type:"submit"},{default:a(()=>[T(" Save "),t($,{icon:"ri-save-line",class:"ms-3"})]),_:1})]),_:1})]),_:1},512)]),_:1})]),_:1})}}},nt={class:"w-100"},dt={class:"mt-3 font-weight-light"},rt=l("hr",{class:"my-2"},null,-1),ut={key:0},ct=l("tr",{class:"bg-secondary"},[l("td",null,"Name"),l("td",null,"School"),l("td",null,"Grade")],-1),mt={key:1},_t=l("td",{width:"20%"},"Name",-1),pt=l("td",{width:"1%"},":",-1),ft=l("td",null,"School Name",-1),vt=l("td",{width:"1%"},":",-1),gt=l("td",null,"Grade",-1),yt=l("td",{width:"1%"},":",-1),bt=l("td",null,"Email",-1),ht=l("td",{width:"1%"},":",-1),Vt={class:"mt-5 font-weight-light"},kt=l("hr",{class:"my-2"},null,-1),wt={width:"30%"},xt=l("td",{width:"1%"},":",-1),Dt={key:0},$t={key:1},Ct=l("td",null,"Package",-1),Tt=l("td",{width:"1%"},":",-1),Mt=l("td",null,"Person in Charge",-1),St=l("td",{width:"1%"},":",-1),Yt=l("td",{width:"1%"},":",-1),Ut=l("td",{width:"1%"},":",-1),jt=l("td",null,"Notes",-1),Nt=l("td",{width:"1%"},":",-1),Lt=l("td",null,"Update On",-1),Pt=l("td",{width:"1%"},":",-1),qt={class:"d-flex align-end w-100"},At={class:"m-0 mb-1 text-white"},Rt=l("h4",{class:"m-0 ms-2 text-white"},"Minutes",-1),Ft={class:"text-end w-100"},It={class:"d-flex align-end w-100"},Et={class:"m-0 mb-1 text-white"},Bt=l("h4",{class:"m-0 ms-2 text-white"},"Minutes",-1),zt={class:"text-end w-100"},Ot={class:"d-flex align-end w-100"},Ht={class:"m-0 mb-1 text-white"},Gt=l("h4",{class:"m-0 ms-2 text-white"},"Minutes",-1),Jt={class:"text-end w-100"},Wt={__name:"user-detail",props:{id:String,name:String},emits:["void"],setup(q,{emit:M}){const c=q,x=M,o=_e("reloadData"),b=_e("updateReload"),i=y([]),m=y([{edit:!1,void:!1,delete:!1}]),V=y(!1),D=async s=>{var u,d,r;V.value=!0;try{const _=await N.get("api/v1/timesheet/"+s+"/detail");_&&(i.value=_,x("void",_.packageDetails.void))}catch(_){((u=_.response)==null?void 0:u.status)==400&&(U("error",(r=(d=_.response)==null?void 0:d.data)==null?void 0:r.errors,"bottom-end"),ue.push("/admin/timesheet")),console.log(_)}finally{V.value=!1}},n=async()=>{var s,u,d;V.value=!0;try{const r=await N.delete("api/v1/timesheet/"+c.id+"/delete");r&&(i.value=r,U("success",r.message,"bottom-end"),m.value.delete=!1,ue.push("/admin/timesheet/tutoring"))}catch(r){((s=r.response)==null?void 0:s.status)==400&&U("error",(d=(u=r.response)==null?void 0:u.data)==null?void 0:d.errors,"bottom-end")}finally{V.value=!1}},C=s=>{m.value[s]?m.value[s]=!1:m.value[s]=!0},p=async(s,u)=>{var d;Ye();try{const r=await N.get("api/v1/timesheet/"+s+"/export",{responseType:"blob"});if(r){const _=window.URL.createObjectURL(new Blob([r],{type:'"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"'})),f=document.createElement("a");f.href=_,f.setAttribute("download",`Timesheet_${u}.xlsx`),document.body.appendChild(f),f.click(),document.body.removeChild(f),window.URL.revokeObjectURL(_),Ue.close()}}catch(r){U("error",(d=r.response)==null?void 0:d.statusText,"bottom-end"),console.log(r)}};return ve(()=>{D(c.id)}),Te(()=>{o.value&&(D(c.id),b(!1))}),(s,u)=>{const d=ae("router-link");return g(),Y(O,{class:"mb-3"},{default:a(()=>[e(V)?(g(),Y(ee,{key:0,type:"heading"})):(g(),Y(te,{key:1,class:"d-flex justify-between align-center"},{default:a(()=>{var r,_,f,B,H;return[l("div",nt,[t(d,{to:"/admin/timesheet/"+c.name},{default:a(()=>[t($,{icon:"ri-arrow-left-line",color:"secondary",class:"me-2",size:"25"})]),_:1},8,["to"]),T(" "+v((r=e(i).packageDetails)==null?void 0:r.tutormentor_name)+" | "+v(((f=(_=e(i))==null?void 0:_.packageDetails)==null?void 0:f.package_type)+" - "+((H=(B=e(i))==null?void 0:B.packageDetails)==null?void 0:H.package_name)),1)]),l("div",null,[t(Se,{"close-on-content-click":!1,location:"bottom"},{activator:a(({props:E})=>[ne((g(),Y(P,Me({color:"secondary"},E),{default:a(()=>[t($,{icon:"ri-settings-3-line"})]),_:2},1040)),[[de,"Settings","start"]])]),default:a(()=>[t(qe,null,{default:a(()=>[t(ce,null,{default:a(()=>[l("div",{class:"cursor-pointer",onClick:u[0]||(u[0]=E=>C("edit"))},[t($,{icon:"ri-pencil-line",class:"me-2"}),T(" Edit TimeSheet ")])]),_:1}),t(ce,null,{default:a(()=>[l("div",{class:"cursor-pointer",onClick:u[1]||(u[1]=E=>C("void"))},[t($,{icon:"ri-exchange-2-line",class:"me-2"}),T(" Timesheet Ownership Transfer ")])]),_:1}),t(ce,null,{default:a(()=>[t(Ae,null,{default:a(()=>[l("div",{class:"cursor-pointer",onClick:u[2]||(u[2]=E=>{var G,J,W,K,Q,ie;return p(c.id,((J=(G=e(i))==null?void 0:G.packageDetails)==null?void 0:J.package_type)+"-"+((K=(W=e(i))==null?void 0:W.packageDetails)==null?void 0:K.package_name)+"_"+((ie=(Q=e(i))==null?void 0:Q.packageDetails)==null?void 0:ie.tutormentor_name))})},[t($,{icon:"ri-download-line",class:"me-2"}),T(" Download TimeSheet ")])]),_:1})]),_:1}),t(ce,null,{default:a(()=>[l("div",{class:"cursor-pointer",onClick:u[3]||(u[3]=E=>C("delete"))},[t($,{icon:"ri-delete-bin-line",class:"me-2"}),T(" Delete TimeSheet ")])]),_:1})]),_:1})]),_:1})])]}),_:1})),t(R,null,{default:a(()=>[e(V)?(g(),Y(se,{key:1},{default:a(()=>[t(w,{md:"7"},{default:a(()=>[t(ee,{type:"heading, paragraph, heading, paragraph",class:"mb-3"})]),_:1}),t(w,{md:"5"},{default:a(()=>[t(ee,{type:"text@3",color:"#16B1FF",class:"mb-3"}),t(ee,{type:"text@3",color:"#91c45e",class:"mb-3"}),t(ee,{type:"text@3",color:"#e05e5e",class:"mb-3"})]),_:1})]),_:1})):(g(),Y(se,{key:0,align:"center"},{default:a(()=>[t(w,{md:"7"},{default:a(()=>[l("h4",dt,[t($,{icon:"ri-user-line",size:"17",class:"me-2"}),T(" Basic Profile ")]),rt,t(be,{density:"compact"},{default:a(()=>{var r,_;return[((r=e(i).clientProfile)==null?void 0:r.length)>1?(g(),F("tbody",ut,[ct,(g(!0),F(xe,null,De(e(i).clientProfile,f=>(g(),F("tr",null,[l("td",null,v(f.client_name),1),l("td",null,v(f.client_school),1),l("td",null,v(f.client_grade<=12?f.client_grade:"Not High School"),1)]))),256))])):((_=e(i).clientProfile)==null?void 0:_.length)==1?(g(),F("tbody",mt,[l("tr",null,[_t,pt,l("td",null,v(e(i).clientProfile[0].client_name),1)]),l("tr",null,[ft,vt,l("td",null,v(e(i).clientProfile[0].client_school),1)]),l("tr",null,[gt,yt,l("td",null,v(e(i).clientProfile[0].client_grade<=12?e(i).clientProfile[0].client_grade:"Not High School"),1)]),l("tr",null,[bt,ht,l("td",null,v(e(i).clientProfile[0].client_mail),1)])])):X("",!0)]}),_:1}),l("h4",Vt,[t($,{icon:"ri-bookmark-line",class:"me-2",size:"17"}),T(" Package Details ")]),kt,t(be,{density:"compact"},{default:a(()=>{var r,_,f,B,H,E,G,J,W,K,Q;return[l("tbody",null,[l("tr",null,[l("td",wt,v(c.name=="tutoring"?"Program Name":"Engagement Type"),1),xt,c.name=="tutoring"?(g(),F("td",Dt,v((r=e(i).packageDetails)!=null&&r.free_trial?"[TRIAL]":"")+" "+v((_=e(i).packageDetails)==null?void 0:_.program_name),1)):(g(),F("td",$t,v((f=e(i).packageDetails)==null?void 0:f.engagement_type),1))]),l("tr",null,[Ct,Tt,l("td",null,v((B=e(i).packageDetails)==null?void 0:B.package_type)+" "+v((H=e(i).packageDetails)!=null&&H.package_name?" - "+((E=e(i).packageDetails)==null?void 0:E.package_name):""),1)]),l("tr",null,[Mt,St,l("td",null,v((G=e(i).packageDetails)==null?void 0:G.pic_name),1)]),l("tr",null,[l("td",null,v(c.name=="tutoring"?"Tutor":"Mentor")+" Name",1),Yt,l("td",null,v((J=e(i).packageDetails)==null?void 0:J.tutormentor_name)+" ( Rp. "+v(new Intl.NumberFormat("id-ID").format((W=e(i).packageDetails)==null?void 0:W.tutormentor_fee_hours))+" ) ",1)]),l("tr",null,[l("td",null,"Inhouse "+v(c.name=="tutoring"?"Tutor":"Mentor"),1),Ut,l("td",null,v((K=e(i).packageDetails)==null?void 0:K.inhouse_name),1)]),l("tr",null,[jt,Nt,l("td",null,v((Q=e(i).editableColumns)==null?void 0:Q.notes),1)]),l("tr",null,[Lt,Pt,l("td",null,v(e(z)().format("LLL")),1)])])]}),_:1})]),_:1}),t(w,{md:"5"},{default:a(()=>[t(O,{color:"#16B1FF",class:"mb-2 d-flex align-center"},{default:a(()=>[l("div",null,[t(me,null,{default:a(()=>[t(te,{class:"text-white"},{default:a(()=>[T(" Total Minutes of Package ")]),_:1})]),_:1}),t(R,{class:"d-flex justify-between"},{default:a(()=>{var r;return[l("div",qt,[l("h1",At,v((r=e(i).packageDetails)==null?void 0:r.duration_in_minutes),1),Rt])]}),_:1})]),t(R,null,{default:a(()=>[l("div",Ft,[t($,{icon:"ri-calendar-schedule-line",size:"60"})])]),_:1})]),_:1}),t(O,{color:"#91c45e",class:"mb-2 d-flex align-center"},{default:a(()=>[l("div",null,[t(me,null,{default:a(()=>[t(te,{class:"text-white"},{default:a(()=>[T(" Total Minutes Spent ")]),_:1})]),_:1}),t(R,{class:"d-flex justify-between"},{default:a(()=>{var r;return[l("div",It,[l("h1",Et,v((r=e(i).packageDetails)==null?void 0:r.time_spent_in_minutes),1),Bt])]}),_:1})]),t(R,null,{default:a(()=>[l("div",zt,[t($,{icon:"ri-timer-flash-line",size:"60",color:"white"})])]),_:1})]),_:1}),t(O,{color:"#e05e5e",class:"mb-2 d-flex align-center"},{default:a(()=>[l("div",null,[t(me,null,{default:a(()=>[t(te,{class:"text-white"},{default:a(()=>[T(" Total Minutes Left ")]),_:1})]),_:1}),t(R,{class:"d-flex justify-between"},{default:a(()=>{var r,_;return[l("div",Ot,[l("h1",Ht,v(((r=e(i).packageDetails)==null?void 0:r.duration_in_minutes)-((_=e(i).packageDetails)==null?void 0:_.time_spent_in_minutes)),1),Gt])]}),_:1})]),t(R,null,{default:a(()=>[l("div",Jt,[t($,{icon:"ri-timer-2-line",size:"60"})])]),_:1})]),_:1})]),_:1})]),_:1}))]),_:1}),t(le,{modelValue:e(m).edit,"onUpdate:modelValue":u[6]||(u[6]=r=>e(m).edit=r),"max-width":"600",persistent:""},{default:a(()=>{var r;return[t(ot,{item:e(i).editableColumns,package_id:(r=e(i).packageDetails)==null?void 0:r.package_id,id:c.id,onClose:u[4]||(u[4]=_=>C("edit")),onReload:u[5]||(u[5]=_=>D(c.id))},null,8,["item","package_id","id"])]}),_:1},8,["modelValue"]),t(le,{modelValue:e(m).delete,"onUpdate:modelValue":u[8]||(u[8]=r=>e(m).delete=r),"max-width":"400",persistent:""},{default:a(()=>[t(we,{title:"timesheet",loading:e(V),onDelete:n,onClose:u[7]||(u[7]=r=>C("delete"))},null,8,["loading"])]),_:1},8,["modelValue"]),t(le,{modelValue:e(m).void,"onUpdate:modelValue":u[10]||(u[10]=r=>e(m).void=r),"max-width":"400",persistent:""},{default:a(()=>[t(it,{timesheet_id:c.id,require:e(i).editableColumns.tutormentor_role,onClose:u[9]||(u[9]=r=>C("void"))},null,8,["timesheet_id","require"])]),_:1},8,["modelValue"])]),_:1})}}},Kt={class:"h-auto position-relative"},Qt={key:0,class:"overlay"},Xt=l("div",{class:"bg-secondary",style:{height:"100%",position:"absolute",left:"0",top:"0","z-index":"9998",width:"100%",opacity:"0.6"}},null,-1),Zt={class:"d-flex align-center justify-center",style:{height:"100%",position:"absolute",left:"0",top:"0","z-index":"9999",width:"100%",opacity:"1"}},el={class:"text-center"},tl=l("h2",{class:"text-white mt-3"},"This Timesheet Has Changed Owner",-1),wl={__name:"timesheet-detail",props:{id:Number,name:String},setup(q){const M=q,c=M.id,x=y(!1),o=y(!1);ke("reloadData",x),ke("updateReload",i=>{x.value=i});const b=i=>{o.value=i};return(i,m)=>(g(),F("div",Kt,[e(o)=="true"?(g(),F("div",Qt,[Xt,l("div",Zt,[l("div",el,[t($,{color:"white",icon:"ri-lock-line",size:"50"}),tl,t(P,{color:"light",class:"mt-4",onClick:m[0]||(m[0]=V=>e(ue).push({path:"/admin/timesheet"+M.name}))},{default:a(()=>[T(" Back to List ")]),_:1})])])])):X("",!0),t(Wt,{id:e(c),name:M.name,onVoid:b},null,8,["id","name"]),t(st,{id:e(c)},null,8,["id"])]))}};export{wl as default};
